<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.paragraph, li.paragraph, div.paragraph
	{mso-style-name:paragraph;
	margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.normaltextrun
	{mso-style-name:normaltextrun;}
span.eop
	{mso-style-name:eop;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-size:24.0pt;
font-family:"Arial",sans-serif;color:black'>IAM Abuse </span><span lang=EN
style='font-family:"Arial",sans-serif;color:black'>(version 1.0)</span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:6.0pt'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif;color:#404040'>Cloud
Service Label:  IaaS, PaaS</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:14.0pt;font-family:
"Arial",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:black'>Description</span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-family:"Arial",sans-serif;
color:black'>Both Azure and AWS employ IAM functionality that assigns specific
resource roles to either users, groups, or service principals in an attempt to
limit permissions to only those required to perform required tasks.  Using the
credentials of any user or service principal, cloud API’s can be used to scan
all available roles that may have been assigned. Because of the
hundreds/thousands of roles available, administrators may not realize or
remember which roles are assigned to whom. Even AWS can get confused, in 2018
AWS released a recommended managed policy that inadvertently allowed any user
assigned this role the ability to grant all accesses to all AWS account
resources. </span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-family:"Arial",sans-serif;
color:black'>Adversaries can use tools such as Pacu to discover obscure role
assignments and use these accesses to further infiltrate the cloud
infrastructure.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=624
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=211 valign=top style='width:158.25pt;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=413 valign=top style='width:309.75pt;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=211 valign=top style='width:158.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>iam__privesc_scan</span></p>
  </td>
  <td width=413 valign=top style='width:309.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-right:.1in'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#404040'>Abuses
  AWS API to list all roles an account has been granted and suggests further
  actions based on these roles.</span></p>
  </td>
 </tr>
 <tr>
  <td width=211 valign=top style='width:158.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Validate_iam_principals.py</span></p>
  </td>
  <td width=413 valign=top style='width:309.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#404040'>Open source Module that scans for available IAM roles in a
  given account.</span></p>
  </td>
 </tr>
 <tr>
  <td width=211 valign=top style='width:158.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AmazonElasticTranscoderFullAccess</span></p>
  </td>
  <td width=413 valign=top style='width:309.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#404040'>Abuses flaw in AWS IAM managed policy to enable assignment of
  arbitrary permissions to any other IAM role.</span></p>
  </td>
 </tr>
 <tr>
  <td width=211 valign=top style='width:158.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>aws_escalate.py</span></p>
  </td>
  <td width=413 valign=top style='width:309.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>AWS_escalate.py is a script written by Rhino Security Labs that
  detects over 20 possible privilege escalation methods within an AWS
  environment when provided with an access key and secret key. For example, <i>python3
  aws_escalate.py –all-users –access-key-id ABCDEFGHIJK –secret-key
  hdj6kshakl31/1asdhui1hka </i>will check privilege escalation methods for all
  users. </span></p>
  </td>
 </tr>
 <tr>
  <td width=211 valign=top style='width:158.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>PowerZure</span></p>
  </td>
  <td width=413 valign=top style='width:309.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'> PowerZure is a GitHub project that automates the process of
  assessing and exploiting resources and misconfigurations within Azure.  </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=624
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=212 colspan=2 valign=top style='width:159.0pt;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Mitigation</span></b></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=212 colspan=2 valign=top style='width:159.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Audit</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Frequently
  check permissions on cloud storage to ensure proper permissions are set to
  deny open or unprivileged access to resources. Consider using automated
  resource checkers such as CloudSploit or Divvycloud.<span
  class=normaltextrun><span style='color:black'> Frequently check role
  assignments to ensure proper permissions are set and still
  required.&nbsp;Consider using automated role checkers.</span></span></span></p>
  </td>
 </tr>
 <tr>
  <td width=109 valign=top style='width:81.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=103 valign=top style='width:77.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  perform an audit via AWS it is suggested to review information such as
  account details (credentials, users, groups, roles, etc), mobile
  applications, EC2 configurations, policies, and account activity. How to
  audit these different factors can be found in detail at: <b>https://docs.aws.amazon.com/general/latest/gr/aws-security-audit-guide.html.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=109 valign=top style='width:81.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=103 valign=top style='width:77.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  perform an audit via Azure an administrator can review the audit logs that
  are recorded under Azure’s monitoring for active directory. The audit logs
  allow for filtering, as well as looking at users, groups, and enterprise
  specific information. Full details on how to access this information can be
  found at: <b>https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=109 valign=top style='width:81.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=103 valign=top style='width:77.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>GCP</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  perform an audit via GCP the logs can be reviewed. GCP breaks this down into
  three categories; admin activity, data access, and system events. The audit
  logs can be viewed a few different ways- the console, API, or gcloud. Full
  details on how to view these logs, how to export, and for how to configure
  the retention period can be found here: <b>https://cloud.google.com/logging/docs/audit.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=212 colspan=2 valign=top style='width:159.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure
  Access Review</span></p>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#404040'>Consider
  using account audit functionality periodically to ensure rights are still
  required by various accounts.</span></span></p>
  </td>
 </tr>
 <tr>
  <td width=212 colspan=2 valign=top style='width:159.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Setting
  IAM Policies and Permissions</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>Implement least
  privilege and assign roles and permissions to users as necessary.  </span></span></p>
  </td>
 </tr>
 <tr>
  <td width=109 valign=top style='width:81.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=103 valign=top style='width:77.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>Amazon’s
  article for IAM security best practices in AWS covers topics including
  creating individual IAM users, using AWS managed policies, roles, frequent
  key rotation and others. Full details can be found at <b>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html.</b></span></span></p>
  </td>
 </tr>
 <tr>
  <td width=109 valign=top style='width:81.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=103 valign=top style='width:77.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=412 valign=top style='width:309.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>Microsoft’s
  article for IAM security best practices in Azure covers topics including centralizing
  identity management, turning on conditional access, use role-based access
  control, using Azure AD for storage authentication, and others. Full details
  can be found at </span></span><span lang=EN-US><a
  href="https://docs.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices"><b><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black;text-decoration:
  none'>https://docs.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices</span></b></a></span><span
  class=normaltextrun><b><span lang=EN-US style='font-size:9.0pt;font-family:
  "Arial",sans-serif;color:black'>. </span></b></span></p>
  </td>
 </tr>
</table>

<p class=paragraph style='margin:0in'><span class=normaltextrun><span
lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>

<p class=paragraph style='margin:0in'><span class=normaltextrun><span
lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Detection</span></span><span
class=eop><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><b><span lang=EN-US
  style='font-family:"Arial",sans-serif'>Detection</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Create
  Log Metric Filters and Alarms for AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>To create
  a metric filter and alarm:</span></span></p>
  <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;color:black'>1.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create a metric filter that checks for IAM policy changes and
  the <i>&lt;cloudtrail_log_group_name&gt;</i></span></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;color:black'>2.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create an SNS topic</span></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;color:black'>3.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create an SNS subscription to the above topic</span></span></p>
  <p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;color:black'>4.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
  class=normaltextrun><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create an alarm associated with the filter and SNS topic created
  in steps 1 and 2 respectively</span></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Monitor
  Activity in AWS Account</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>Various
  services in AWS offer logging features that allow for detection capabilities.
  These include CloudFront, CloudTrail, CloudWatch, Config, and S3. </span></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Monitor
  for Suspicious Activity in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>Azure AD
  can generate anomaly reports than can be run on a daily basis. Azure AD
  Identity Protection show current risks in its dashboard and provides daily
  email summary notifications. Policies can also be configured to alert to
  specific issues.</span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=paragraph style='margin:0in'><span class=eop><span lang=EN-US
style='font-size:18.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>

<div style='border:none;border-bottom:solid #A2A9B1 1.0pt;padding:0in 0in 0in 0in'>

<p class=paragraph style='margin:0in;border:none;padding:0in'><span lang=EN
style='font-size:16.0pt;font-family:"Arial",sans-serif'>References</span></p>

</div>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span lang=EN-US
style='font-family:"Arial",sans-serif;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://github.com/RhinoSecurityLabs/pacu/wiki/Module-Details"><span
style='font-family:"Arial",sans-serif;color:windowtext;text-decoration:none'>https://github.com/RhinoSecurityLabs/pacu/wiki/Module-Details</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed Feb 12, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>Sharath AV  AWS Security Flaw
which can grant admin access!
https://medium.com/ymedialabs-innovation/an-aws-managed-policy-that-allowedgranting-root-admin-access-to-any-role-51b409ea7ff0.
Accessed February 13, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>https://github.com/dagrz/aws_pwn/tree/master/reconnaissance.
Accessed Feb 20, 2020. </span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:1.2pt;text-indent:
-.25in'><span lang=EN-US style='font-family:"Arial",sans-serif'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US><a
href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/"><span
style='font-family:"Arial",sans-serif'>https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 21, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://posts.specterops.io/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a"><span
style='font-family:"Arial",sans-serif'>https://posts.specterops.io/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 21, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a href="https://github.com/hausec/PowerZure"><span
style='font-family:"Arial",sans-serif'>https://github.com/hausec/PowerZure</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 21, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://blog.netspi.com/attacking-azure-cloud-shell/"><span
style='font-family:"Arial",sans-serif'>https://blog.netspi.com/attacking-azure-cloud-shell/</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 30, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"><span
style='font-family:"Arial",sans-serif'>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed August 3, 2020.</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span lang=EN-US>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US><a
href="https://docs.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices"><span
style='font-family:"Arial",sans-serif'>https://docs.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed August 3, 2020.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

</div>

</body>

</html>
