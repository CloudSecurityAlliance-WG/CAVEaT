<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
24.0pt;font-family:"Arial",sans-serif;color:black'>Unused (Unsupported) Cloud
Regions </span><span lang=EN style='font-family:"Arial",sans-serif;color:black'>(version
1.0)</span></p>

<p class=MsoNormal style='background:white'><span lang=EN style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:14.0pt;font-family:
"Arial",sans-serif;color:#404040'>Cloud Service Label:  IaaS</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:14.0pt;font-family:
"Arial",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Description</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:black'>Adversaries may create cloud instances in
unused geographic service regions in order to evade detection. Access is
usually obtained through compromising accounts used to manage cloud
infrastructure. Cloud service providers often provide infrastructure throughout
the world in order to improve performance, provide redundancy, and allow
customers to meet compliance requirements. Oftentimes, a customer will only use
a subset of the available regions and may not actively monitor other regions.
If an adversary creates resources in an unused region, they may be able to
operate undetected.</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:black'>A variation on this behavior takes advantage of
differences in functionality across cloud regions. An adversary could utilize
regions which do not support advanced detection services in order to avoid
detection of their activity. For example, AWS GuardDuty is not supported in
every region. An example of adversary use of unused AWS regions is to mine
cryptocurrency through&nbsp;</span><span lang=EN-US style='color:black'><a
href="https://attack.mitre.org/techniques/T1496"><span style='font-family:"Arial",sans-serif;
color:black;text-decoration:none'>Resource Hijacking</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>, which can cost
organizations substantial amounts of money over time depending on the
processing power used.</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>CloudSploit</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>This blog post notes how they received an email about an ASW
  customer who had not deactivated unused regions and found there to be 50 EC2
  instances running to mine Bitcoin 24/7.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Mitigation</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Software
  Configuration</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#404040'>Cloud service providers may allow customers to deactivate
  unused regions.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Monitor
  Unused Regions</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Even if the region is unused, it should be set up to be
  monitored utilizing tools such as CloudTrail.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Deactivate
  Unused Region Endpoints</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Disable user ability to generate STS credentials in unused
  regions. </span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Don’t
  Enable New Regions Unless Required</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>If a region is not enabled by default and when a malicious actor
  attempts to create new resource, they will be asked to first enabled the
  region. They will be unable to do so if they do not have administrator
  privileges or the correct IAM role.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif;color:black'>Detection</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Detection</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Enable
  CloudTrail across all regions in AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>To enabled CloudTrail across all regions:</span></p>
  <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Sign into the AWS Management Console and open the CloudTrail
  console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Click on <i>Trails</i> </span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:
  107%'><span lang=EN-US style='font-size:9.0pt;line-height:107%;color:black'>3.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:black'>Set necessary Trails to All option in the I column</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;line-height:
  107%'><span lang=EN-US style='font-size:9.0pt;line-height:107%;color:black'>4.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:black'>Click on a trail via the link <i>Name</i> column</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Set <i>Logging</i> to <i>ON</i></span></p>
  <p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Set <i>Apply trail to all regions</i> to <i>Yes</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Configure
  log profile to capture activity logs for all regions in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>To set up activity logs for all regions:</span></p>
  <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Navigate to Azure console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Go to <i>Activity log</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Select <i>Export</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Select <i>Subscription</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Check <i>Select all</i> in <i>Regions</i></span></p>
  <p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Select <i>Save</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Monitoring
  for Regional Activity</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Tools like Splunk or even CloudSploit have the ability to alert
  based on region and ingest CloudTrail logs. In CloudSploit, a plugin called
  EC2 Max Count can be configured to alert after a certain threshold of EC2
  instances is met. Real-Time Events service is another feature of CloudSploit
  that allows alerts for activity in unused regions.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><sup><span lang=EN-US
style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></sup></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif;color:black'>References</span></p>

<p class=MsoListParagraph style='text-indent:-.25in;background:white'><a
name=scite-1></a><a name=scite-2></a><span lang=EN-US style='font-family:"Arial",sans-serif'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>https://blog.cloudsploit.com/the-danger-of-unused-aws-regions-af0bf1b878fc.
Accessed July 1, 2020.</span></p>

</div>

</body>

</html>
