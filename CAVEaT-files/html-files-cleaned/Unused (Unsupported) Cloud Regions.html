<html><head></head><body link="blue" vlink="#954F72"><div><p>Unused (Unsupported) Cloud Regions(version 1.0)</p>

<p><b>Cloud Service Label: IaaS</b></p>

<p>Description</p>
<p>Adversaries may create cloud instances in unused geographic service regions in order to evade detection. Access is usually obtained through compromising accounts used to manage cloud infrastructure. Cloud service providers often provide infrastructure throughout the world in order to improve performance, provide redundancy, and allow customers to meet compliance requirements. Oftentimes, a customer will only use a subset of the available regions and may not actively monitor other regions. If an adversary creates resources in an unused region, they may be able to operate undetected.</p>
<p>A variation on this behavior takes advantage of differences in functionality across cloud regions. An adversary could utilize regions which do not support advanced detection services in order to avoid detection of their activity. For example, AWS GuardDuty is not supported in every region. An example of adversary use of unused AWS regions is to mine cryptocurrency through<a href="https://attack.mitre.org/techniques/T1496">Resource Hijacking</a>, which can cost organizations substantial amounts of money over time depending on the processing power used.</p>

<p>Examples</p>
<table border="1" cellpadding="0" cellspacing="0"><tr><td valign="top" width="312"><p><b>Name</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>CloudSploit</p>
</td>
<td valign="top" width="312"><p>This blog post notes how they received an email about an ASW customer who had not deactivated unused regions and found there to be 50 EC2 instances running to mine Bitcoin 24/7.</p>
</td>
</tr>
</table>
<p>Mitigations</p>
<table border="1" cellpadding="0" cellspacing="0"><tr><td valign="top" width="312"><p><b>Mitigation</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Software Configuration</p>
</td>
<td valign="top" width="312"><p>Cloud service providers may allow customers to deactivate unused regions.</p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Monitor Unused Regions</p>
</td>
<td valign="top" width="312"><p>Even if the region is unused, it should be set up to be monitored utilizing tools such as CloudTrail.</p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Deactivate Unused Region Endpoints</p>
</td>
<td valign="top" width="312"><p>Disable user ability to generate STS credentials in unused regions.</p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Donâ€™t Enable New Regions Unless Required</p>
</td>
<td valign="top" width="312"><p>If a region is not enabled by default and when a malicious actor attempts to create new resource, they will be asked to first enabled the region. They will be unable to do so if they do not have administrator privileges or the correct IAM role.</p>
</td>
</tr>
</table>
<p>Detection</p>
<table border="1" cellpadding="0" cellspacing="0"><tr><td valign="top" width="312"><p><b>Detection</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Enable CloudTrail across all regions in AWS</p>
</td>
<td valign="top" width="312"><p>To enabled CloudTrail across all regions:</p>
<p>1.Sign into the AWS Management Console and open the CloudTrail console</p>
<p>2.Click on<i>Trails</i></p>
<p>3.Set necessary Trails to All option in the I column</p>
<p>4.Click on a trail via the link<i>Name</i>column</p>
<p>5.Set<i>Logging</i>to<i>ON</i></p>
<p>6.Set<i>Apply trail to all regions</i>to<i>Yes</i></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Configure log profile to capture activity logs for all regions in Azure</p>
</td>
<td valign="top" width="312"><p>To set up activity logs for all regions:</p>
<p>1.Navigate to Azure console</p>
<p>2.Go to<i>Activity log</i></p>
<p>3.Select<i>Export</i></p>
<p>4.Select<i>Subscription</i></p>
<p>5.Check<i>Select all</i>in<i>Regions</i></p>
<p>6.Select<i>Save</i></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Monitoring for Regional Activity</p>
</td>
<td valign="top" width="312"><p>Tools like Splunk or even CloudSploit have the ability to alert based on region and ingest CloudTrail logs. In CloudSploit, a plugin called EC2 Max Count can be configured to alert after a certain threshold of EC2 instances is met. Real-Time Events service is another feature of CloudSploit that allows alerts for activity in unused regions.</p>
</td>
</tr>
</table>

<p>References</p>
<p><a name="scite-1"></a><a name="scite-2"></a>1.https://blog.cloudsploit.com/the-danger-of-unused-aws-regions-af0bf1b878fc. Accessed July 1, 2020.</p>
</div></body></html>