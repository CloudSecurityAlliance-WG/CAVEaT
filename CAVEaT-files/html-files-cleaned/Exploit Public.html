<html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="Microsoft Word 15 (filtered)" name="Generator"/></head><body link="blue" vlink="#954F72"><div><p>Exploiting Public-Facing Application(version 1.0)</p>

<p><b>Cloud Service Label: IaaS, PaaS, SaaS</b></p>

<p>Description</p>
<p>The use of software, data, or commands to take advantage of a weakness in an Internet-facing computer system or program in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL), standard services (like SMB or SSH), and any other applications with Internet accessible open sockets, such as web servers and related services.</p>
<p>If an application is hosted on cloud-based infrastructure, then exploiting it may lead to compromise of the underlying instance. This can allow an adversary a path to access the cloud APIs or to take advantage of weak identity and access management policies. It should be assumed that a public web server is a weak link inside a cloud deployment and that some level of compromise is possible. Using Zero Trust principles to isolate the web server to the maximum extent possible inside a cloud deployment will reduce the likelihood of several Cloud tactics and techniques. Docker APIs are commonly exposed publicly and can be used to gain access to a shell on the container, which are also known to run as root by default.</p>

<p>For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.</p>

<p>Examples</p>
<table border="1" cellpadding="0" cellspacing="0"><tr><td valign="top" width="312"><p><b>Name</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Shodan.io</p>
</td>
<td valign="top" width="312"><p>Entering queries into Shodan.io like “Product ‘Docker’” or “Product ‘aws’” will yield results to various open APIs and public-facing services.</p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Exposed Docker Port</p>
</td>
<td valign="top" width="312"><p>Identifying an open port associated with Docker (2376 is the most common open port by default) can lead to finding running containers and images. Most containers run with default root privileges, so running<i>docker -H 192.168.1.7:2376 exec -it &lt;container name&gt; /bin/bash</i>will automatically give you root once logged in.</p>
</td>
</tr>
</table>


<p>Mitigations</p>
<table border="1" cellpadding="0" cellspacing="0" width="624"><tr><td colspan="2" valign="top" width="312"><p><b>Mitigation</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p><a href="https://attack.mitre.org/mitigations/M1048">Application Isolation and Sandboxing</a></p>


</td>
<td valign="top" width="312"><p>Application isolation will limit what other processes and system features the exploited target can access.</p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p><a href="https://attack.mitre.org/mitigations/M1050">Exploit Protection</a></p>
</td>
<td valign="top" width="312"><p>Web Application Firewalls may be used to limit exposure of applications to prevent exploit traffic from reaching the application.</p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p><a href="https://attack.mitre.org/mitigations/M1030">Network Segmentation</a></p>
</td>
<td valign="top" width="312"><p>Segment externally facing servers and services from the rest of the network with a DMZ or on separate hosting infrastructure.</p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p>Least Privilege</p>
</td>
<td valign="top" width="312"><p>All access given to users in the cloud environment should be assigned by the necessary privileges needed for team members to complete their job responsibilities.Ensure that temporary access tokens are issued rather than permanent credentials, especially when access is being granted to entities outside of the internal security boundary .</p>
</td>
</tr>
<tr><td valign="top" width="156">
</td>
<td valign="top" width="156"><p><i>AWS</i></p>
</td>
<td valign="top" width="312"><p>To implement least privilege in an AWS environment IAM policies will be used. This gives the ability to allow users to perform list, read, write, permissions management, or tagging actions. AWS suggests utilizing<i>last accessed information</i>and A<i>WS CloudTrail event history</i>to get a better understanding of privileges that might be needed or reduced based on a specific role. Full details can be found at<b>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege.</b></p>
</td>
</tr>
<tr><td valign="top" width="156">
</td>
<td valign="top" width="156"><p><i>Azure</i></p>
</td>
<td valign="top" width="312"><p>To implement least privilege in an Azure environment Azure Active Directory roles will be used. Azure outlines different tasks and the least privileged role that are suggested to be associated with the task. Those details can be found at:<b>https://docs.microsoft.com/en-us/azure/active-directory/users-groups-roles/roles-delegate-by-task.</b>To learn how to assign specific roles it can be done via the Azure Active Directory Portal. Instructions on how to assign roles can be found here:<b>https://docs.microsoft.com/en-us/azure/active-directory/users-groups-roles/directory-manage-roles-portal.</b></p>
</td>
</tr>
<tr><td valign="top" width="156">
</td>
<td valign="top" width="156"><p><i>GCP</i></p>
</td>
<td valign="top" width="312"><p>To implement least privilege in GCP it is recommended to use predefined roles (which allow for granular access permissions) instead of primitive roles (roles/owner, roles/editor, and roles/viewer). Full details on the difference between types of roles can be found here:<b>https://cloud.google.com/iam/docs/understanding-roles.</b>To assign these roles IAM service accounts are used and complete details can be found at:<b>https://cloud.google.com/iam/docs/using-iam-securely#least_privilege.</b></p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p><a href="https://attack.mitre.org/mitigations/M1051">Update Software</a></p>
</td>
<td valign="top" width="312"><p>Regularly scan externally facing systems for vulnerabilities and establish procedures to rapidly patch systems when critical vulnerabilities are discovered through scanning and through public disclosure.</p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p><a href="https://attack.mitre.org/mitigations/M1016">Vulnerability Scanning</a></p>
</td>
<td valign="top" width="312"><p>Regularly scan externally facing systems for vulnerabilities and establish procedures to rapidly patch systems when critical vulnerabilities are discovered through scanning and through public disclosure.</p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p>Disable Unnecessary Ports and Services</p>
</td>
<td valign="top" width="312"><p>Ensure ports and services that are publicly accessible are locked down and disabled if necessary. In the case of Docker, port 2376.</p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="312"><p>Assign Permissions to Containers</p>
</td>
<td valign="top" width="312"><p>By default, many containers will run as root. Before provisioning the container, set explicit permissions and users in either the Dockerfile or User ID at runtime to ensure this does not happen.</p>
</td>
</tr>
</table>
<p>Detection</p>
<p>Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Cloud-based Web Application Firewalls tied to proxies may detect improper requests attempting exploitation.</p>

<p>References</p>
<p><a name="scite-1">1.</a><a href="https://www.shodan.io/search?query=product+%22docker%22">https://www.shodan.io/search?query=product+%22docker%22</a>. Accessed July 14, 2020.</p>
<p><a name="scite-2"></a><a name="scite-3"></a><a name="scite-4"></a><a name="scite-5"></a><a name="scite-6"></a><a name="scite-7"></a><a name="scite-8"></a><a name="scite-9"></a><a name="scite-10"></a><a name="scite-11"></a>2.<a href="https://medium.com/@riccardo.ancarani94/attacking-docker-exposed-api-3e01ffc3c124">https://medium.com/@riccardo.ancarani94/attacking-docker-exposed-api-3e01ffc3c124</a>. Accessed July 14, 2020.</p>
<p>3.<a href="https://itnext.io/docker-and-kubernetes-root-vs-privileged-9d2a37453dec">Medium. (2020, June). Bryant Hagadorn – Docker and Kubernetes – root vs. Privileged. Retrieved July 14, 2020.</a></p>
<p>4.<a href="https://unit42.paloaltonetworks.com/hunting-the-public-cloud-for-exposed-hosts-and-misconfigurations/">https://unit42.paloaltonetworks.com/hunting-the-public-cloud-for-exposed-hosts-and-misconfigurations/</a>. Accessed July 14, 2020.</p>
</div></body></html>