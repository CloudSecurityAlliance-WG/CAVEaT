<html><head></head><body link="blue" vlink="#954F72"><div><p>Exploiting New Vulnerabilities in Managed Cloud Services(version 1.0)</p>

<p><b>Cloud Service Label: PaaS, SaaS</b></p>

<p>Description</p>
<p>Cloud Service Providers (CSPs) have various services within their cloud environments that can be seamlessly integrated and utilized for a customer’s needs. The purpose of managed cloud services is to remove the need to install and manage common software applications. These managed services move the responsibility of maintaining, patching, and updating to the CSPs and the vendors that provide the managed service.</p>

<p>Managed cloud services can be used at both the infrastructure and application levels. The infrastructure level includes services for providing architecture recommendations, system administration, monitoring, DNS management, Kubernetes support and many others. The application level provides support for packages like Ansible, Elasticsearch, LogStash, database management with MongoDB, and various other services as well.</p>

<p>While managed cloud services are generally thought to be more secure than running a custom or IaaS hosted application or tool, they are still susceptible to vulnerabilities and exploitation and often provide less visibility to customers than comparable IaaS-hosted versions. The Cloud Service Provider will normally remove the worry of vulnerability management through automatic patching and updating, but it is still important to be aware of potential vulnerabilities through managed cloud services, because these could still lead to exploitation of customer assets.</p>

<p>Examples</p>
<table border="1" cellpadding="0" cellspacing="0" width="623"><tr><td valign="top" width="226"><p><b>Name</b></p>
</td>
<td valign="top" width="397"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="226"><p>Azure Sphere Talos Vulnerabilities</p>
</td>
<td valign="top" width="397"><p>A blog article put out by Talos Intelligence highlights several vulnerabilities found in the Azure Sphere service, which is a cloud System on a Chip (SoC) platform designed to implement IoT application security. These vulnerabilities include information disclosure, unsigned code execution, socket memory corruption, denial of service, and privilege escalation.</p>
</td>
</tr>
</table>

<p>Mitigations</p>
<table border="1" cellpadding="0" cellspacing="0"><tr><td colspan="2" valign="top" width="215"><p><b>Mitigations</b></p>
</td>
<td valign="top" width="409"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="128"><p>Audit</p>

</td>
<td valign="top" width="87">
</td>
<td valign="top" width="409"><p>Perform periodic audits to ensure that best security practices are implemented and that unusual /unexplainable events are not occurring</p>
</td>
</tr>
<tr><td valign="top" width="128">
</td>
<td valign="top" width="87"><p><i>AWS</i></p>
</td>
<td valign="top" width="409"><p>To perform an audit via AWS it is suggested to review information such as account details (credentials, users, groups, roles, etc), mobile applications, EC2 configurations, policies, and account activity. How to audit these different factors can be found in detail at:<a href="https://docs.aws.amazon.com/general/latest/gr/aws-security-audit-guide.html"><b>https://docs.aws.amazon.com/general/latest/gr/aws-security-audit-guide.html</b></a><b>.</b></p>
</td>
</tr>
<tr><td valign="top" width="128">
</td>
<td valign="top" width="87"><p><i>Azure</i></p>
</td>
<td valign="top" width="409"><p>To perform an audit via Azure an administrator can review the audit logs that are recorded under Azure’s monitoring for active directory. The audit logs allow for filtering, as well as looking at users, groups, and enterprise specific information. Full details on how to access this information can be found at:<a href="https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs"><b>https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs</b></a><b>.</b></p>
</td>
</tr>
<tr><td valign="top" width="128">
</td>
<td valign="top" width="87"><p><i>GCP</i></p>
</td>
<td valign="top" width="409"><p>To perform an audit via GCP the logs can be reviewed. GCP breaks this down into three categories; admin activity, data access, and system events. The audit logs can be viewed a few different ways- the console, API, or gcloud. Full details on how to view these logs, how to export, and for how to configure the retention period can be found here:<a href="https://cloud.google.com/logging/docs/audit"><b>https://cloud.google.com/logging/docs/audit</b></a><b>.</b></p>
</td>
</tr>
<tr><td valign="top" width="128"><p>Setting IAM Policies and Permissions</p>
</td>
<td valign="top" width="87">
</td>
<td valign="top" width="409"><p>Implement least privilege and assign roles and permissions to users as necessary.</p>
</td>
</tr>
<tr><td valign="top" width="128">
</td>
<td valign="top" width="87"><p><i>AWS</i></p>
</td>
<td valign="top" width="409"><p>Amazon’s article for IAM security best practices in AWS covers topics including creating individual IAM users, using AWS managed policies, roles, frequent key rotation and others. Full details can be found at<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"><b>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html</b></a><b>.</b></p>
</td>
</tr>
<tr><td valign="top" width="128">
</td>
<td valign="top" width="87"><p><i>Azure</i></p>
</td>
<td valign="top" width="409"><p>Microsoft’s article for IAM security best practices in Azure covers topics including centralizing identity management, turning on conditional access, use role-based access control, using Azure AD for storage authentication, and others. Full details can be found at<a href="https://docs.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices"><b>https://docs.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices</b></a><b>.</b></p>
</td>
</tr>
</table>

<p>Detection</p>
<table border="1" cellpadding="0" cellspacing="0" width="0"><tr><td valign="top" width="312"><p><b>Detection</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Leverage IDS Rules to independently detect unusual network events within the cloud</p>
</td>
<td valign="top" width="312"><p>Implementing Snort rules 54501 – 53504 will detect attempts at exploitations specific to the above Azure Sphere vulnerabilities.</p>
</td>
</tr>
<tr><td valign="top" width="311"><p>Configure log profile to capture activity logs for all regions in Azure</p>
</td>
<td valign="top" width="311"><p>To set up activity logs for all regions:</p>
<p>1.Navigate to Azure console</p>
<p>2.Go to<i>Activity log</i></p>
<p>3.Select<i>Export</i></p>
<p>4.Select<i>Subscription</i></p>
<p>5.Check<i>Select all</i>in<i>Regions</i></p>
<p>6.Select<i>Save</i></p>
</td>
</tr>
<tr><td valign="top" width="311"><p>Enable CloudTrail across all regions in AWS</p>
</td>
<td valign="top" width="311"><p>To enable CloudTrail across all regions:</p>
<p>1.Sign into the AWS Management Console and open the CloudTrail console</p>
<p>2.Click on<i>Trails</i></p>
<p>3.Set necessary Trails to All option in the I column</p>
<p>4.Click on a trail via the link<i>Name</i>column</p>
<p>5.Set<i>Logging</i>to<i>ON</i></p>
<p>6.Set<i>Apply trail to all regions</i>to<i>Yes</i></p>
</td>
</tr>
<tr><td valign="top" width="311"><p>Monitoring for Regional Activity</p>
</td>
<td valign="top" width="311"><p>Tools like Splunk or even CloudSploit have the ability to alert based on region and ingest CloudTrail logs. In CloudSploit, a plugin called EC2 Max Count can be configured to alert after a certain threshold of EC2 instances is met. Real-Time Events service is another feature of CloudSploit that allows alerts for activity in unused regions.</p>
</td>
</tr>
</table>
<p>References</p>
<p>1.<a href="https://blog.talosintelligence.com/2020/07/vuln-spotlight-azure-sphere-july-2020.html">https://blog.talosintelligence.com/2020/07/vuln-spotlight-azure-sphere-july-2020.html</a>Accessed August 11, 2020.</p>


</div></body></html>