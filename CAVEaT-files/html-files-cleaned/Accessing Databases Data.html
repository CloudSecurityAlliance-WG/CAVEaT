<html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="Microsoft Word 15 (filtered)" name="Generator"/></head><body link="blue" vlink="#954F72"><div><p>Accessing Data from Databases(version 1.0)</p>
<p><b>Cloud Service Label: PaaS</b></p>

<p>Description</p>
<p>Both AWS and Azure have PaaS offerings for database services that are very popular. Such services can still allow traditional database access using SQL commands from the host running the SQL instance but more interestingly, a REST-based API which enables a richer, less restricted method of controlling the database. Adversaries with some cloud credentials may be able to use this API to access data from the database that more traditional SQL access might prohibit.</p>

<p>Examples</p>
<table border="1" cellpadding="0" cellspacing="0"><tr><td valign="top" width="312"><p><b>Name</b></p>
</td>
<td valign="top" width="312"><p><b>Description</b></p>
</td>
</tr>
<tr><td valign="top" width="312"><p>Snapshot-rds</p>

</td>
<td valign="top" width="312"><p>Public Nimbostratus module that abuses ability to request a snapshot of a database. Adversary then restores DB snapshot on a host that the adversary controls. This gives adversary complete access to all table data.</p>
</td>
</tr>
</table>
<p>Mitigations</p>
<table border="1" cellpadding="0" cellspacing="0" width="624"><tr><td colspan="2" valign="top" width="216"><p><b>Mitigation</b></p>
</td>
<td valign="top" width="408"><p><b>Description</b></p>
</td>
</tr>
<tr><td colspan="2" valign="top" width="216"><p>Carefully assign permissions to database API</p>
</td>
<td valign="top" width="408"><p>Care must be taken to enable read access to a database without permitting additional functionality such as create snapshots.</p>
</td>
</tr>
<tr><td valign="top" width="91">
</td>
<td valign="top" width="125"><p>AWS</p>
</td>
<td valign="top" width="408"><p>API developers will require escalated permissions to the API gateway. Information on how to properly configure API permissions on AWS can be found here:https://docs.aws.amazon.com/apigateway/latest/developerguide/permissions.html.</p>
</td>
</tr>
<tr><td valign="top" width="91">
</td>
<td valign="top" width="125"><p>Azure</p>
</td>
<td valign="top" width="408"><p>There is an API permissions page within the Azure portal that can give developers the escalated permissions they need to perform their tasks, but should be monitored and only given to those who need such permissions. Microsoft documentation outlines how to give specific permissions, as well as how resource applications can expose scopes and application roles to client applications. Both can be useful when assigning correct permissions. Documentation can be found here: https://docs.microsoft.com/en-us/azure/active-directory/develop/perms-for-given-api#recommended-documents.</p>
</td>
</tr>
</table>

<p>Detection</p>
<p>In theory requests made of the API for DB table snapshots should be captured in cloud API logs such as Azure Monitor logs and CloudTrail.</p>

<p>References</p>
<p>1.<a href="http://andresriancho.github.io/nimbostratus/">http://andresriancho.github.io/nimbostratus/</a>. Accessed Feb 23, 2020</p>

</div></body></html>