{
  "type": "vulnerability",
  "spec_version": "2.1",
  "id": "vulnerability--4c4e8e6a-0e89-4aea-9985-553f2e22b9c1",
  "created": "2025-04-25T14:22:00.000Z",
  "modified": "2025-04-25T14:22:00.000Z",
  "name": "AWS S3 Bucket Policy Confused Deputy Vulnerability",
  "description": "A vulnerability in AWS S3 bucket policies where insufficient validation of the request context allows for confused deputy attacks. This occurs when a bucket policy grants permissions to an AWS service principal (like lambda.amazonaws.com) without properly restricting which specific AWS account or resource ARN can use that service to access the bucket. The vulnerability enables unauthorized access to S3 resources across account boundaries.",
  "external_references": [
    {
      "source_name": "AWS Security Blog",
      "url": "https://aws.amazon.com/blogs/security/how-to-use-trust-policies-with-iam-roles/",
      "description": "AWS Blog on using trust policies with IAM roles"
    }
  ],
  "x_aws_affected_services": [
    "Amazon S3"
  ],
  "x_aws_affected_resource_types": [
    "AWS::S3::Bucket"
  ],
  "x_detection_methods": [
    "AWS IAM Access Analyzer",
    "Manual review of S3 bucket policies"
  ]
}
