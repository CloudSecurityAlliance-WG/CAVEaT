{
  "type": "course-of-action",
  "spec_version": "2.1",
  "id": "course-of-action--macos-pppc-profile",
  "created": "2025-04-22T12:00:00.000Z",
  "modified": "2025-04-22T12:00:00.000Z",
  "name": "Implement macOS PPPC Profiles to Block Zoom Accessibility Permissions",
  "description": "This course of action involves creating and deploying Privacy Preferences Policy Control (PPPC) profiles on macOS systems to prevent Zoom from requesting or receiving accessibility permissions at the operating system level. Since Zoom's remote control feature requires accessibility permissions to function, this approach effectively disables the remote control capability without affecting other Zoom functionality. This is a technical solution that works at the OS level and doesn't rely on Zoom's own settings, providing a robust defense even if Zoom settings are changed or bypassed.",
  "external_references": [
    {
      "source_name": "CAVEaT",
      "external_id": "CAVEaT-COA-ZOOM-003",
      "url": "https://github.com/cloudsecurityalliance/caveat/wiki/course-of-action--macos-pppc-profile"
    },
    {
      "source_name": "Trail of Bits",
      "description": "Mitigating ELUSIVE COMET Zoom remote control attacks",
      "url": "https://blog.trailofbits.com/2025/04/17/mitigating-elusive-comet-zoom-remote-control-attacks/"
    }
  ],
  "x_caveat_cloud_specific_data": {
    "affected_cloud_providers": [
      {
        "provider_name": "Zoom Cloud Services",
        "affected_services": ["Zoom Meetings"],
        "platform_specific": "macOS only",
        "implementation_complexity": "Medium",
        "effectiveness": "High",
        "implementation_instructions": {
          "manual_deployment": [
            "1. Create a PPPC profile using a mobile device management (MDM) solution or Apple Configurator",
            "2. Configure the profile to deny accessibility permissions for Zoom",
            "3. Create an XML file with the following structure:",
            "```xml",
            "<?xml version=\"1.0\" encoding=\"UTF-8\"?>",
            "<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">",
            "<plist version=\"1.0\">",
            "<dict>",
            "  <key>PayloadContent</key>",
            "  <array>",
            "    <dict>",
            "      <key>Services</key>",
            "      <dict>",
            "        <key>Accessibility</key>",
            "        <array>",
            "          <dict>",
            "            <key>Identifier</key>",
            "            <string>us.zoom.xos</string>",
            "            <key>CodeRequirement</key>",
            "            <string>identifier \"us.zoom.xos\" and anchor apple generic and certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */ and certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */ and certificate leaf[subject.OU] = BJ4HAAB9B3</string>",
            "            <key>IdentifierType</key>",
            "            <string>bundleID</string>",
            "            <key>StaticCode</key>",
            "            <false/>",
            "            <key>Allowed</key>",
            "            <false/>",
            "          </dict>",
            "        </array>",
            "      </dict>",
            "      <key>PayloadDescription</key>",
            "      <string>Configures Privacy Preferences Policy Control settings</string>",
            "      <key>PayloadDisplayName</key>",
            "      <string>Privacy Preferences Policy Control</string>",
            "      <key>PayloadIdentifier</key>",
            "      <string>com.company.zoom.pppc</string>",
            "      <key>PayloadType</key>",
            "      <string>com.apple.TCC.configuration-profile-policy</string>",
            "      <key>PayloadUUID</key>",
            "      <string>00000000-0000-0000-0000-000000000000</string>",
            "      <key>PayloadVersion</key>",
            "      <integer>1</integer>",
            "    </dict>",
            "  </array>",
            "  <key>PayloadDescription</key>",
            "  <string>Prevents Zoom from requesting accessibility access</string>",
            "  <key>PayloadDisplayName</key>",
            "  <string>Zoom PPPC Restrictions</string>",
            "  <key>PayloadIdentifier</key>",
            "  <string>com.company.zoom.restrictions</string>",
            "  <key>PayloadRemovalDisallowed</key>",
            "  <true/>",
            "  <key>PayloadScope</key>",
            "  <string>System</string>",
            "  <key>PayloadType</key>",
            "  <string>Configuration</string>",
            "  <key>PayloadUUID</key>",
            "  <string>00000000-0000-0000-0000-000000000001</string>",
            "  <key>PayloadVersion</key>",
            "  <integer>1</integer>",
            "</dict>",
            "</plist>",
            "```",
            "4. Deploy the profile to target systems via MDM or manual installation"
          ],
          "mdm_deployment": [
            "1. Configure your MDM solution (such as Jamf Pro, Kandji, or Mosyle) to deploy a PPPC profile",
            "2. Create a new PPPC profile in your MDM solution",
            "3. Add an entry for Zoom (us.zoom.xos) and set accessibility access to 'Deny'",
            "4. Deploy the profile to your managed devices",
            "5. Set the profile to be non-removable by standard users"
          ],
          "script_deployment": [
            "1. Create a bash script named 'create_zoom_pppc_profile.bash' with the following content:",
            "```bash",
            "#!/bin/bash",
            "",
            "# Create a PPPC profile that blocks Zoom from requesting accessibility permissions",
            "PROFILE_PATH=\"/tmp/zoom_pppc_profile.mobileconfig\"",
            "",
            "# Generate the profile XML",
            "cat > \"$PROFILE_PATH\" << EOF",
            "<?xml version=\"1.0\" encoding=\"UTF-8\"?>",
            "<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">",
            "<plist version=\"1.0\">",
            "<dict>",
            "  <key>PayloadContent</key>",
            "  <array>",
            "    <dict>",
            "      <key>Services</key>",
            "      <dict>",
            "        <key>Accessibility</key>",
            "        <array>",
            "          <dict>",
            "            <key>Identifier</key>",
            "            <string>us.zoom.xos</string>",
            "            <key>CodeRequirement</key>",
            "            <string>identifier \"us.zoom.xos\" and anchor apple generic and certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */ and certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */ and certificate leaf[subject.OU] = BJ4HAAB9B3</string>",
            "            <key>IdentifierType</key>",
            "            <string>bundleID</string>",
            "            <key>StaticCode</key>",
            "            <false/>",
            "            <key>Allowed</key>",
            "            <false/>",
            "          </dict>",
            "        </array>",
            "      </dict>",
            "      <key>PayloadDescription</key>",
            "      <string>Configures Privacy Preferences Policy Control settings</string>",
            "      <key>PayloadDisplayName</key>",
            "      <string>Privacy Preferences Policy Control</string>",
            "      <key>PayloadIdentifier</key>",
            "      <string>com.company.zoom.pppc</string>",
            "      <key>PayloadType</key>",
            "      <string>com.apple.TCC.configuration-profile-policy</string>",
            "      <key>PayloadUUID</key>",
            "      <string>00000000-0000-0000-0000-000000000000</string>",
            "      <key>PayloadVersion</key>",
            "      <integer>1</integer>",
            "    </dict>",
            "  </array>",
            "  <key>PayloadDescription</key>",
            "  <string>Prevents Zoom from requesting accessibility access</string>",
            "  <key>PayloadDisplayName</key>",
            "  <string>Zoom PPPC Restrictions</string>",
            "  <key>PayloadIdentifier</key>",
            "  <string>com.company.zoom.restrictions</string>",
            "  <key>PayloadRemovalDisallowed</key>",
            "  <true/>",
            "  <key>PayloadScope</key>",
            "  <string>System</string>",
            "  <key>PayloadType</key>",
            "  <string>Configuration</string>",
            "  <key>PayloadUUID</key>",
            "  <string>00000000-0000-0000-0000-000000000001</string>",
            "  <key>PayloadVersion</key>",
            "  <integer>1</integer>",
            "</dict>",
            "</plist>",
            "EOF",
            "",
            "# Install the profile",
            "echo \"Installing PPPC profile to block Zoom accessibility permissions...\"",
            "profiles -I -F \"$PROFILE_PATH\"",
            "",
            "# Clean up",
            "rm \"$PROFILE_PATH\"",
            "",
            "echo \"Profile installation complete.\"",
            "```",
            "2. Make the script executable: chmod +x create_zoom_pppc_profile.bash",
            "3. Run the script with administrative privileges: sudo ./create_zoom_pppc_profile.bash"
          ],
          "verification_steps": [
            "1. Open System Preferences/Settings > Privacy & Security > Accessibility",
            "2. Verify that Zoom is not listed, or is listed but cannot be checked",
            "3. Schedule a test Zoom meeting",
            "4. Share your screen and have another participant attempt to request remote control",
            "5. Verify that the remote control feature does not function (either the request cannot be sent or cannot be approved)"
          ]
        }
      }
    ],
    "implementation_considerations": {
      "prerequisites": "Administrative access to macOS systems; understanding of MDM and profile deployment",
      "potential_impacts": "Prevents all accessibility-related features in Zoom, not just remote control",
      "alternative_workflows": "For organizations that require some users to have remote control capabilities, consider a targeted deployment strategy that excludes specific users or groups"
    },
    "mitigation_effectiveness": {
      "coverage": "Complete for preventing remote control access on macOS systems",
      "limitations": "Only applicable to macOS; must be deployed separately for each operating system"
    }
  }
}
