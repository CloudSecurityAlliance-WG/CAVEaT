{
  "type": "course-of-action",
  "spec_version": "2.1",
  "id": "course-of-action--use-built-in-saml-certificates",
  "created": "2025-04-04T12:00:00.000Z",
  "modified": "2025-04-04T12:00:00.000Z",
  "name": "Use Built-in SAML Certificates",
  "description": "Use only built-in self-signed certificates generated by the cloud identity provider for SAML signing purposes. Avoid importing externally-generated certificates. This prevents attackers from obtaining the private key used for SAML signing, as these keys are not exportable from the cloud identity provider.",
  "external_references": [
    {
      "source_name": "Semperis",
      "url": "https://www.semperis.com/blog/meet-silver-saml/",
      "description": "Recommendations for secure certificate management"
    }
  ],
  "x_caveat_implementation_details": {
    "azure": {
      "console": "Navigate to Entra admin center > Enterprise applications > [App] > Single sign-on > SAML Certificates and use only Microsoft-generated certificates",
      "cli": "Get-AzureADServicePrincipalKeyCredential -ObjectId \"<ServicePrincipalId>\" to review, Remove-AzureADServicePrincipalKeyCredential to remove external certs",
      "api": "GET https://graph.microsoft.com/beta/servicePrincipals/{id} to check certificate source"
    },
    "aws": {
      "console": "Use IAM Identity Center for built-in certificate management instead of importing external certificates",
      "cli": "aws iam list-saml-providers to review current providers and certificates",
      "api": "GetSAMLProvider API to examine current provider configuration"
    },
    "gcp": {
      "console": "Use Google-generated certificates where possible in GCP Identity Platform",
      "cli": "gcloud beta identity platform configs update-provider with secure certificates",
      "api": "Use the Identity Platform API with secure certificate practices"
    }
  },
  "x_caveat_creation_date": "2025-04-04",
  "x_caveat_last_modified": "2025-04-04",
  "x_caveat_effectiveness_rating": "HIGH"
}