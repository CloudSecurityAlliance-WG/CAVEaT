3/22/24, 3:42 PM Hide Artifacts: Run Virtual Instance, Sub-technique T1564.006 - Enterprise | MITRE ATT&CK®
https://attack.mitre.org/techniques/T1564/006/ 1/4Thank you to Tidal Cyber and SOC Prime for becoming ATT&CK's ﬁrst Benefactors. To join the cohort, or learn more about this program visit our
Benefactors page.3/22/24, 3:42 PM Hide Artifacts: Run Virtual Instance, Sub-technique T1564.006 - Enterprise | MITRE ATT&CK®
https://attack.mitre.org/techniques/T1564/006/ 2/4Home>Techniques>Enterprise>Hide Artifacts>Run Virtual Instance3/22/24, 3:42 PM Hide Artifacts: Run Virtual Instance, Sub-technique T1564.006 - Enterprise | MITRE ATT&CK®
https://attack.mitre.org/techniques/T1564/006/ 3/4Hide Artifacts: Run Virtual Instance
Procedure Examples
ID Name Description
S0451 LoudMiner LoudMiner has used QEMU and VirtualBox to run a Tiny Core Linux virtual machine, which runs XMRig and
makes connections to the C2 server for updates.
S0449 Maze Maze operators have used VirtualBox and a Windows 7 virtual machine to run the ransomware; the virtual
machine's conﬁguration ﬁle mapped the shared network drives of the target company, presumably so Maze
can encrypt ﬁles on the shared drives as well as the local machine.
S0481 Ragnar
LockerRagnar Locker has used VirtualBox and a stripped Windows XP virtual machine to run itself. The use of a
shared folder speciﬁed in the conﬁguration enables Ragnar Locker to encrypt ﬁles on the host operating
system, including ﬁles on any mapped drives.
Mitigations
ID Mitigation Description
M1042 Disable or Remove Feature or
ProgramDisable Hyper-V if not necessary within a given environment.
M1038 Execution Prevention Use application control to mitigate installation and use of unapproved virtualization
software.Adversaries may carry out malicious operations using a virtual instance to avoid detection. A wide variety of virtualization technologies exist
that allow for the emulation of a computer or computing environment. By running malicious code inside of a virtual instance, adversaries
can hide artifacts associated with their behavior from security tools that are unable to monitor activity inside the virtual instance.
Additionally, depending on the virtual networking implementation (ex: bridged adapter), network traﬃc generated by the virtual instance can
be diﬃcult to trace back to the compromised host as the IP address and hostname might not match known values.
Adversaries may utilize native support for virtualization (ex: Hyper-V) or drop the necessary ﬁles to run a virtual instance (ex: VirtualBox
binaries). After running a virtual instance, adversaries may create a shared folder between the guest and host with permissions that enable
the virtual instance to interact with the host ﬁle system.Other sub-techniques of Hide Artifacts (11)
[1]
[2]
Version PermalinkID: T1564.006
Sub-technique of:  T1564

Tactic: Defense Evasion

Platforms: Linux, Windows, macOS

Permissions Required: User
Contributors: Janantha Marasinghe; Johann Rehberger; Menachem Shafran, XM Cyber
Version: 1.1
Created: 29 June 2020
Last Modiﬁed: 14 October 2021
[3]
[4]
[2]3/22/24, 3:42 PM Hide Artifacts: Run Virtual Instance, Sub-technique T1564.006 - Enterprise | MITRE ATT&CK®
https://attack.mitre.org/techniques/T1564/006/ 4/4Detection
ID Data Source Data Component Detects
DS0017 Command Command
ExecutionConsider monitoring for commands and arguments that may be atypical for benign
use of virtualization software. Usage of virtualization binaries or command-line
arguments associated with running a silent installation may be especially suspect
(ex. -silent , -ignore-reboot ), as well as those associated with running a headless
(in the background with no UI) virtual instance (ex. VBoxManage startvm $VM --
type headless ). Similarly, monitoring command line arguments which suppress
notiﬁcations may highlight potentially malicious activity (ex. VBoxManage.exe
setextradata global GUI/SuppressMessages "all" ). Monitor for commands
which enable hypervisors such as Hyper-V.
DS0022 File File Creation Monitor for newly constructed ﬁles associated with running a virtual instance, such
as binary ﬁles associated with common virtualization technologies (ex: VirtualBox,
VMware, QEMU, Hyper-V).
DS0007 Image Image Metadata Consider monitoring the size of virtual machines running on the system. Adversaries
may create virtual images which are smaller than those of typical virtual machines.
Network adapter information may also be helpful in detecting the use of virtual
instances.
DS0009 Process Process
CreationMonitor newly executed processes associated with running a virtual instance, such as
those launched from binary ﬁles associated with common virtualization technologies
(ex: VirtualBox, VMware, QEMU, Hyper-V).
DS0019 Service Service Creation Monitor for newly constructed services/daemons that may carry out malicious
operations using a virtual instance to avoid detection. Consider monitoring for new
Windows Service, with respect to virtualization software.
DS0024 Windows RegistryWindows
Registry Key
ModiﬁcationMonitor for changes made to Windows Registry keys and/or values that may be the
result of using a virtual instance to avoid detection. For example, if virtualization
software is installed by the adversary the Registry may provide detection
opportunities.
References[5]
[5]
1. Committee of Inquiry into the Cyber Attack on SingHealth.
(2019, January 10). Public Report of the Committee of Inquiry
into the Cyber Attack on Singapore Health Services Private
Limited's Patient Database. Retrieved June 29, 2020.
2. SophosLabs. (2020, May 21). Ragnar Locker ransomware
deploys virtual machine to dodge security. Retrieved June 29,
2020.
3. Malik, M. (2019, June 20). LoudMiner: Cross-platform mining
in cracked VST software. Retrieved May 18, 2020.4. Brandt, A., Mackenzie, P.. (2020, September 17). Maze
Attackers Adopt Ragnar Locker Virtual Machine Technique.
Retrieved October 9, 2020.
5. Johann Rehberger. (2020, September 23). Beware of the
Shadowbunny - Using virtual machines to persist and evade
detections. Retrieved September 22, 2021.