{
  "api_response": {
    "ai_query_time": "2024-06-14T04:04:31.910299",
    "ai_response_data": "{\n    \"breadcrumb\": [\n        {\"text\": \"Home\", \"url\": \"/\"},\n        {\"text\": \"Techniques\", \"url\": \"/techniques/enterprise\"},\n        {\"text\": \"Enterprise\", \"url\": \"/techniques/enterprise\"},\n        {\"text\": \"Access Token Manipulation\", \"url\": \"/techniques/T1134\"},\n        {\"text\": \"Parent PID Spoofing\"}\n    ],\n    \"main_section\": {\n        \"title\": \"Access Token Manipulation: Parent PID Spoofing\",\n        \"other_subtechniques\": [\n            {\"id\": \"T1134.001\", \"name\": \"Token Impersonation/Theft\", \"url\": \"/techniques/T1134/001/\"},\n            {\"id\": \"T1134.002\", \"name\": \"Create Process with Token\", \"url\": \"/techniques/T1134/002/\"},\n            {\"id\": \"T1134.003\", \"name\": \"Make and Impersonate Token\", \"url\": \"/techniques/T1134/003/\"},\n            {\"id\": \"T1134.004\", \"name\": \"Parent PID Spoofing\"},\n            {\"id\": \"T1134.005\", \"name\": \"SID-History Injection\", \"url\": \"/techniques/T1134/005/\"}\n        ],\n        \"description\": [\n            {\n                \"text\": \"Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges.\",\n                \"references\": [\n                    {\"text\": \"Stevens, D. (2009, November 22). Quickpost: SelectMyParent or Playing With the Windows Process Tree.\", \"url\": \"https://blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/\"}\n                ]\n            },\n            {\n                \"text\": \"Adversaries may abuse these mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships.\",\n                \"references\": [\n                    {\"text\": \"Montemayor, D. et al.. (2018, November 15). How User Account Control works.\", \"url\": \"https://docs.microsoft.com/windows/security/identity-protection/user-account-control/how-user-account-control-works\"},\n                    {\"text\": \"Loh, I. (2018, December 21). Detecting Parent PID Spoofing.\", \"url\": \"https://www.countercept.com/blog/detecting-parent-pid-spoofing/\"},\n                    {\"text\": \"Tafani-Dereeper, C. (2019, March 12). Building an Office macro to spoof parent processes and command line arguments.\", \"url\": \"https://blog.christophetd.fr/building-an-office-macro-to-spoof-process-parent-and-command-line/\"}\n                ]\n            },\n            {\n                \"text\": \"Explicitly assigning the PPID may also enable elevated privileges given appropriate access rights to the parent process.\",\n                \"references\": [\n                    {\"text\": \"Chester, A. (2017, November 20). Alternative methods of becoming SYSTEM.\", \"url\": \"https://blog.xpnsec.com/becoming-system/\"}\n                ]\n            }\n        ],\n        \"metadata\": {\n            \"ID\": \"T1134.004\",\n            \"Sub-technique of\": {\"id\": \"T1134\", \"url\": \"/techniques/T1134\"},\n            \"Tactics\": [\n                {\"name\": \"Defense Evasion\", \"url\": \"/tactics/TA0005\"},\n                {\"name\": \"Privilege Escalation\", \"url\": \"/tactics/TA0004\"}\n            ],\n            \"Platforms\": \"Windows\",\n            \"Permissions Required\": \"Administrator, User\",\n            \"Defense Bypassed\": \"Heuristic Detection, Host Forensic Analysis\",\n            \"Contributors\": \"Wayne Silva, F-Secure Countercept\",\n            \"Version\": \"1.0\",\n            \"Created\": \"18 February 2020\",\n            \"Last Modified\": \"03 May 2022\",\n            \"Links\": {\n                \"Version Permalink\": \"/versions/v15/techniques/T1134/004/\",\n                \"Live Version\": \"/versions/v15/techniques/T1134/004/\"\n            }\n        },\n        \"examples\": [\n            {\n                \"ID\": \"S0154\",\n                \"Name\": \"Cobalt Strike\",\n                \"Description\": \"Cobalt Strike can spawn processes with alternate PPIDs.\",\n                \"references\": [\n                    {\"text\": \"Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?\", \"url\": \"https://blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/\"},\n                    {\"text\": \"Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers.\", \"url\": \"https://web.archive.org/web/20210708035426/https://www.cobaltstrike.com/downloads/csmanual43.pdf\"}\n                ]\n            },\n            {\n                \"ID\": \"S1111\",\n                \"Name\": \"DarkGate\",\n                \"Description\": \"DarkGate relies on parent PID spoofing as part of its \\\"rootkit-like\\\" functionality to evade detection via Task Manager or Process Explorer.\",\n                \"references\": [\n                    {\"text\": \"Ernesto Fern\u00e1ndez Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service.\", \"url\": \"https://www.trellix.com/blogs/research/the-continued-evolution-of-the-darkgate-malware-as-a-service/\"}\n                ]\n            },\n            {\n                \"ID\": \"S0356\",\n                \"Name\": \"KONNI\",\n                \"Description\": \"KONNI has used parent PID spoofing to spawn a new cmd process using CreateProcessW and a handle to Taskmgr.exe.\",\n                \"references\": [\n                    {\"text\": \"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia.\", \"url\": \"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\"}\n                ]\n            },\n            {\n                \"ID\": \"S0501\",\n                \"Name\": \"PipeMon\",\n                \"Description\": \"PipeMon can use parent PID spoofing to elevate privileges.\",\n                \"references\": [\n                    {\"text\": \"Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group.\", \"url\": \"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\"}\n                ]\n            }\n        ],\n        \"mitigations\": [\n            {\n                \"text\": \"This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of system features.\"\n            }\n        ],\n        \"detection\": [\n            {\n                \"ID\": \"DS0009\",\n                \"Data Source\": \"Process\",\n                \"Components\": [\n                    {\n                        \"Component\": \"OS API Execution\",\n                        \"Description\": \"Monitor for API calls to CreateProcess/CreateProcessA, specifically those from user/potentially malicious processes and with parameters explicitly assigning PPIDs.\"\n                    },\n                    {\n                        \"Component\": \"Process Creation\",\n                        \"Description\": \"Monitor for newly constructed processes and/or command-lines that may abuse mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents.\"\n                    },\n                    {\n                        \"Component\": \"Process Metadata\",\n                        \"Description\": \"Look for inconsistencies between the various fields that store PPID information, such as the EventHeader ProcessId from data collected via Event Tracing for Windows (ETW).\"\n                    }\n                ]\n            }\n        ]\n    },\n    \"references\": [\n        {\"text\": \"Stevens, D. (2009, November 22). Quickpost: SelectMyParent or Playing With the Windows Process Tree.\", \"url\": \"https://blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/\"},\n        {\"text\": \"Montemayor, D. et al.. (2018, November 15). How User Account Control works.\", \"url\": \"https://docs.microsoft.com/windows/security/identity-protection/user-account-control/how-user-account-control-works\"},\n        {\"text\": \"Loh, I. (2018, December 21). Detecting Parent PID Spoofing.\", \"url\": \"https://www.countercept.com/blog/detecting-parent-pid-spoofing/\"},\n        {\"text\": \"Tafani-Dereeper, C. (2019, March 12). Building an Office macro to spoof parent processes and command line arguments.\", \"url\": \"https://blog.christophetd.fr/building-an-office-macro-to-spoof-process-parent-and-command-line/\"},\n        {\"text\": \"Chester, A. (2017, November 20). Alternative methods of becoming SYSTEM.\", \"url\": \"https://blog.xpnsec.com/becoming-system/\"},\n        {\"text\": \"Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?\", \"url\": \"https://blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/\"},\n        {\"text\": \"Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers.\", \"url\": \"https://web.archive.org/web/20210708035426/https://www.cobaltstrike.com/downloads/csmanual43.pdf\"},\n        {\"text\": \"Ernesto Fern\u00e1ndez Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service.\", \"url\": \"https://www.trellix.com/blogs/research/the-continued-evolution-of-the-darkgate-malware-as-a-service/\"},\n        {\"text\": \"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia.\", \"url\": \"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\"},\n        {\"text\": \"Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group.\", \"url\": \"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\"},\n        {\"text\": \"Schofield, M. & Satran, M. (2018, May 30). Process Creation Flags.\", \"url\": \"https://docs.microsoft.com/windows/desktop/ProcThread/process-creation-flags\"},\n        {\"text\": \"Secuirtyinbits . (2019, May 14). Parent PID Spoofing (Stage 2) Ataware Ransomware Part 3.\", \"url\": \"https://www.securityinbits.com/malware-analysis/parent-pid-spoofing-stage-2-ataware-ransomware-part-3\"}\n    ]\n}",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "stop",
    "ai_response_time": "2024-06-14T04:05:22.337793",
    "ai_runtime": 50.427494,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 10966,
    "tokens_output": 2433,
    "tokens_total": 13399
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1134004.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1134004.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Access Token Manipulation: Parent PID Spoofing, Sub-technique T1134.004 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1134\">Access Token Manipulation</a></li>\n        <li class=\"breadcrumb-item\">Parent PID Spoofing</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Access Token Manipulation:</span>\n                        Parent PID Spoofing\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Access Token Manipulation (5)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> T1134.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> Token Impersonation/Theft </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> T1134.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> Create Process with Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> T1134.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> Make and Impersonate Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1134.004\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        Parent PID Spoofing\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> T1134.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> SID-History Injection </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges. New processes are typically spawned directly from their parent, or calling, process unless explicitly specified. One way of explicitly assigning the PPID of a new process is via the <code>CreateProcess</code> API call, which supports a parameter that defines the PPID to use.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Stevens, D. (2009, November 22). Quickpost: SelectMyParent or Playing With the Windows Process Tree. Retrieved June 3, 2019.\" data-reference=\"DidierStevens SelectMyParent Nov 2009\"><sup><a href=\"https://blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> This functionality is used by Windows features such as User Account Control (UAC) to correctly set the PPID after a requested elevated process is spawned by SYSTEM (typically via <code>svchost.exe</code> or <code>consent.exe</code>) rather than the current user context.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Montemayor, D. et al.. (2018, November 15). How User Account Control works. Retrieved June 3, 2019.\" data-reference=\"Microsoft UAC Nov 2018\"><sup><a href=\"https://docs.microsoft.com/windows/security/identity-protection/user-account-control/how-user-account-control-works\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p><p>Adversaries may abuse these mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of <a href=\"/techniques/T1059/001\">PowerShell</a>/<a href=\"/techniques/T1218/011\">Rundll32</a> to be <code>explorer.exe</code> rather than an Office document delivered as part of <a href=\"/techniques/T1566/001\">Spearphishing Attachment</a>.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\" data-reference=\"CounterCept PPID Spoofing Dec 2018\"><sup><a href=\"https://www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> This spoofing could be executed via <a href=\"/techniques/T1059/005\">Visual Basic</a> within a malicious Office document or any code that can perform <a href=\"/techniques/T1106\">Native API</a>.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Tafani-Dereeper, C. (2019, March 12). Building an Office macro to spoof parent processes and command line arguments. Retrieved June 3, 2019.\" data-reference=\"CTD PPID Spoofing Macro Mar 2019\"><sup><a href=\"https://blog.christophetd.fr/building-an-office-macro-to-spoof-process-parent-and-command-line/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span><span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\" data-reference=\"CounterCept PPID Spoofing Dec 2018\"><sup><a href=\"https://www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p><p>Explicitly assigning the PPID may also enable elevated privileges given appropriate access rights to the parent process. For example, an adversary in a privileged user context (i.e. administrator) may spawn a new process and assign the parent as a process running as SYSTEM (such as <code>lsass.exe</code>), causing the new process to be elevated via the inherited access token.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Chester, A. (2017, November 20). Alternative methods of becoming SYSTEM. Retrieved June 4, 2019.\" data-reference=\"XPNSec PPID Nov 2017\"><sup><a href=\"https://blog.xpnsec.com/becoming-system/\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1134.004\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1134\">T1134</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The lowest level of permissions the adversary is required to be operating within to perform the (sub-)technique on a system\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Permissions Required:&nbsp;</span>Administrator, User\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Heuristic Detection, Host Forensic Analysis\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Wayne Silva, F-Secure Countercept\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.0\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>18 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>03 May 2022\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/004/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1134.004\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/004/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1134.004\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0154\"> S0154 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0154\"> Cobalt Strike </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0154\">Cobalt Strike</a> can spawn processes with alternate PPIDs.<span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?. Retrieved June 4, 2019.\" data-reference=\"CobaltStrike Daddy May 2017\"><sup><a href=\"https://blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span><span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.\" data-reference=\"Cobalt Strike Manual 4.3 November 2020\"><sup><a href=\"https://web.archive.org/web/20210708035426/https://www.cobaltstrike.com/downloads/csmanual43.pdf\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S1111\"> S1111 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S1111\"> DarkGate </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S1111\">DarkGate</a> relies on parent PID spoofing as part of its \"rootkit-like\" functionality to evade detection via Task Manager or Process Explorer.<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Ernesto Fern\u00e1ndez Provecho, Pham Duy Phuc, Ciana Driscoll &amp; Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.\" data-reference=\"Trellix Darkgate 2023\"><sup><a href=\"https://www.trellix.com/blogs/research/the-continued-evolution-of-the-darkgate-malware-as-a-service/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0356\"> S0356 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0356\"> KONNI </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0356\">KONNI</a> has used parent PID spoofing to spawn a new <code>cmd</code> process using <code>CreateProcessW</code> and a handle to <code>Taskmgr.exe</code>.<span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\" data-reference=\"Malwarebytes Konni Aug 2021\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span> </p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0501\"> S0501 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0501\"> PipeMon </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0501\">PipeMon</a> can use parent PID spoofing to elevate privileges.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Tartare, M. et al. (2020, May 21). No \" game=\"\" over\"=\"\" for=\"\" the=\"\" winnti=\"\" group.=\"\" retrieved=\"\" august=\"\" 24,=\"\" 2020.\"data-reference=\"ESET PipeMon May 2020\"><sup><a href=\"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                                <p>\n                                    This type of attack technique cannot be easily mitigated with preventive controls since\n                                    it is based on the abuse of system features.\n                                </p>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor for API calls to CreateProcess/CreateProcessA, specifically those from user/potentially malicious processes and with parameters explicitly assigning PPIDs (ex: the Process Creation Flags of 0x8XXX, indicating that the process is being created with extended startup information<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Schofield, M. &amp; Satran, M. (2018, May 30). Process Creation Flags. Retrieved June 4, 2019.\" data-reference=\"Microsoft Process Creation Flags May 2018\"><sup><a href=\"https://docs.microsoft.com/windows/desktop/ProcThread/process-creation-flags\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span>). Malicious use of CreateProcess/CreateProcessA may also be proceeded by a call to UpdateProcThreadAttribute, which may be necessary to update process creation attributes.<span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Secuirtyinbits . (2019, May 14). Parent PID Spoofing (Stage 2) Ataware Ransomware Part 3. Retrieved June 6, 2019.\" data-reference=\"Secuirtyinbits Ataware3 May 2019\"><sup><a href=\"https://www.securityinbits.com/malware-analysis/parent-pid-spoofing-stage-2-ataware-ransomware-part-3\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span>This may generate false positives from normal UAC elevation behavior, so compare to a system baseline/understanding of normal system activity if possible.</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Creation\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Creation\">Process Creation</a>\n                        </td>\n                            <td>\n                                        <p>Monitor for newly constructed processes and/or command-lines that may abuse mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of PowerShell/Rundll32 to be explorer.exe</p>\n\n                            </td>\n                    </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Metadata\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Metadata\">Process Metadata</a>\n                        </td>\n                            <td>\n                                        <p>Look for inconsistencies between the various fields that store PPID information, such as the EventHeader ProcessId from data collected via Event Tracing for Windows (ETW), Creator Process ID/Name from Windows event logs, and the ProcessID and ParentProcessID (which are also produced from ETW and other utilities such as Task Manager and Process Explorer). The ETW provided EventHeader ProcessId identifies the actual parent process.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\" data-reference=\"CounterCept PPID Spoofing Dec 2018\"><sup><a href=\"https://www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>\n\n                            </td>\n                    </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/\" target=\"_blank\">\n                        Stevens, D. (2009, November 22). Quickpost: SelectMyParent or Playing With the Windows Process Tree. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://docs.microsoft.com/windows/security/identity-protection/user-account-control/how-user-account-control-works\" target=\"_blank\">\n                        Montemayor, D. et al.. (2018, November 15). How User Account Control works. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https://www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\">\n                        Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://blog.christophetd.fr/building-an-office-macro-to-spoof-process-parent-and-command-line/\" target=\"_blank\">\n                        Tafani-Dereeper, C. (2019, March 12). Building an Office macro to spoof parent processes and command line arguments. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://blog.xpnsec.com/becoming-system/\" target=\"_blank\">\n                        Chester, A. (2017, November 20). Alternative methods of becoming SYSTEM. Retrieved June 4, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https://blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/\" target=\"_blank\">\n                        Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?. Retrieved June 4, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"7.0\">\n                                \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https://web.archive.org/web/20210708035426/https://www.cobaltstrike.com/downloads/csmanual43.pdf\" target=\"_blank\">\n                        Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https://www.trellix.com/blogs/research/the-continued-evolution-of-the-darkgate-malware-as-a-service/\" target=\"_blank\">\n                        Ernesto Fern\u00e1ndez Provecho, Pham Duy Phuc, Ciana Driscoll &amp; Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\">\n                        Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\">\n                        Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group. Retrieved August 24, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https://docs.microsoft.com/windows/desktop/ProcThread/process-creation-flags\" target=\"_blank\">\n                        Schofield, M. &amp; Satran, M. (2018, May 30). Process Creation Flags. Retrieved June 4, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https://www.securityinbits.com/malware-analysis/parent-pid-spoofing-stage-2-ataware-ransomware-part-3\" target=\"_blank\">\n                        Secuirtyinbits . (2019, May 14). Parent PID Spoofing (Stage 2) Ataware Ransomware Part 3. Retrieved June 6, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?7559\"></script>\n    <script src=\"/theme/scripts/settings.js?5365\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Access Token Manipulation: Parent PID Spoofing, Sub-technique T1134.004 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1134\">Access Token Manipulation</a></li>\n        <li class=\"breadcrumb-item\">Parent PID Spoofing</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Access Token Manipulation:</span>\n                        Parent PID Spoofing\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Access Token Manipulation (5)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> T1134.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> Token Impersonation/Theft </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> T1134.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> Create Process with Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> T1134.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> Make and Impersonate Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1134.004\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        Parent PID Spoofing\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> T1134.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> SID-History Injection </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges. New processes are typically spawned directly from their parent, or calling, process unless explicitly specified. One way of explicitly assigning the PPID of a new process is via the <code>CreateProcess</code> API call, which supports a parameter that defines the PPID to use.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Stevens, D. (2009, November 22). Quickpost: SelectMyParent or Playing With the Windows Process Tree. Retrieved June 3, 2019.\" data-reference=\"DidierStevens SelectMyParent Nov 2009\"><sup><a href=\"https:/blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> This functionality is used by Windows features such as User Account Control (UAC) to correctly set the PPID after a requested elevated process is spawned by SYSTEM (typically via <code>svchost.exe</code> or <code>consent.exe</code>) rather than the current user context.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Montemayor, D. et al.. (2018, November 15). How User Account Control works. Retrieved June 3, 2019.\" data-reference=\"Microsoft UAC Nov 2018\"><sup><a href=\"https:/docs.microsoft.com/windows/security/identity-protection/user-account-control/how-user-account-control-works\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p><p>Adversaries may abuse these mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of <a href=\"/techniques/T1059/001\">PowerShell</a>/<a href=\"/techniques/T1218/011\">Rundll32</a> to be <code>explorer.exe</code> rather than an Office document delivered as part of <a href=\"/techniques/T1566/001\">Spearphishing Attachment</a>.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\" data-reference=\"CounterCept PPID Spoofing Dec 2018\"><sup><a href=\"https:/www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> This spoofing could be executed via <a href=\"/techniques/T1059/005\">Visual Basic</a> within a malicious Office document or any code that can perform <a href=\"/techniques/T1106\">Native API</a>.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Tafani-Dereeper, C. (2019, March 12). Building an Office macro to spoof parent processes and command line arguments. Retrieved June 3, 2019.\" data-reference=\"CTD PPID Spoofing Macro Mar 2019\"><sup><a href=\"https:/blog.christophetd.fr/building-an-office-macro-to-spoof-process-parent-and-command-line/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span><span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\" data-reference=\"CounterCept PPID Spoofing Dec 2018\"><sup><a href=\"https:/www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p><p>Explicitly assigning the PPID may also enable elevated privileges given appropriate access rights to the parent process. For example, an adversary in a privileged user context (i.e. administrator) may spawn a new process and assign the parent as a process running as SYSTEM (such as <code>lsass.exe</code>), causing the new process to be elevated via the inherited access token.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Chester, A. (2017, November 20). Alternative methods of becoming SYSTEM. Retrieved June 4, 2019.\" data-reference=\"XPNSec PPID Nov 2017\"><sup><a href=\"https:/blog.xpnsec.com/becoming-system/\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1134.004\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1134\">T1134</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The lowest level of permissions the adversary is required to be operating within to perform the (sub-)technique on a system\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Permissions Required:&nbsp;</span>Administrator, User\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Heuristic Detection, Host Forensic Analysis\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Wayne Silva, F-Secure Countercept\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.0\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>18 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>03 May 2022\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/004/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1134.004\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/004/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1134.004\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0154\"> S0154 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0154\"> Cobalt Strike </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0154\">Cobalt Strike</a> can spawn processes with alternate PPIDs.<span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?. Retrieved June 4, 2019.\" data-reference=\"CobaltStrike Daddy May 2017\"><sup><a href=\"https:/blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span><span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.\" data-reference=\"Cobalt Strike Manual 4.3 November 2020\"><sup><a href=\"https:/web.archive.org/web/20210708035426/https:/www.cobaltstrike.com/downloads/csmanual43.pdf\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S1111\"> S1111 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S1111\"> DarkGate </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S1111\">DarkGate</a> relies on parent PID spoofing as part of its \"rootkit-like\" functionality to evade detection via Task Manager or Process Explorer.<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Ernesto Fern\u00e1ndez Provecho, Pham Duy Phuc, Ciana Driscoll &amp; Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.\" data-reference=\"Trellix Darkgate 2023\"><sup><a href=\"https:/www.trellix.com/blogs/research/the-continued-evolution-of-the-darkgate-malware-as-a-service/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0356\"> S0356 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0356\"> KONNI </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0356\">KONNI</a> has used parent PID spoofing to spawn a new <code>cmd</code> process using <code>CreateProcessW</code> and a handle to <code>Taskmgr.exe</code>.<span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\" data-reference=\"Malwarebytes Konni Aug 2021\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span> </p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0501\"> S0501 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0501\"> PipeMon </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0501\">PipeMon</a> can use parent PID spoofing to elevate privileges.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Tartare, M. et al. (2020, May 21). No \" game=\"\" over\"=\"\" for=\"\" the=\"\" winnti=\"\" group.=\"\" retrieved=\"\" august=\"\" 24,=\"\" 2020.\"data-reference=\"ESET PipeMon May 2020\"><sup><a href=\"https:/www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                                <p>\n                                    This type of attack technique cannot be easily mitigated with preventive controls since\n                                    it is based on the abuse of system features.\n                                </p>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor for API calls to CreateProcess/CreateProcessA, specifically those from user/potentially malicious processes and with parameters explicitly assigning PPIDs (ex: the Process Creation Flags of 0x8XXX, indicating that the process is being created with extended startup information<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Schofield, M. &amp; Satran, M. (2018, May 30). Process Creation Flags. Retrieved June 4, 2019.\" data-reference=\"Microsoft Process Creation Flags May 2018\"><sup><a href=\"https:/docs.microsoft.com/windows/desktop/ProcThread/process-creation-flags\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span>). Malicious use of CreateProcess/CreateProcessA may also be proceeded by a call to UpdateProcThreadAttribute, which may be necessary to update process creation attributes.<span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Secuirtyinbits . (2019, May 14). Parent PID Spoofing (Stage 2) Ataware Ransomware Part 3. Retrieved June 6, 2019.\" data-reference=\"Secuirtyinbits Ataware3 May 2019\"><sup><a href=\"https:/www.securityinbits.com/malware-analysis/parent-pid-spoofing-stage-2-ataware-ransomware-part-3\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span>This may generate false positives from normal UAC elevation behavior, so compare to a system baseline/understanding of normal system activity if possible.</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Creation\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Creation\">Process Creation</a>\n                        </td>\n                            <td>\n                                        <p>Monitor for newly constructed processes and/or command-lines that may abuse mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of PowerShell/Rundll32 to be explorer.exe</p>\n\n                            </td>\n                    </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Metadata\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Metadata\">Process Metadata</a>\n                        </td>\n                            <td>\n                                        <p>Look for inconsistencies between the various fields that store PPID information, such as the EventHeader ProcessId from data collected via Event Tracing for Windows (ETW), Creator Process ID/Name from Windows event logs, and the ProcessID and ParentProcessID (which are also produced from ETW and other utilities such as Task Manager and Process Explorer). The ETW provided EventHeader ProcessId identifies the actual parent process.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\" data-reference=\"CounterCept PPID Spoofing Dec 2018\"><sup><a href=\"https:/www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>\n\n                            </td>\n                    </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/\" target=\"_blank\">\n                        Stevens, D. (2009, November 22). Quickpost: SelectMyParent or Playing With the Windows Process Tree. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/docs.microsoft.com/windows/security/identity-protection/user-account-control/how-user-account-control-works\" target=\"_blank\">\n                        Montemayor, D. et al.. (2018, November 15). How User Account Control works. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https:/www.countercept.com/blog/detecting-parent-pid-spoofing/\" target=\"_blank\">\n                        Loh, I. (2018, December 21). Detecting Parent PID Spoofing. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/blog.christophetd.fr/building-an-office-macro-to-spoof-process-parent-and-command-line/\" target=\"_blank\">\n                        Tafani-Dereeper, C. (2019, March 12). Building an Office macro to spoof parent processes and command line arguments. Retrieved June 3, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/blog.xpnsec.com/becoming-system/\" target=\"_blank\">\n                        Chester, A. (2017, November 20). Alternative methods of becoming SYSTEM. Retrieved June 4, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https:/blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/\" target=\"_blank\">\n                        Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?. Retrieved June 4, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"7.0\">\n                                \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https:/web.archive.org/web/20210708035426/https:/www.cobaltstrike.com/downloads/csmanual43.pdf\" target=\"_blank\">\n                        Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https:/www.trellix.com/blogs/research/the-continued-evolution-of-the-darkgate-malware-as-a-service/\" target=\"_blank\">\n                        Ernesto Fern\u00e1ndez Provecho, Pham Duy Phuc, Ciana Driscoll &amp; Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https:/blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\">\n                        Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https:/www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\">\n                        Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group. Retrieved August 24, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https:/docs.microsoft.com/windows/desktop/ProcThread/process-creation-flags\" target=\"_blank\">\n                        Schofield, M. &amp; Satran, M. (2018, May 30). Process Creation Flags. Retrieved June 4, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https:/www.securityinbits.com/malware-analysis/parent-pid-spoofing-stage-2-ataware-ransomware-part-3\" target=\"_blank\">\n                        Secuirtyinbits . (2019, May 14). Parent PID Spoofing (Stage 2) Ataware Ransomware Part 3. Retrieved June 6, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?7559\"></script>\n    <script src=\"/theme/scripts/settings.js?5365\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "fde4f48f-86cd-4d23-b9f7-da513ba06594"
}