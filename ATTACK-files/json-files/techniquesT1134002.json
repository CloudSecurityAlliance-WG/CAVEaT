{
  "api_response": {
    "ai_query_time": "2024-06-14T04:02:18.150530",
    "ai_response_data": "{\n  \"breadcrumb\": [\n    {\n      \"text\": \"Home\",\n      \"url\": \"/\"\n    },\n    {\n      \"text\": \"Techniques\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"text\": \"Enterprise\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"text\": \"Access Token Manipulation\",\n      \"url\": \"/techniques/T1134\"\n    },\n    {\n      \"text\": \"Create Process with Token\"\n    }\n  ],\n  \"title\": \"Access Token Manipulation: Create Process with Token\",\n  \"other_sub_techniques\": [\n    {\n      \"id\": \"T1134.001\",\n      \"name\": \"Token Impersonation/Theft\",\n      \"url\": \"/techniques/T1134/001/\"\n    },\n    {\n      \"id\": \"T1134.002\",\n      \"name\": \"Create Process with Token\"\n    },\n    {\n      \"id\": \"T1134.003\",\n      \"name\": \"Make and Impersonate Token\",\n      \"url\": \"/techniques/T1134/003/\"\n    },\n    {\n      \"id\": \"T1134.004\",\n      \"name\": \"Parent PID Spoofing\",\n      \"url\": \"/techniques/T1134/004/\"\n    },\n    {\n      \"id\": \"T1134.005\",\n      \"name\": \"SID-History Injection\",\n      \"url\": \"/techniques/T1134/005/\"\n    }\n  ],\n  \"description\": [\n    \"Adversaries may create a new process with an existing token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as CreateProcessWithTokenW and runas.[1]\",\n    \"Creating processes with a token not associated with the current user may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used. For example, the token could be duplicated via Token Impersonation/Theft or created via Make and Impersonate Token before being used to create a process.\",\n    \"While this technique is distinct from Token Impersonation/Theft, the techniques can be used in conjunction where a token is duplicated and then used to create a new process.\"\n  ],\n  \"details\": {\n    \"id\": \"T1134.002\",\n    \"sub_technique_of\": {\n      \"id\": \"T1134\",\n      \"url\": \"/techniques/T1134\"\n    },\n    \"tactics\": [\n      {\n        \"name\": \"Defense Evasion\",\n        \"url\": \"/tactics/TA0005\"\n      },\n      {\n        \"name\": \"Privilege Escalation\",\n        \"url\": \"/tactics/TA0004\"\n      }\n    ],\n    \"platforms\": \"Windows\",\n    \"defense_bypassed\": [\n      \"File system access controls\",\n      \"System access controls\",\n      \"Windows User Account Control\"\n    ],\n    \"contributors\": [\n      \"Jonny Johnson\",\n      \"Vadim Khrykov\"\n    ],\n    \"version\": \"1.2\",\n    \"created\": \"18 February 2020\",\n    \"last_modified\": \"11 April 2023\",\n    \"version_permalink\": \"/versions/v15/techniques/T1134/002/\",\n    \"live_version\": \"/versions/v15/techniques/T1134/002/\"\n  },\n  \"procedure_examples\": [\n    {\n      \"id\": \"S0456\",\n      \"name\": \"Aria-body\",\n      \"url\": \"/software/S0456\",\n      \"description\": [\"Aria-body has the ability to execute a process using runas.[2]\"]\n    },\n    {\n      \"id\": \"S0344\",\n      \"name\": \"Azorult\",\n      \"url\": \"/software/S0344\",\n      \"description\": [\"Azorult can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.[3]\"]\n    },\n    {\n      \"id\": \"S0239\",\n      \"name\": \"Bankshot\",\n      \"url\": \"/software/S0239\",\n      \"description\": [\"Bankshot grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.[4]\"]\n    },\n    {\n      \"id\": \"S0363\",\n      \"name\": \"Empire\",\n      \"url\": \"/software/S0363\",\n      \"description\": [\"Empire can use Invoke-RunAs to make tokens.[5]\"]\n    },\n    {\n      \"id\": \"S0356\",\n      \"name\": \"KONNI\",\n      \"url\": \"/software/S0356\",\n      \"description\": [\"KONNI has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user.[6][7]\"]\n    },\n    {\n      \"id\": \"G0032\",\n      \"name\": \"Lazarus Group\",\n      \"url\": \"/groups/G0032\",\n      \"description\": [\"Lazarus Group keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call CreateProcessAsUserA under that user's context.[8][9]\"]\n    },\n    {\n      \"id\": \"S0501\",\n      \"name\": \"PipeMon\",\n      \"url\": \"/software/S0501\",\n      \"description\": [\"PipeMon can attempt to gain administrative privileges using token impersonation.[10]\"]\n    },\n    {\n      \"id\": \"S0378\",\n      \"name\": \"PoshC2\",\n      \"url\": \"/software/S0378\",\n      \"description\": [\"PoshC2 can use Invoke-RunAs to make tokens.[11]\"]\n    },\n    {\n      \"id\": \"S0496\",\n      \"name\": \"REvil\",\n      \"url\": \"/software/S0496\",\n      \"description\": [\"REvil can launch an instance of itself with administrative rights using runas.[12]\"]\n    },\n    {\n      \"id\": \"G0010\",\n      \"name\": \"Turla\",\n      \"url\": \"/groups/G0010\",\n      \"description\": [\"Turla RPC backdoors can impersonate or steal process tokens before executing commands.[13]\"]\n    },\n    {\n      \"id\": \"S0689\",\n      \"name\": \"WhisperGate\",\n      \"url\": \"/software/S0689\",\n      \"description\": [\"The WhisperGate third stage can use the AdvancedRun.exe tool to execute commands in the context of the Windows TrustedInstaller group via %TEMP%/AdvancedRun.exe\\\" /EXEFilename \\\"C:\\\\Windows\\\\System32\\\\sc.exe\\\" /WindowState 0 /CommandLine \\\"stop WinDefend\\\" /StartDirectory \\\"\\\" /RunAs 8 /Run.[14]\"]\n    },\n    {\n      \"id\": \"S0412\",\n      \"name\": \"ZxShell\",\n      \"url\": \"/software/S0412\",\n      \"description\": [\"ZxShell has a command called RunAs, which creates a new process as another user or process context.[15]\"]\n    }\n  ],\n  \"mitigations\": [\n    {\n      \"id\": \"M1026\",\n      \"name\": \"Privileged Account Management\",\n      \"url\": \"/mitigations/M1026\",\n      \"description\": [\"Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object. [16] Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.[17] Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command runas.[18]\"]\n    },\n    {\n      \"id\": \"M1018\",\n      \"name\": \"User Account Management\",\n      \"url\": \"/mitigations/M1018\",\n      \"description\": [\"An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.\"]\n    }\n  ],\n  \"detection\": [\n    {\n      \"id\": \"DS0017\",\n      \"name\": \"Command\",\n      \"url\": \"/datasources/DS0017\",\n      \"data_component\": \"Command Execution\",\n      \"data_component_url\": \"/datasources/DS0017/#Command%20Execution\",\n      \"description\": [\"Monitor executed commands and arguments to detect token manipulation by auditing command-line activity. Specifically, analysts should look for use of the runas command or similar artifacts. Detailed command-line logging is not enabled by default in Windows.[19]\"]\n    },\n    {\n      \"id\": \"DS0009\",\n      \"name\": \"Process\",\n      \"url\": \"/datasources/DS0009\",\n      \"data_component\": \"OS API Execution\",\n      \"data_component_url\": \"/datasources/DS0009/#OS%20API%20Execution\",\n      \"description\": [\"Monitor for API calls associated with detecting token manipulation only through careful analysis of user activity, examination of running processes, and correlation with other endpoint and network behavior. Analysts can also monitor for use of Windows APIs such as CreateProcessWithTokenW and correlate activity with other suspicious behavior to reduce false positives that may be due to normal benign use by users and administrators.\"]\n    }\n  ],\n  \"references\": [\n    {\n      \"id\": 1,\n      \"text\": \"Microsoft. (2016, August 31). Runas. Retrieved October 1, 2021.\",\n      \"url\": \"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771525(v=ws.11)\"\n    },\n    {\n      \"id\": 2,\n      \"text\": \"CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.\",\n      \"url\": \"https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/\"\n    },\n    {\n      \"id\": 3,\n      \"text\": \"Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018.\",\n      \"url\": \"https://researchcenter.paloaltonetworks.com/2018/11/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/\"\n    },\n    {\n      \"id\": 4,\n      \"text\": \"Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.\",\n      \"url\": \"https://securingtomorrow.mcafee.com/mcafee-labs/hidden-cobra-targets-turkish-financial-sector-new-bankshot-implant/\"\n    },\n    {\n      \"id\": 5,\n      \"text\": \"Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\",\n      \"url\": \"https://github.com/PowerShellEmpire/Empire\"\n    },\n    {\n      \"id\": 6,\n      \"text\": \"Karmi, D. (2020, January 4). A Look Into Konni 2019 Campaign. Retrieved April 28, 2020.\",\n      \"url\": \"https://medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b\"\n    },\n    {\n      \"id\": 7,\n      \"text\": \"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\",\n      \"url\": \"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\"\n    },\n    {\n      \"id\": 8,\n      \"text\": \"Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.\",\n      \"url\": \"https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\"\n    },\n    {\n      \"id\": 9,\n      \"text\": \"Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.\",\n      \"url\": \"https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf\"\n    },\n    {\n      \"id\": 10,\n      \"text\": \"Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group. Retrieved August 24, 2020.\",\n      \"url\": \"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\"\n    },\n    {\n      \"id\": 11,\n      \"text\": \"Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\",\n      \"url\": \"https://github.com/nettitude/PoshC2_Python\"\n    },\n    {\n      \"id\": 12,\n      \"text\": \"Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.\",\n      \"url\": \"https://www.secureworks.com/research/revil-sodinokibi-ransomware\"\n    },\n    {\n      \"id\": 13,\n      \"text\": \"Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.\",\n      \"url\": \"https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/\"\n    },\n    {\n      \"id\": 14,\n      \"text\": \"Biasini, N. et al.. (2022, January 21). Ukraine Campaign Delivers Defacement and Wipers, in Continued Escalation. Retrieved March 14, 2022.\",\n      \"url\": \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"\n    },\n    {\n      \"id\": 15,\n      \"text\": \"Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.\",\n      \"url\": \"https://blogs.cisco.com/security/talos/opening-zxshell\"\n    },\n    {\n      \"id\": 16,\n      \"text\": \"Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\",\n      \"url\": \"https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\"\n    },\n    {\n      \"id\": 17,\n      \"text\": \"Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\",\n      \"url\": \"https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\"\n    },\n    {\n      \"id\": 18,\n      \"text\": \"Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\",\n      \"url\": \"https://technet.microsoft.com/en-us/library/bb490994.aspx\"\n    },\n    {\n      \"id\": 19,\n      \"text\": \"Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\",\n      \"url\": \"https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\"\n    }\n  ]\n}",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "stop",
    "ai_response_time": "2024-06-14T04:03:33.768074",
    "ai_runtime": 75.617544,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 13238,
    "tokens_output": 3520,
    "tokens_total": 16758
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1134002.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1134002.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Access Token Manipulation: Create Process with Token, Sub-technique T1134.002 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1134\">Access Token Manipulation</a></li>\n        <li class=\"breadcrumb-item\">Create Process with Token</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Access Token Manipulation:</span>\n                        Create Process with Token\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Access Token Manipulation (5)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> T1134.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> Token Impersonation/Theft </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1134.002\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        Create Process with Token\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> T1134.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> Make and Impersonate Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> T1134.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> Parent PID Spoofing </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> T1134.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> SID-History Injection </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may create a new process with an existing token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as <code>CreateProcessWithTokenW</code> and <code>runas</code>.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2016, August 31). Runas. Retrieved October 1, 2021.\" data-reference=\"Microsoft RunAs\"><sup><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771525(v=ws.11)\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>Creating processes with a token not associated with the current user may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used. For example, the token could be duplicated via <a href=\"/techniques/T1134/001\">Token Impersonation/Theft</a> or created via <a href=\"/techniques/T1134/003\">Make and Impersonate Token</a> before being used to create a process.</p><p>While this technique is distinct from <a href=\"/techniques/T1134/001\">Token Impersonation/Theft</a>, the techniques can be used in conjunction where a token is duplicated and then used to create a new process.</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1134.002\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1134\">T1134</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>File system access controls, System access controls, Windows User Account Control\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Jonny Johnson; Vadim Khrykov\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.2\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>18 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>11 April 2023\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/002/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1134.002\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/002/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1134.002\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0456\"> S0456 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0456\"> Aria-body </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0456\">Aria-body</a> has the ability to execute a process using <code>runas</code>.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.\" data-reference=\"CheckPoint Naikon May 2020\"><sup><a href=\"https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0344\"> S0344 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0344\"> Azorult </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0344\">Azorult</a> can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018.\" data-reference=\"Unit42 Azorult Nov 2018\"><sup><a href=\"https://researchcenter.paloaltonetworks.com/2018/11/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0239\"> S0239 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0239\"> Bankshot </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0239\">Bankshot</a> grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.\" data-reference=\"McAfee Bankshot\"><sup><a href=\"https://securingtomorrow.mcafee.com/mcafee-labs/hidden-cobra-targets-turkish-financial-sector-new-bankshot-implant/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0363\"> S0363 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0363\"> Empire </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0363\">Empire</a> can use <code>Invoke-RunAs</code> to make tokens.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\" data-reference=\"Github PowerShell Empire\"><sup><a href=\"https://github.com/PowerShellEmpire/Empire\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0356\"> S0356 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0356\"> KONNI </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0356\">KONNI</a> has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user.<span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Karmi, D. (2020, January 4). A Look Into Konni 2019 Campaign. Retrieved April 28, 2020.\" data-reference=\"Medium KONNI Jan 2020\"><sup><a href=\"https://medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span><span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\" data-reference=\"Malwarebytes Konni Aug 2021\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span> </p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> G0032 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> Lazarus Group </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0032\">Lazarus Group</a> keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call <code>CreateProcessAsUserA</code> under that user's context.<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.\" data-reference=\"Novetta Blockbuster\"><sup><a href=\"https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span><span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.\" data-reference=\"Novetta Blockbuster Tools\"><sup><a href=\"https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0501\"> S0501 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0501\"> PipeMon </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0501\">PipeMon</a> can attempt to gain administrative privileges using token impersonation.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Tartare, M. et al. (2020, May 21). No \" game=\"\" over\"=\"\" for=\"\" the=\"\" winnti=\"\" group.=\"\" retrieved=\"\" august=\"\" 24,=\"\" 2020.\"data-reference=\"ESET PipeMon May 2020\"><sup><a href=\"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0378\"> S0378 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0378\"> PoshC2 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0378\">PoshC2</a> can use Invoke-RunAs to make tokens.<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\" data-reference=\"GitHub PoshC2\"><sup><a href=\"https://github.com/nettitude/PoshC2_Python\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0496\"> S0496 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0496\"> REvil </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0496\">REvil</a> can launch an instance of itself with administrative rights using runas.<span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.\" data-reference=\"Secureworks REvil September 2019\"><sup><a href=\"https://www.secureworks.com/research/revil-sodinokibi-ransomware\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0010\"> G0010 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0010\"> Turla </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0010\">Turla</a> RPC backdoors can impersonate or steal process tokens before executing commands.<span onclick=\"scrollToRef('scite-13')\" id=\"scite-ref-13-a\" class=\"scite-citeref-number\" title=\"Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.\" data-reference=\"ESET Turla PowerShell May 2019\"><sup><a href=\"https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span>   </p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0689\"> S0689 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0689\"> WhisperGate </a>\n                                            </td>\n                                            <td>\n                                                            <p>The <a href=\"/software/S0689\">WhisperGate</a> third stage can use the AdvancedRun.exe tool to execute commands in the context of the Windows TrustedInstaller group via <code>%TEMP%\\AdvancedRun.exe\" /EXEFilename \"C:\\Windows\\System32\\sc.exe\" /WindowState 0 /CommandLine \"stop WinDefend\" /StartDirectory \"\" /RunAs 8 /Run</code>.<span onclick=\"scrollToRef('scite-14')\" id=\"scite-ref-14-a\" class=\"scite-citeref-number\" title=\"Biasini, N. et al.. (2022, January 21). Ukraine Campaign Delivers Defacement and Wipers, in Continued Escalation. Retrieved March 14, 2022.\" data-reference=\"Cisco Ukraine Wipers January 2022\"><sup><a href=\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0412\"> S0412 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0412\"> ZxShell </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0412\">ZxShell</a> has a command called RunAs, which creates a new process as another user or process context.<span onclick=\"scrollToRef('scite-15')\" id=\"scite-ref-15-a\" class=\"scite-citeref-number\" title=\"Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.\" data-reference=\"Talos ZxShell Oct 2014\"><sup><a href=\"https://blogs.cisco.com/security/talos/opening-zxshell\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span> </p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Create a token object. <span onclick=\"scrollToRef('scite-16')\" id=\"scite-ref-16-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\" data-reference=\"Microsoft Create Token\"><sup><a href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span> Also define who can create a process level token to only the local and network service through GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Replace a process level token.<span onclick=\"scrollToRef('scite-17')\" id=\"scite-ref-17-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\" data-reference=\"Microsoft Replace Process Token\"><sup><a href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\" data-hasqtip=\"16\" aria-describedby=\"qtip-16\">[17]</a></sup></span></p><p>Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.<span onclick=\"scrollToRef('scite-18')\" id=\"scite-ref-18-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\" data-reference=\"Microsoft runas\"><sup><a href=\"https://technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\" data-hasqtip=\"17\" aria-describedby=\"qtip-17\">[18]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> M1018 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> User Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.</p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor executed commands and arguments to detect token manipulation by auditing command-line activity. Specifically, analysts should look for use of the runas command or similar artifacts. Detailed command-line logging is not enabled by default in Windows.<span onclick=\"scrollToRef('scite-19')\" id=\"scite-ref-19-a\" class=\"scite-citeref-number\" title=\"Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\" data-reference=\"Microsoft Command-line Logging\"><sup><a href=\"https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\" data-hasqtip=\"18\" aria-describedby=\"qtip-18\">[19]</a></sup></span></p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor for API calls associated with detecting token manipulation only through careful analysis of user activity, examination of running processes, and correlation with other endpoint and network behavior. Analysts can also monitor for use of Windows APIs such as <code>CreateProcessWithTokenW</code> and correlate activity with other suspicious behavior to reduce false positives that may be due to normal benign use by users and administrators.</p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771525(v=ws.11)\" target=\"_blank\">\n                        Microsoft. (2016, August 31). Runas. Retrieved October 1, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/\" target=\"_blank\">\n                        CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https://researchcenter.paloaltonetworks.com/2018/11/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/\" target=\"_blank\">\n                        Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://securingtomorrow.mcafee.com/mcafee-labs/hidden-cobra-targets-turkish-financial-sector-new-bankshot-implant/\" target=\"_blank\">\n                        Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://github.com/PowerShellEmpire/Empire\" target=\"_blank\">\n                        Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https://medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b\" target=\"_blank\">\n                        Karmi, D. (2020, January 4). A Look Into Konni 2019 Campaign. Retrieved April 28, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\">\n                        Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\" target=\"_blank\">\n                        Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf\" target=\"_blank\">\n                        Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\">\n                        Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group. Retrieved August 24, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"11.0\">\n                                \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https://github.com/nettitude/PoshC2_Python\" target=\"_blank\">\n                        Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https://www.secureworks.com/research/revil-sodinokibi-ransomware\" target=\"_blank\">\n                        Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-13\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-13\" href=\"https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/\" target=\"_blank\">\n                        Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-14\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-14\" href=\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" target=\"_blank\">\n                        Biasini, N. et al.. (2022, January 21). Ukraine Campaign Delivers Defacement and Wipers, in Continued Escalation. Retrieved March 14, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-15\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-15\" href=\"https://blogs.cisco.com/security/talos/opening-zxshell\" target=\"_blank\">\n                        Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-16\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-16\" href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-17\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-17\" href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-18\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-18\" href=\"https://technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-19\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-19\" href=\"https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\">\n                        Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?7823\"></script>\n    <script src=\"/theme/scripts/settings.js?8620\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Access Token Manipulation: Create Process with Token, Sub-technique T1134.002 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1134\">Access Token Manipulation</a></li>\n        <li class=\"breadcrumb-item\">Create Process with Token</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Access Token Manipulation:</span>\n                        Create Process with Token\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Access Token Manipulation (5)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> T1134.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> Token Impersonation/Theft </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1134.002\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        Create Process with Token\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> T1134.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> Make and Impersonate Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> T1134.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> Parent PID Spoofing </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> T1134.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> SID-History Injection </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may create a new process with an existing token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as <code>CreateProcessWithTokenW</code> and <code>runas</code>.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2016, August 31). Runas. Retrieved October 1, 2021.\" data-reference=\"Microsoft RunAs\"><sup><a href=\"https:/docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771525(v=ws.11)\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>Creating processes with a token not associated with the current user may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used. For example, the token could be duplicated via <a href=\"/techniques/T1134/001\">Token Impersonation/Theft</a> or created via <a href=\"/techniques/T1134/003\">Make and Impersonate Token</a> before being used to create a process.</p><p>While this technique is distinct from <a href=\"/techniques/T1134/001\">Token Impersonation/Theft</a>, the techniques can be used in conjunction where a token is duplicated and then used to create a new process.</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1134.002\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1134\">T1134</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>File system access controls, System access controls, Windows User Account Control\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Jonny Johnson; Vadim Khrykov\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.2\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>18 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>11 April 2023\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/002/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1134.002\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/002/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1134.002\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0456\"> S0456 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0456\"> Aria-body </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0456\">Aria-body</a> has the ability to execute a process using <code>runas</code>.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.\" data-reference=\"CheckPoint Naikon May 2020\"><sup><a href=\"https:/research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0344\"> S0344 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0344\"> Azorult </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0344\">Azorult</a> can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018.\" data-reference=\"Unit42 Azorult Nov 2018\"><sup><a href=\"https:/researchcenter.paloaltonetworks.com/2018/11/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0239\"> S0239 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0239\"> Bankshot </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0239\">Bankshot</a> grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.\" data-reference=\"McAfee Bankshot\"><sup><a href=\"https:/securingtomorrow.mcafee.com/mcafee-labs/hidden-cobra-targets-turkish-financial-sector-new-bankshot-implant/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0363\"> S0363 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0363\"> Empire </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0363\">Empire</a> can use <code>Invoke-RunAs</code> to make tokens.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\" data-reference=\"Github PowerShell Empire\"><sup><a href=\"https:/github.com/PowerShellEmpire/Empire\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0356\"> S0356 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0356\"> KONNI </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0356\">KONNI</a> has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user.<span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Karmi, D. (2020, January 4). A Look Into Konni 2019 Campaign. Retrieved April 28, 2020.\" data-reference=\"Medium KONNI Jan 2020\"><sup><a href=\"https:/medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span><span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\" data-reference=\"Malwarebytes Konni Aug 2021\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span> </p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> G0032 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> Lazarus Group </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0032\">Lazarus Group</a> keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call <code>CreateProcessAsUserA</code> under that user's context.<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.\" data-reference=\"Novetta Blockbuster\"><sup><a href=\"https:/web.archive.org/web/20160226161828/https:/www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span><span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.\" data-reference=\"Novetta Blockbuster Tools\"><sup><a href=\"https:/www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0501\"> S0501 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0501\"> PipeMon </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0501\">PipeMon</a> can attempt to gain administrative privileges using token impersonation.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Tartare, M. et al. (2020, May 21). No \" game=\"\" over\"=\"\" for=\"\" the=\"\" winnti=\"\" group.=\"\" retrieved=\"\" august=\"\" 24,=\"\" 2020.\"data-reference=\"ESET PipeMon May 2020\"><sup><a href=\"https:/www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0378\"> S0378 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0378\"> PoshC2 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0378\">PoshC2</a> can use Invoke-RunAs to make tokens.<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\" data-reference=\"GitHub PoshC2\"><sup><a href=\"https:/github.com/nettitude/PoshC2_Python\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0496\"> S0496 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0496\"> REvil </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0496\">REvil</a> can launch an instance of itself with administrative rights using runas.<span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.\" data-reference=\"Secureworks REvil September 2019\"><sup><a href=\"https:/www.secureworks.com/research/revil-sodinokibi-ransomware\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0010\"> G0010 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0010\"> Turla </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0010\">Turla</a> RPC backdoors can impersonate or steal process tokens before executing commands.<span onclick=\"scrollToRef('scite-13')\" id=\"scite-ref-13-a\" class=\"scite-citeref-number\" title=\"Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.\" data-reference=\"ESET Turla PowerShell May 2019\"><sup><a href=\"https:/www.welivesecurity.com/2019/05/29/turla-powershell-usage/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span>   </p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0689\"> S0689 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0689\"> WhisperGate </a>\n                                            </td>\n                                            <td>\n                                                            <p>The <a href=\"/software/S0689\">WhisperGate</a> third stage can use the AdvancedRun.exe tool to execute commands in the context of the Windows TrustedInstaller group via <code>%TEMP%\\AdvancedRun.exe\" /EXEFilename \"C:\\Windows\\System32\\sc.exe\" /WindowState 0 /CommandLine \"stop WinDefend\" /StartDirectory \"\" /RunAs 8 /Run</code>.<span onclick=\"scrollToRef('scite-14')\" id=\"scite-ref-14-a\" class=\"scite-citeref-number\" title=\"Biasini, N. et al.. (2022, January 21). Ukraine Campaign Delivers Defacement and Wipers, in Continued Escalation. Retrieved March 14, 2022.\" data-reference=\"Cisco Ukraine Wipers January 2022\"><sup><a href=\"https:/blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0412\"> S0412 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0412\"> ZxShell </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0412\">ZxShell</a> has a command called RunAs, which creates a new process as another user or process context.<span onclick=\"scrollToRef('scite-15')\" id=\"scite-ref-15-a\" class=\"scite-citeref-number\" title=\"Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.\" data-reference=\"Talos ZxShell Oct 2014\"><sup><a href=\"https:/blogs.cisco.com/security/talos/opening-zxshell\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span> </p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Create a token object. <span onclick=\"scrollToRef('scite-16')\" id=\"scite-ref-16-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\" data-reference=\"Microsoft Create Token\"><sup><a href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span> Also define who can create a process level token to only the local and network service through GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Replace a process level token.<span onclick=\"scrollToRef('scite-17')\" id=\"scite-ref-17-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\" data-reference=\"Microsoft Replace Process Token\"><sup><a href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\" data-hasqtip=\"16\" aria-describedby=\"qtip-16\">[17]</a></sup></span></p><p>Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.<span onclick=\"scrollToRef('scite-18')\" id=\"scite-ref-18-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\" data-reference=\"Microsoft runas\"><sup><a href=\"https:/technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\" data-hasqtip=\"17\" aria-describedby=\"qtip-17\">[18]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> M1018 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> User Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.</p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor executed commands and arguments to detect token manipulation by auditing command-line activity. Specifically, analysts should look for use of the runas command or similar artifacts. Detailed command-line logging is not enabled by default in Windows.<span onclick=\"scrollToRef('scite-19')\" id=\"scite-ref-19-a\" class=\"scite-citeref-number\" title=\"Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\" data-reference=\"Microsoft Command-line Logging\"><sup><a href=\"https:/technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\" data-hasqtip=\"18\" aria-describedby=\"qtip-18\">[19]</a></sup></span></p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor for API calls associated with detecting token manipulation only through careful analysis of user activity, examination of running processes, and correlation with other endpoint and network behavior. Analysts can also monitor for use of Windows APIs such as <code>CreateProcessWithTokenW</code> and correlate activity with other suspicious behavior to reduce false positives that may be due to normal benign use by users and administrators.</p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771525(v=ws.11)\" target=\"_blank\">\n                        Microsoft. (2016, August 31). Runas. Retrieved October 1, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/\" target=\"_blank\">\n                        CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https:/researchcenter.paloaltonetworks.com/2018/11/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/\" target=\"_blank\">\n                        Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/securingtomorrow.mcafee.com/mcafee-labs/hidden-cobra-targets-turkish-financial-sector-new-bankshot-implant/\" target=\"_blank\">\n                        Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/github.com/PowerShellEmpire/Empire\" target=\"_blank\">\n                        Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https:/medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b\" target=\"_blank\">\n                        Karmi, D. (2020, January 4). A Look Into Konni 2019 Campaign. Retrieved April 28, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https:/blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/\" target=\"_blank\">\n                        Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https:/web.archive.org/web/20160226161828/https:/www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\" target=\"_blank\">\n                        Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https:/www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf\" target=\"_blank\">\n                        Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https:/www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/\" target=\"_blank\">\n                        Tartare, M. et al. (2020, May 21). No \u201cGame over\u201d for the Winnti Group. Retrieved August 24, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"11.0\">\n                                \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https:/github.com/nettitude/PoshC2_Python\" target=\"_blank\">\n                        Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https:/www.secureworks.com/research/revil-sodinokibi-ransomware\" target=\"_blank\">\n                        Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-13\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-13\" href=\"https:/www.welivesecurity.com/2019/05/29/turla-powershell-usage/\" target=\"_blank\">\n                        Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-14\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-14\" href=\"https:/blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" target=\"_blank\">\n                        Biasini, N. et al.. (2022, January 21). Ukraine Campaign Delivers Defacement and Wipers, in Continued Escalation. Retrieved March 14, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-15\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-15\" href=\"https:/blogs.cisco.com/security/talos/opening-zxshell\" target=\"_blank\">\n                        Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-16\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-16\" href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-17\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-17\" href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-18\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-18\" href=\"https:/technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-19\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-19\" href=\"https:/technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\">\n                        Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?7823\"></script>\n    <script src=\"/theme/scripts/settings.js?8620\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "61849062-fa77-40f0-bf66-7c60d4aa5d08"
}