<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.paragraph, li.paragraph, div.paragraph
	{mso-style-name:paragraph;
	margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.normaltextrun
	{mso-style-name:normaltextrun;}
span.eop
	{mso-style-name:eop;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-size:24.0pt;
font-family:"Arial",sans-serif;color:black'>Accessing Data from Databases </span><span
lang=EN style='font-family:"Arial",sans-serif;color:black'>(version 1.0)</span></p>

<p class=MsoNormal style='margin-top:6.0pt'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif;color:#222A35'>Cloud
Service Label:  PaaS</span></b></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-size:16.0pt;
font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:black'>Description</span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;background:white'><span lang=EN style='font-family:"Arial",sans-serif;
color:black'>Both AWS and Azure have PaaS offerings for database services that
are very popular.  Such services can still allow traditional database access
using SQL commands from the host running the SQL instance but more
interestingly, a REST-based API which enables a richer, less restricted method
of controlling the database. Adversaries with some cloud credentials may be
able to use this API to access data from the database that more traditional SQL
access might prohibit.</span></p>

<p class=MsoNormal><span lang=EN style='font-size:18.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Snapshot-rds</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-right:.1in'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>Public
  Nimbostratus module that abuses ability to request a snapshot of a database. 
  Adversary then restores DB snapshot on a host that the adversary controls.
  This gives adversary complete access to all table data.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=624
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=216 colspan=2 valign=top style='width:2.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Mitigation</span></b></p>
  </td>
  <td width=408 valign=top style='width:4.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=216 colspan=2 valign=top style='width:2.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif'>Carefully assign
  permissions to database API</span></span></p>
  </td>
  <td width=408 valign=top style='width:4.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Care must be taken to enable read access to a database without
  permitting additional functionality such as create snapshots.</span></p>
  </td>
 </tr>
 <tr>
  <td width=91 valign=top style='width:68.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>
  </td>
  <td width=125 valign=top style='width:93.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span class=normaltextrun><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>AWS</span></span></p>
  </td>
  <td width=408 valign=top style='width:4.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>API developers will require escalated permissions to the API
  gateway. Information on how to properly configure API permissions on AWS can
  be found here: </span><span lang=EN-US style='font-size:9.0pt;font-family:
  "Arial",sans-serif'>https://docs.aws.amazon.com/apigateway/latest/developerguide/permissions.html.</span></p>
  </td>
 </tr>
 <tr>
  <td width=91 valign=top style='width:68.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>
  </td>
  <td width=125 valign=top style='width:93.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span class=normaltextrun><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></span></p>
  </td>
  <td width=408 valign=top style='width:4.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>There
  is an API permissions page within the Azure portal that can give developers
  the escalated permissions they need to perform their tasks, but should be
  monitored and only given to those who need such permissions. Microsoft
  documentation outlines how to give specific permissions, as well as how
  resource applications can expose scopes and application roles to client
  applications. Both can be useful when assigning correct permissions. Documentation
  can be found here:
  https://docs.microsoft.com/en-us/azure/active-directory/develop/perms-for-given-api#recommended-documents.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=paragraph style='margin:0in'><span class=normaltextrun><span
lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>

<p class=paragraph style='margin:0in;vertical-align:baseline'><span
class=normaltextrun><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Detection</span></span><span
class=eop><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span></p>

<p class=paragraph style='margin:0in'><span lang=EN-US style='font-family:"Arial",sans-serif'>In
theory requests made of the API for DB table snapshots should be captured in
cloud API logs such as Azure Monitor logs and CloudTrail.</span></p>

<p class=paragraph style='margin:0in'><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:12.0pt;margin-right:0in;margin-bottom:
3.0pt;margin-left:0in;background:white'><span lang=EN style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:black'>References</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>1. </span><span
lang=EN-US><a href="http://andresriancho.github.io/nimbostratus/"><span
style='font-family:"Arial",sans-serif;color:windowtext;text-decoration:none'>http://andresriancho.github.io/nimbostratus/</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>.  Accessed Feb 23, 2020</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

</div>

</body>

</html>
