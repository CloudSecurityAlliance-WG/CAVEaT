<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link="#0563C1" vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><span lang=EN-US style='font-size:24.0pt;font-family:"Arial",sans-serif'>Exploit
S3 (Simple Storage Service) Permissions</span><span lang=EN-US
style='font-family:"Arial",sans-serif;color:black'> </span><span lang=EN
style='font-family:"Arial",sans-serif;color:black'>(version 1.0)</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:14.0pt;font-family:
"Arial",sans-serif;color:#39434C'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:14.0pt;font-family:
"Arial",sans-serif;color:#39434C'>Cloud Service Label:  IaaS, PaaS</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:14.0pt;font-family:
"Arial",sans-serif;color:#39434C'>&nbsp;</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Description</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>Adversaries
may be able to exploit the permissions of S3 buckets to be able to gain access
and exfiltrate data. S3 buckets are Amazon’s Simple Storage Services. They are
used to store data such as log files, JavaScript libraries, system backups,
images, etc.. This service allows users to store and access data easily, but
can be an issue if permissions are not configured properly. This can lead to
read access, download permissions to anyone who views the bucket, and open
upload permissions, both of which can be exploited by an adversary.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:3.65pt'>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:3.65pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Rhino
  Security Labs Blog Post</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:3.65pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#676767'>In this walkthrough the adversary first finds the region in
  which they wish to exploit. Once the region is determined they then start to
  probe for buckets. This is accomplished by general querying and enumeration
  of bucket names. To determine if a bucket is found that has unfettered access
  permissions the command, “sudo aws s3 ls s3://$bucketname/ --region $region”
  can be run with the expectation of returning a directory listing. Once the S3
  bucket is identified if an open upload policy can allow an adversary to upload
  malicious Javascript (or other scripts that are able to perform malicious
  activity) to all application users. Depending on permissions set buckets can
  allow for system backups to be downloaded, as well as source code, log files
  that may contain usernames and passwords, and other critical information.
  This was tested utilizing Alexa’s top 10,000 sites which resulted in 107
  buckets. 57% of the buckets had download permissions to anyone who viewed
  them, 12% had open upload permissions, and 8% had both permission errors.</span></p>
  </td>
 </tr>
 <tr style='height:3.65pt'>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:3.65pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Twilio
  S3 Bucket Exploited</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:3.65pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#767171'>The attackers found an open S3 bucket to exploit. Once this
  was found the JavaScript SDK was altered. The development kit was vandalized
  as part of an automated cyber-crime campaign that preys on JavaScript code in
  open S3 buckets to inject malicious ads into browsers.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=624
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=229 colspan=2 valign=top style='width:171.75pt;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Mitigation</span></b></p>
  </td>
  <td width=395 colspan=2 valign=top style='width:296.25pt;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=229 colspan=2 valign=top style='width:171.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Web
  Application Firewall</span></p>
  </td>
  <td width=395 colspan=2 valign=top style='width:296.25pt;border-top:none;
  border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Ensuring that cloud applications are configured behind a web
  application firewall can make it harder for an adversary to determine a
  target’s IP address. </span></p>
  </td>
 </tr>
 <tr>
  <td width=141 valign=top style='width:105.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Least
  Privilege </span></p>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=89 colspan=2 valign=top style='width:66.75pt;border-top:none;
  border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:11.0pt;line-height:107%'>&nbsp;</span></p>
  </td>
  <td width=394 valign=top style='width:295.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>All
  access given to users in the cloud environment should be assigned by the necessary
  privileges needed for team members to complete their job responsibilities.<span
  style='color:#222A35'> Ensure that temporary access tokens are issued rather
  than permanent credentials, especially when access is being granted to
  entities outside of the internal security boundary&nbsp;.</span></span></p>
  </td>
 </tr>
 <tr>
  <td width=141 valign=top style='width:105.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=89 colspan=2 valign=top style='width:66.75pt;border-top:none;
  border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=394 valign=top style='width:295.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>To
  implement least privilege in an AWS environment IAM policies will be used.
  This gives the ability to allow users to perform list, read, write,
  permissions management, or tagging actions. AWS suggests utilizing <i>last
  accessed information</i> and A<i>WS CloudTrail event history</i> to get a
  better understanding of privileges that might be needed or reduced based on a
  specific role. Full details can be found at </span><span lang=EN-US><a
  href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"><b><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:#0563C1'>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>.</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=141 valign=top style='width:105.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=89 colspan=2 valign=top style='width:66.75pt;border-top:none;
  border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=394 valign=top style='width:295.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>To
  implement least privilege in an Azure environment Azure Active Directory
  roles will be used. Azure outlines different tasks and the least privileged
  role that are suggested to be associated with the task. Those details can be
  found at:<b> </b></span><span lang=EN-US><a
  href="https://docs.microsoft.com/en-us/azure/active-directory/users-groups-roles/roles-delegate-by-task"><b><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:#0563C1'>https://docs.microsoft.com/en-us/azure/active-directory/users-groups-roles/roles-delegate-by-task</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>.</span></b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>
  To learn how to assign specific roles it can be done via the Azure Active
  Directory Portal. Instructions on how to assign roles can be found here: </span><span
  lang=EN-US><a
  href="https://docs.microsoft.com/en-us/azure/active-directory/users-groups-roles/directory-manage-roles-portal"><b><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:#0563C1'>https://docs.microsoft.com/en-us/azure/active-directory/users-groups-roles/directory-manage-roles-portal</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>.</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=141 valign=top style='width:105.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=89 colspan=2 valign=top style='width:66.75pt;border-top:none;
  border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>GCP</span></p>
  </td>
  <td width=394 valign=top style='width:295.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US><a
  href="https://cloud.google.com/blog/products/application-development/least-privilege-for-cloud-functions-using-cloud-iam"><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:#0563C1'>To implement least privilege in GCP it </span></a></span><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>is
  recommended to use predefined roles (which allow for granular access
  permissions) instead of primitive roles (roles/owner, roles/editor, and
  roles/viewer). Full details on the difference between types of roles can be
  found here: </span><span lang=EN-US><a
  href="https://cloud.google.com/iam/docs/understanding-roles"><b><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:#0563C1'>https://cloud.google.com/iam/docs/understanding-roles</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>.</span></b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>
  To assign these roles IAM service accounts are used and complete details can
  be found at: </span><span lang=EN-US><a
  href="https://cloud.google.com/iam/docs/using-iam-securely#least_privilege"><b><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:#0563C1'>https://cloud.google.com/iam/docs/using-iam-securely#least_privilege</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>.</span></b></p>
  </td>
 </tr>
 <tr height=0>
  <td width=141 style='border:none'></td>
  <td width=88 style='border:none'></td>
  <td width=1 style='border:none'></td>
  <td width=394 style='border:none'></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:18.0pt;font-family:"Arial",sans-serif;
color:black'> </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Detection
</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>This
can be detected by unknown uploads or downloads to/from the S3 buckets. </span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>References</span></p>

<p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-US>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>https://rhinosecuritylabs.com/penetration-testing/penetration-testing-aws-storage/</span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed June 30, 2020.</span></p>

</div>

</body>

</html>
