<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
24.0pt;font-family:"Arial",sans-serif;color:black'>Cloud Instance Metadata API </span><span
lang=EN style='font-family:"Arial",sans-serif;color:black'>(version 1.0)</span></p>

<p class=MsoNormal style='background:white'><span lang=EN style='font-family:
"Arial",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif;color:#39434C'>Cloud
Service Label:  IaaS</span></b></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:#39434C'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif;color:black'>Description</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:black'>Adversaries may attempt to access the Cloud
Instance Metadata API to collect credentials and other sensitive data. Most
cloud service providers support a Cloud Instance Metadata API which is a
service provided to running virtual instances that allows applications to
access information about the running virtual instance. Available information
generally includes name, security group, and additional metadata including
sensitive data such as credentials and User Data scripts that may contain
additional secrets. The Instance Metadata API is provided as a convenience to
assist in managing applications and is accessible by anyone who can access the
instance. </span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:black'>If adversaries have a presence on the running
virtual instance, they may query the Instance Metadata API directly to identify
credentials that grant access to additional resources. Additionally, attackers
may exploit a Server-Side Request Forgery (SSRF) vulnerability in a public
facing web proxy that allows the attacker to gain access to the sensitive
information via a request to the Instance Metadata API.</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:black'>The de facto standard across cloud service
providers is to host the Instance Metadata API at&nbsp; <span style='background:
#E6E6E6'>http://169.254.169.254</span>.</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Capital
  One Breach</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='background:white'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>Capital
  One Breach where a SSRF on a vulnerable application hosted on an AWS server
  allowed adversary to access server’s metadata instance and forward WAF
  account credentials back to a local workstation.  These credentials had read
  permissions to numerous S3 buckets for the organization.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=624
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><a
  href="https://attack.mitre.org/mitigations/M1037"><span style='font-size:
  9.0pt;font-family:"Arial",sans-serif;color:windowtext;text-decoration:none'>Filter
  Network Traffic</span></a></span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Cloud
  service providers support IP-based restrictions when accessing cloud
  resources. Consider using IP whitelisting along with user account management
  to ensure that data access is restricted not only to valid users, but only
  from expected IP ranges to mitigate the use of stolen credentials to access
  data.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>An
  AWS environment can be configured with network ACLs (access control lists) to
  allow or deny inbound and outbound traffic. This can be accomplished by
  accessing Amazon VPC and navigating to either inbound or outbound rules
  depending on the rule the user wishes to add and they can be added, removed,
  or edited from that panel. Full details about ACLs and how to add rules in
  AWS can be found here: <b>https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>In
  Azure storage resources can be tied exclusively to a particular virtual
  network reducing the chances that it can be accessed externally or from other
  cloud assets. This can be done multiple ways including the Azure Portal,
  Azure PowerShell, and Azure CLI (Command Line Interface). Depending on the
  method used to implement this the procedure can vary, but will include the
  need to create a security group, create a network security group, associate
  that network security group with a specific subnet and then create security
  rules that are associated to the inbound and outbound rules for that subnet.
  Full details on how to configure this utilizing the various methods can be
  found below:</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure
  Portal: <b>https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure
  PowerShell: <b>https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic-powershell</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure
  CLI: <b>https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic-cli</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Use
  AWS update</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>AWS metadata service v2 could mitigate Capitol One example,
  though it is not foolproof and not all encompassing. There are tools that can
  help with transitioning to V2 such as CloudWatch. For detailed information on
  the differences between V1 and V2, as well as how to transition from V1 to
  V2, please refer to AWS documentation at: </span><span lang=EN-US><a
  href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html"><b><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:windowtext'>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>.</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif;color:black'>Detection</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif;color:black'>Monitor access to the Instance Metadata API and
look for anomalous queries. It may be possible to detect adversary use of
credentials they have obtained. See&nbsp;</span><span lang=EN-US
style='color:black'><a href="https://attack.mitre.org/techniques/T1078"><span
style='font-family:"Arial",sans-serif;color:black;text-decoration:none'>Valid Accounts</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>&nbsp;for more
information.</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US>Detection</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US>Description</span></b><span
  lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create Log Metric
  Filters and Alarms for AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create a
  metric filter and alarm:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create a metric filter
  that checks for IAM policy changes and the <i>&lt;cloudtrail_log_group_name&gt;</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS topic</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS
  subscription to the above topic</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an alarm
  associated with the filter and SNS topic created in steps 1 and 2
  respectively</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Monitor Activity
  in AWS Account</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Various services
  in AWS offer logging features that allow for detection capabilities. These
  include CloudFront, CloudTrail, CloudWatch, Config, and S3. </span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Monitor for
  Suspicious Activity in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Azure AD can
  generate anomaly reports than can be run on a daily basis. Azure AD Identity
  Protection show current risks in its dashboard and provides daily email
  summary notifications. Policies can also be configured to alert to specific
  issues.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create Log Metric
  Filters and Alarms for CloudTrail</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create a
  metric filter and alarm:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create a filter that
  checks for CloudTrail changes and the specific <i>&lt;cloudtrail_log_group_name&gt;</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS topic
  that the alarm will notify</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an SNS
  subscription to the above topic</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Create an alarm
  associated with the filter from step 1 and SNS topic in step 2</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create Activity
  Log Alerts in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create log
  activity alerts for deletion in the Azure Console:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Navigate to <i>Monitor’
  / ‘Alerts</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Manage alert
  rules</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click on the Alert <i>Name</i>
  where Condition contains <i>operationName equals
  Microsoft.Network/networkSecurityGroups/securityRules/delete</i></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Hover a mouse over <i>Condition</i>
  to ensure it is set to <i>Whenever the Administrative Activity Log “Delete
  Security Rule (networkSecurityGroups/securityRules)” has “any” level with
  “any” status and event is initiated by “any</i>”</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Create, View, and
  Manage Activity Alerts in Azure Monitor</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To create a log
  alert in the Azure portal:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Monitor
  -&gt; Alerts</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>New alert
  rule</b> of the <b>Alerts</b> window</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Provide information in
  <b>Define alert condition</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Provide details in <b>Define
  alert details</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Specify action group
  for new alert rule under <b>Action group</b>, or create a new action group
  with + <b>New group</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Yes</b> for
  the <b>Enable rule upon creation</b> option</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Create alert
  rule</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To view and
  manage alerts:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <b>Monitor
  -&gt; Alerts -&gt; Manage alert rules</b></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select the rule you
  want to modify and double-click to edit the rule options</span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click <b>Save</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Azure Resource
  Manager Templates</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Azure Resource
  Manager templates in the format of JSON files that can be used to configure
  metric alerts in Azure Monitor. These templates can be used for simple static
  and dynamic threshold metric alerts, availability tests, and monitoring
  multiple resources.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Enable CloudTrail
  across all regions in AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To enable
  CloudTrail across all regions:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Sign into the AWS
  Management Console and open the CloudTrail console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click on <i>Trails</i>
  </span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Set necessary Trails
  to All option in the I column</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Click on a trail via
  the link <i>Name</i> column</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Set <i>Logging</i> to <i>ON</i></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Set <i>Apply trail to
  all regions</i> to <i>Yes</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>Configure log
  profile to capture activity logs for all regions in Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt'>To set up
  activity logs for all regions:</span></p>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Navigate to Azure
  console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Go to <i>Activity log</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Export</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Subscription</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Check <i>Select all</i>
  in <i>Regions</i></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-bottom:8.0pt;text-indent:
  -.25in'><span lang=EN-US style='font-size:9.0pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt'>Select <i>Save</i></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:.25in;background:white'><span lang=EN-US
style='color:#39434C'>&nbsp;</span></p>

<p class=MsoNormal style='background:white'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif;color:black'>References</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:24.75pt;text-indent:-.25in;
background:white'><span lang=EN-US style='font-family:"Arial",sans-serif'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html.
Retrieved February 3, 2020</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:24.75pt;text-indent:
-.25in;background:white'><a name=scite-2></a><span lang=EN-US style='font-family:
"Arial",sans-serif'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='font-family:"Arial",sans-serif;
color:black'>https://redlock.io/blog/instance-metadata-api-a-modern-day-trojan-horse.
Retrieved July 16, 2019</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:24.75pt;text-indent:-.25in;
background:white'><span lang=EN-US>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='font-family:"Arial",sans-serif;
color:black'>https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/.
Retrieved June 8, 2020</span></p>

<p class=MsoNormal style='margin-left:24.75pt;background:white'><span
lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:24.75pt;background:white'><span
lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:24.75pt;background:white'><span
lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

</div>

</body>

</html>
