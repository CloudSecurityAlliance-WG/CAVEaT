{
  "api_response": {
    "ai_query_time": "2024-06-14T05:58:19.730320",
    "ai_response_data": "{\n  \"breadcrumb\": [\n    {\n      \"name\": \"Home\",\n      \"url\": \"/\"\n    },\n    {\n      \"name\": \"Techniques\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"name\": \"Enterprise\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"name\": \"Subvert Trust Controls\",\n      \"url\": null\n    }\n  ],\n  \"main_section\": {\n    \"title\": \"Subvert Trust Controls\",\n    \"sub_techniques\": {\n      \"count\": 6,\n      \"items\": [\n        {\n          \"id\": \"T1553.001\",\n          \"name\": \"Gatekeeper Bypass\",\n          \"url\": \"/techniques/T1553/001/\"\n        },\n        {\n          \"id\": \"T1553.002\",\n          \"name\": \"Code Signing\",\n          \"url\": \"/techniques/T1553/002/\"\n        },\n        {\n          \"id\": \"T1553.003\",\n          \"name\": \"SIP and Trust Provider Hijacking\",\n          \"url\": \"/techniques/T1553/003/\"\n        },\n        {\n          \"id\": \"T1553.004\",\n          \"name\": \"Install Root Certificate\",\n          \"url\": \"/techniques/T1553/004/\"\n        },\n        {\n          \"id\": \"T1553.005\",\n          \"name\": \"Mark-of-the-Web Bypass\",\n          \"url\": \"/techniques/T1553/005/\"\n        },\n        {\n          \"id\": \"T1553.006\",\n          \"name\": \"Code Signing Policy Modification\",\n          \"url\": \"/techniques/T1553/006/\"\n        }\n      ]\n    },\n    \"description\": [\n      \"Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.\",\n      \"Adversaries may attempt to subvert these trust mechanisms. The method adversaries use will depend on the specific mechanism they seek to subvert. Adversaries may conduct File and Directory Permissions Modification or Modify Registry in support of subverting these controls. Adversaries may also create or steal code signing certificates to acquire trust on target systems.\"\n    ],\n    \"resources\": [\n      {\n        \"id\": \"T1553\",\n        \"attributes\": {\n          \"Sub-techniques\": [\n            {\n              \"id\": \"T1553.001\",\n              \"url\": \"/techniques/T1553/001\"\n            },\n            {\n              \"id\": \"T1553.002\",\n              \"url\": \"/techniques/T1553/002\"\n            },\n            {\n              \"id\": \"T1553.003\",\n              \"url\": \"/techniques/T1553/003\"\n            },\n            {\n              \"id\": \"T1553.004\",\n              \"url\": \"/techniques/T1553/004\"\n            },\n            {\n              \"id\": \"T1553.005\",\n              \"url\": \"/techniques/T1553/005\"\n            },\n            {\n              \"id\": \"T1553.006\",\n              \"url\": \"/techniques/T1553/006\"\n            }\n          ]\n        }\n      },\n      {\n        \"id\": \"TA0005\",\n        \"attributes\": {\n          \"Tactic\": \"Defense Evasion\",\n          \"url\": \"/tactics/TA0005\"\n        }\n      },\n      {\n        \"Platforms\": [\"Linux\", \"Windows\", \"macOS\"],\n        \"Defense Bypassed\": [\n          \"Anti-virus\",\n          \"Application Control\",\n          \"Autoruns Analysis\",\n          \"Digital Certificate Validation\",\n          \"User Mode Signature Validation\",\n          \"Windows User Account Control\"\n        ],\n        \"Version\": \"1.2\",\n        \"Created\": \"05 February 2020\",\n        \"Last Modified\": \"01 March 2024\"\n      }\n    ]\n  },\n  \"procedure_examples\": [\n    {\n      \"id\": \"G0001\",\n      \"name\": \"Axiom\",\n      \"description\": \"Axiom has used digital certificates to deliver malware.\",\n      \"url\": \"/groups/G0001\"\n    }\n  ],\n  \"mitigations\": [\n    {\n      \"id\": \"M1038\",\n      \"name\": \"Execution Prevention\",\n      \"description\": \"System settings can prevent applications from running that haven't been downloaded through the Apple Store (or other legitimate repositories) which can help mitigate some of these issues. Also enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious content.\",\n      \"url\": \"/mitigations/M1038\"\n    },\n    {\n      \"id\": \"M1028\",\n      \"name\": \"Operating System Configuration\",\n      \"description\": \"Windows Group Policy can be used to manage root certificates and the Flags value of HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\ProtectedRoots can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store.\",\n      \"url\": \"/mitigations/M1028\"\n    },\n    {\n      \"id\": \"M1026\",\n      \"name\": \"Privileged Account Management\",\n      \"description\": \"Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.\",\n      \"url\": \"/mitigations/M1026\"\n    },\n    {\n      \"id\": \"M1024\",\n      \"name\": \"Restrict Registry Permissions\",\n      \"description\": \"Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented.\",\n      \"url\": \"/mitigations/M1024\"\n    },\n    {\n      \"id\": \"M1054\",\n      \"name\": \"Software Configuration\",\n      \"description\": \"HTTP Public Key Pinning (HPKP) is one method to mitigate potential Adversary-in-the-Middle situations where an adversary uses a mis-issued or fraudulent certificate to intercept encrypted communications by enforcing use of an expected certificate.\",\n      \"url\": \"/mitigations/M1054\"\n    }\n  ],\n  \"detection\": [\n    {\n      \"id\": \"DS0017\",\n      \"name\": \"Command\",\n      \"component\": \"Command Execution\",\n      \"description\": \"Command monitoring may reveal malicious attempts to modify trust settings, such as the installation of root certificates or modifications to trust attributes/policies applied to files.\",\n      \"url\": \"/datasources/DS0017\"\n    },\n    {\n      \"id\": \"DS0022\",\n      \"name\": \"File\",\n      \"component\": \"File Metadata\",\n      \"description\": \"Collect and analyze signing certificate metadata on software that executes within the environment to look for unusual certificate characteristics and outliers.\",\n      \"url\": \"/datasources/DS0022\"\n    },\n    {\n      \"id\": \"DS0022\",\n      \"name\": \"File\",\n      \"component\": \"File Modification\",\n      \"description\": \"Periodically baseline registered SIPs and trust providers, specifically looking for new, modified, or non-Microsoft entries. Also analyze Autoruns data for oddities and anomalies, specifically malicious files attempting persistent execution by hiding within auto-starting locations. Autoruns will hide entries signed by Microsoft or Windows by default, so ensure 'Hide Microsoft Entries' and 'Hide Windows Entries' are both deselected.\",\n      \"url\": \"/datasources/DS0022\"\n    },\n    {\n      \"id\": \"DS0011\",\n      \"name\": \"Module\",\n      \"component\": \"Module Load\",\n      \"description\": \"Enable CryptoAPI v2 (CAPI) event logging to monitor and analyze error events related to failed trust validation (Event ID 81, though this event can be subverted by hijacked trust provider components) as well as any other provided information events (ex: successful validations). Code Integrity event logging may also provide valuable indicators of malicious SIP or trust provider loads, since protected processes that attempt to load a maliciously-crafted trust validation component will likely fail (Event ID 3033).\",\n      \"url\": \"/datasources/DS0011\"\n    },\n    {\n      \"id\": \"DS0009\",\n      \"name\": \"Process\",\n      \"component\": \"Process Creation\",\n      \"description\": \"Monitor processes and arguments for malicious attempts to modify trust settings, such as the installation of root certificates or modifications to trust attributes/policies applied to files.\",\n      \"url\": \"/datasources/DS0009\"\n    },\n    {\n      \"id\": \"DS0024\",\n      \"name\": \"Windows Registry\",\n      \"component\": \"Windows Registry Key Creation\",\n      \"description\": \"Monitoring the creation of (sub)keys within the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root\\\\Certificates\\\\ and [HKLM or HKCU]\\\\Software[\\\\Policies]\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\Certificates. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison.\",\n      \"url\": \"/datasources/DS0024\"\n    },\n    {\n      \"id\": \"DS0024\",\n      \"name\": \"Windows Registry\",\n      \"component\": \"Windows Registry Key Modification\",\n      \"description\": \"Monitoring changes to the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root\\\\Certificates\\\\ and [HKLM or HKCU]\\\\Software[\\\\Policies]\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\Certificates. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison. Also consider enabling the Registry Global Object Access Auditing setting in the Advanced Security Audit policy to apply a global system access control list (SACL) and event auditing on modifications to Registry values (sub)keys related to SIPs and trust providers.\",\n      \"url\": \"/datasources/DS0024\"\n    }\n  ],\n  \"references\": [\n    {\n      \"id\": 1,\n      \"text\": \"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\",\n      \"url\": \"https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\"\n    },\n    {\n      \"id\": 2,\n      \"text\": \"Ladikov, A. (2015, January 29). Why You Shouldn't Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016.\",\n      \"url\": \"https://securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/\"\n    },\n    {\n      \"id\": 3,\n      \"text\": \"Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016.\",\n      \"url\": \"http://www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates\"\n    },\n    {\n      \"id\": 4,\n      \"text\": \"Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.\",\n      \"url\": \"https://web.archive.org/web/20230115144216/http://www.novetta.com/wp-content/uploads/2014/11/Executive_Summary-Final_1.pdf\"\n    },\n    {\n      \"id\": 5,\n      \"text\": \"Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.\",\n      \"url\": \"https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\"\n    },\n    {\n      \"id\": 6,\n      \"text\": \"Wikipedia. (2017, February 28). HTTP Public Key Pinning. Retrieved March 31, 2017.\",\n      \"url\": \"https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\"\n    },\n    {\n      \"id\": 7,\n      \"text\": \"Entrust Datacard. (2017, August 16). How do I enable CAPI 2.0 logging in Windows Vista, Windows 7 and Windows 2008 Server?. Retrieved January 31, 2018.\",\n      \"url\": \"http://www.entrust.net/knowledge-base/technote.cfm?tn=8165\"\n    },\n    {\n      \"id\": 8,\n      \"text\": \"Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\",\n      \"url\": \"https://www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\"\n    },\n    {\n      \"id\": 9,\n      \"text\": \"Microsoft. (2016, August 31). Registry (Global Object Access Auditing). Retrieved January 31, 2018.\",\n      \"url\": \"https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn311461(v=ws.11)\"\n    },\n    {\n      \"id\": 10,\n      \"text\": \"Microsoft. (2012, July 2). Audit Registry. Retrieved January 31, 2018.\",\n      \"url\": \"https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd941614(v=ws.10)\"\n    }\n  ]\n}",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "stop",
    "ai_response_time": "2024-06-14T05:59:14.491211",
    "ai_runtime": 54.760891,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 11749,
    "tokens_output": 2977,
    "tokens_total": 14726
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1553.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1553.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Subvert Trust Controls, Technique T1553 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n        <li class=\"breadcrumb-item\">Subvert Trust Controls</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                        Subvert Trust Controls\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Sub-techniques (6)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.001\"> T1553.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.001\"> Gatekeeper Bypass </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.002\"> T1553.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.002\"> Code Signing </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.003\"> T1553.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.003\"> SIP and Trust Provider Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.004\"> T1553.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.004\"> Install Root Certificate </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.005\"> T1553.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.005\"> Mark-of-the-Web Bypass </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.006\"> T1553.006 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.006\"> Code Signing Policy Modification </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.</p><p>Adversaries may attempt to subvert these trust mechanisms. The method adversaries use will depend on the specific mechanism they seek to subvert. Adversaries may conduct <a href=\"/techniques/T1222\">File and Directory Permissions Modification</a> or <a href=\"/techniques/T1112\">Modify Registry</a> in support of subverting these controls.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Adversaries may also create or steal code signing certificates to acquire trust on target systems.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Ladikov, A. (2015, January 29). Why You Shouldn\u2019t Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016.\" data-reference=\"Securelist Digital Certificates\"><sup><a href=\"https://securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016.\" data-reference=\"Symantec Digital Certificates\"><sup><a href=\"http://www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> </p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1553\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-techniques:&nbsp;</span>\n                                                            <a href=\"/techniques/T1553/001\">T1553.001</a>,                                                            <a href=\"/techniques/T1553/002\">T1553.002</a>,                                                            <a href=\"/techniques/T1553/003\">T1553.003</a>,                                                            <a href=\"/techniques/T1553/004\">T1553.004</a>,                                                            <a href=\"/techniques/T1553/005\">T1553.005</a>,                                                            <a href=\"/techniques/T1553/006\">T1553.006</a>                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactic:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Linux, Windows, macOS\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Anti-virus, Application Control, Autoruns Analysis, Digital Certificate Validation, User Mode Signature Validation, Windows User Account Control\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.2\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>05 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>01 March 2024\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1553/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1553\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1553/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1553\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0001\"> G0001 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0001\"> Axiom </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0001\">Axiom</a> has used digital certificates to deliver malware.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.\" data-reference=\"Novetta-Axiom\"><sup><a href=\"https://web.archive.org/web/20230115144216/http://www.novetta.com/wp-content/uploads/2014/11/Executive_Summary-Final_1.pdf\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1038\"> M1038 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1038\"> Execution Prevention </a>\n                                                </td>\n                                                <td>\n                                                                <p>System settings can prevent applications from running that haven't been downloaded through the Apple Store (or other legitimate repositories) which can help mitigate some of these issues. Also enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious content.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> M1028 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> Operating System Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store. <span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.\" data-reference=\"SpectorOps Code Signing Dec 2017\"><sup><a href=\"https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1024\"> M1024 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1024\"> Restrict Registry Permissions </a>\n                                                </td>\n                                                <td>\n                                                                <p>Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1054\"> M1054 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1054\"> Software Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>HTTP Public Key Pinning (HPKP) is one method to mitigate potential <a href=\"/techniques/T1557\">Adversary-in-the-Middle</a> situations where and adversary uses a mis-issued or fraudulent certificate to intercept encrypted communications by enforcing use of an expected certificate. <span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Wikipedia. (2017, February 28). HTTP Public Key Pinning. Retrieved March 31, 2017.\" data-reference=\"Wikipedia HPKP\"><sup><a href=\"https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Command monitoring may reveal malicious attempts to modify trust settings, such as the installation of root certificates or modifications to trust attributes/policies applied to files.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0022\">\n                <td>\n                    <a href=\"/datasources/DS0022\">DS0022</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0022\">File</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0022/#File%20Metadata\">File Metadata</a>\n                </td>\n                    <td>\n                                <p>Collect and analyze signing certificate metadata on software that executes within the environment to look for unusual certificate characteristics and outliers.</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0022-File Modification\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0022/#File%20Modification\">File Modification</a>\n                        </td>\n                            <td>\n                                        <p>Periodically baseline registered SIPs and trust providers (Registry entries and files on disk), specifically looking for new, modified, or non-Microsoft entries.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Also analyze Autoruns data for oddities and anomalies, specifically malicious files attempting persistent execution by hiding within auto-starting locations. Autoruns will hide entries signed by Microsoft or Windows by default, so ensure \"Hide Microsoft Entries\" and \"Hide Windows Entries\" are both deselected.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>On macOS, the removal of the&nbsp;<code>com.apple.quarantine</code>&nbsp;flag by a user instead of the operating system is a suspicious action and should be examined further. Also monitor software update frameworks that may strip this&nbsp;flag when performing updates.</p>\n\n                            </td>\n                    </tr>\n            <tr class=\"datasource\" id=\"uses-DS0011\">\n                <td>\n                    <a href=\"/datasources/DS0011\">DS0011</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0011\">Module</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0011/#Module%20Load\">Module Load</a>\n                </td>\n                    <td>\n                                <p>Enable CryptoAPI v2 (CAPI) event logging&nbsp;<span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Entrust Datacard. (2017, August 16). How do I enable CAPI 2.0 logging in Windows Vista, Windows 7 and Windows 2008 Server?. Retrieved January 31, 2018.\" data-reference=\"Entrust Enable CAPI2 Aug 2017\"><sup><a href=\"http://www.entrust.net/knowledge-base/technote.cfm?tn=8165\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span>&nbsp;to monitor and analyze error events related to failed trust validation (Event ID 81, though this event can be subverted by hijacked trust provider components) as well as any other provided information events (ex: successful validations). Code Integrity event logging may also provide valuable indicators of malicious SIP or trust provider loads, since protected processes that attempt to load a maliciously-crafted trust validation component will likely fail (Event ID 3033).&nbsp;<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#Process%20Creation\">Process Creation</a>\n                </td>\n                    <td>\n                                <p>Monitor processes and arguments for malicious attempts to modify trust settings, such as the installation of root certificates or modifications to trust attributes/policies applied to files.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0024\">\n                <td>\n                    <a href=\"/datasources/DS0024\">DS0024</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0024\">Windows Registry</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0024/#Windows%20Registry%20Key%20Creation\">Windows Registry Key Creation</a>\n                </td>\n                    <td>\n                                <p>Monitoring the creation of (sub)keys within the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under&nbsp;<code>HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\</code>&nbsp;and&nbsp;[HKLM or HKCU]\\Software[\\Policies]\\Microsoft\\SystemCertificates\\Root\\Certificates\\. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison:&nbsp;<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\" data-reference=\"Tripwire AppUNBlocker\"><sup><a href=\"https://www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span>* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85* 3B1EFD3A66EA28B16697394703A72CA340A05BD5* 7F88CD7223F3C813818C994614A89C99FA3B5247* 8F43288AD272F3103B6FB1428485EA3014C0BCFE* A43489159A520F0D93D032CCAF37E7FE20A8B419* BE36A4562FB2EE05DBB3D32323ADF445084ED656* CDD4EEAE6000AC7F40C3802C171E30148030C072</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0024-Windows Registry Key Modification\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0024/#Windows%20Registry%20Key%20Modification\">Windows Registry Key Modification</a>\n                        </td>\n                            <td>\n                                        <p>Monitoring changes to the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under&nbsp;<code>HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\</code>&nbsp;and&nbsp;[HKLM or HKCU]\\Software[\\Policies]\\Microsoft\\SystemCertificates\\Root\\Certificates\\. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison:&nbsp;<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\" data-reference=\"Tripwire AppUNBlocker\"><sup><a href=\"https://www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span> Also consider enabling the Registry Global Object Access Auditing <span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2016, August 31). Registry (Global Object Access Auditing). Retrieved January 31, 2018.\" data-reference=\"Microsoft Registry Auditing Aug 2016\"><sup><a href=\"https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn311461(v=ws.11)\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span>&nbsp;setting in the Advanced Security Audit policy to apply a global system access control list (SACL) and event auditing on modifications to Registry values (sub)keys related to SIPs and trust providers:<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2012, July 2). Audit Registry. Retrieved January 31, 2018.\" data-reference=\"Microsoft Audit Registry July 2012\"><sup><a href=\"https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd941614(v=ws.10)\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span> </p>\n\n                            </td>\n                    </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\">\n                        Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/\" target=\"_blank\">\n                        Ladikov, A. (2015, January 29). Why You Shouldn\u2019t Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"http://www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates\" target=\"_blank\">\n                        Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://web.archive.org/web/20230115144216/http://www.novetta.com/wp-content/uploads/2014/11/Executive_Summary-Final_1.pdf\" target=\"_blank\">\n                        Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\" target=\"_blank\">\n                        Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"6.0\">\n                                \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\" target=\"_blank\">\n                        Wikipedia. (2017, February 28). HTTP Public Key Pinning. Retrieved March 31, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"http://www.entrust.net/knowledge-base/technote.cfm?tn=8165\" target=\"_blank\">\n                        Entrust Datacard. (2017, August 16). How do I enable CAPI 2.0 logging in Windows Vista, Windows 7 and Windows 2008 Server?. Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https://www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\" target=\"_blank\">\n                        Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn311461(v=ws.11)\" target=\"_blank\">\n                        Microsoft. (2016, August 31). Registry (Global Object Access Auditing). Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd941614(v=ws.10)\" target=\"_blank\">\n                        Microsoft. (2012, July 2). Audit Registry. Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?8793\"></script>\n    <script src=\"/theme/scripts/settings.js?2661\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-techniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Subvert Trust Controls, Technique T1553 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n        <li class=\"breadcrumb-item\">Subvert Trust Controls</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                        Subvert Trust Controls\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Sub-techniques (6)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.001\"> T1553.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.001\"> Gatekeeper Bypass </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.002\"> T1553.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.002\"> Code Signing </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.003\"> T1553.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.003\"> SIP and Trust Provider Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.004\"> T1553.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.004\"> Install Root Certificate </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.005\"> T1553.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.005\"> Mark-of-the-Web Bypass </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.006\"> T1553.006 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1553/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1553.006\"> Code Signing Policy Modification </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.</p><p>Adversaries may attempt to subvert these trust mechanisms. The method adversaries use will depend on the specific mechanism they seek to subvert. Adversaries may conduct <a href=\"/techniques/T1222\">File and Directory Permissions Modification</a> or <a href=\"/techniques/T1112\">Modify Registry</a> in support of subverting these controls.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https:/specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Adversaries may also create or steal code signing certificates to acquire trust on target systems.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Ladikov, A. (2015, January 29). Why You Shouldn\u2019t Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016.\" data-reference=\"Securelist Digital Certificates\"><sup><a href=\"https:/securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016.\" data-reference=\"Symantec Digital Certificates\"><sup><a href=\"http:/www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> </p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1553\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-techniques:&nbsp;</span>\n                                                            <a href=\"/techniques/T1553/001\">T1553.001</a>,                                                            <a href=\"/techniques/T1553/002\">T1553.002</a>,                                                            <a href=\"/techniques/T1553/003\">T1553.003</a>,                                                            <a href=\"/techniques/T1553/004\">T1553.004</a>,                                                            <a href=\"/techniques/T1553/005\">T1553.005</a>,                                                            <a href=\"/techniques/T1553/006\">T1553.006</a>                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactic:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Linux, Windows, macOS\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Anti-virus, Application Control, Autoruns Analysis, Digital Certificate Validation, User Mode Signature Validation, Windows User Account Control\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.2\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>05 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>01 March 2024\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1553/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1553\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1553/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1553\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0001\"> G0001 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0001\"> Axiom </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0001\">Axiom</a> has used digital certificates to deliver malware.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.\" data-reference=\"Novetta-Axiom\"><sup><a href=\"https:/web.archive.org/web/20230115144216/http:/www.novetta.com/wp-content/uploads/2014/11/Executive_Summary-Final_1.pdf\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1038\"> M1038 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1038\"> Execution Prevention </a>\n                                                </td>\n                                                <td>\n                                                                <p>System settings can prevent applications from running that haven't been downloaded through the Apple Store (or other legitimate repositories) which can help mitigate some of these issues. Also enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious content.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> M1028 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> Operating System Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store. <span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.\" data-reference=\"SpectorOps Code Signing Dec 2017\"><sup><a href=\"https:/posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1024\"> M1024 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1024\"> Restrict Registry Permissions </a>\n                                                </td>\n                                                <td>\n                                                                <p>Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1054\"> M1054 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1054\"> Software Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>HTTP Public Key Pinning (HPKP) is one method to mitigate potential <a href=\"/techniques/T1557\">Adversary-in-the-Middle</a> situations where and adversary uses a mis-issued or fraudulent certificate to intercept encrypted communications by enforcing use of an expected certificate. <span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Wikipedia. (2017, February 28). HTTP Public Key Pinning. Retrieved March 31, 2017.\" data-reference=\"Wikipedia HPKP\"><sup><a href=\"https:/en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Command monitoring may reveal malicious attempts to modify trust settings, such as the installation of root certificates or modifications to trust attributes/policies applied to files.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0022\">\n                <td>\n                    <a href=\"/datasources/DS0022\">DS0022</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0022\">File</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0022/#File%20Metadata\">File Metadata</a>\n                </td>\n                    <td>\n                                <p>Collect and analyze signing certificate metadata on software that executes within the environment to look for unusual certificate characteristics and outliers.</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0022-File Modification\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0022/#File%20Modification\">File Modification</a>\n                        </td>\n                            <td>\n                                        <p>Periodically baseline registered SIPs and trust providers (Registry entries and files on disk), specifically looking for new, modified, or non-Microsoft entries.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https:/specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Also analyze Autoruns data for oddities and anomalies, specifically malicious files attempting persistent execution by hiding within auto-starting locations. Autoruns will hide entries signed by Microsoft or Windows by default, so ensure \"Hide Microsoft Entries\" and \"Hide Windows Entries\" are both deselected.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https:/specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>On macOS, the removal of the&nbsp;<code>com.apple.quarantine</code>&nbsp;flag by a user instead of the operating system is a suspicious action and should be examined further. Also monitor software update frameworks that may strip this&nbsp;flag when performing updates.</p>\n\n                            </td>\n                    </tr>\n            <tr class=\"datasource\" id=\"uses-DS0011\">\n                <td>\n                    <a href=\"/datasources/DS0011\">DS0011</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0011\">Module</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0011/#Module%20Load\">Module Load</a>\n                </td>\n                    <td>\n                                <p>Enable CryptoAPI v2 (CAPI) event logging&nbsp;<span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Entrust Datacard. (2017, August 16). How do I enable CAPI 2.0 logging in Windows Vista, Windows 7 and Windows 2008 Server?. Retrieved January 31, 2018.\" data-reference=\"Entrust Enable CAPI2 Aug 2017\"><sup><a href=\"http:/www.entrust.net/knowledge-base/technote.cfm?tn=8165\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span>&nbsp;to monitor and analyze error events related to failed trust validation (Event ID 81, though this event can be subverted by hijacked trust provider components) as well as any other provided information events (ex: successful validations). Code Integrity event logging may also provide valuable indicators of malicious SIP or trust provider loads, since protected processes that attempt to load a maliciously-crafted trust validation component will likely fail (Event ID 3033).&nbsp;<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\" data-reference=\"SpectorOps Subverting Trust Sept 2017\"><sup><a href=\"https:/specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#Process%20Creation\">Process Creation</a>\n                </td>\n                    <td>\n                                <p>Monitor processes and arguments for malicious attempts to modify trust settings, such as the installation of root certificates or modifications to trust attributes/policies applied to files.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0024\">\n                <td>\n                    <a href=\"/datasources/DS0024\">DS0024</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0024\">Windows Registry</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0024/#Windows%20Registry%20Key%20Creation\">Windows Registry Key Creation</a>\n                </td>\n                    <td>\n                                <p>Monitoring the creation of (sub)keys within the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under&nbsp;<code>HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\</code>&nbsp;and&nbsp;[HKLM or HKCU]\\Software[\\Policies]\\Microsoft\\SystemCertificates\\Root\\Certificates\\. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison:&nbsp;<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\" data-reference=\"Tripwire AppUNBlocker\"><sup><a href=\"https:/www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span>* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85* 3B1EFD3A66EA28B16697394703A72CA340A05BD5* 7F88CD7223F3C813818C994614A89C99FA3B5247* 8F43288AD272F3103B6FB1428485EA3014C0BCFE* A43489159A520F0D93D032CCAF37E7FE20A8B419* BE36A4562FB2EE05DBB3D32323ADF445084ED656* CDD4EEAE6000AC7F40C3802C171E30148030C072</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0024-Windows Registry Key Modification\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0024/#Windows%20Registry%20Key%20Modification\">Windows Registry Key Modification</a>\n                        </td>\n                            <td>\n                                        <p>Monitoring changes to the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under&nbsp;<code>HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\</code>&nbsp;and&nbsp;[HKLM or HKCU]\\Software[\\Policies]\\Microsoft\\SystemCertificates\\Root\\Certificates\\. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison:&nbsp;<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\" data-reference=\"Tripwire AppUNBlocker\"><sup><a href=\"https:/www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span> Also consider enabling the Registry Global Object Access Auditing <span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2016, August 31). Registry (Global Object Access Auditing). Retrieved January 31, 2018.\" data-reference=\"Microsoft Registry Auditing Aug 2016\"><sup><a href=\"https:/docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn311461(v=ws.11)\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span>&nbsp;setting in the Advanced Security Audit policy to apply a global system access control list (SACL) and event auditing on modifications to Registry values (sub)keys related to SIPs and trust providers:<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2012, July 2). Audit Registry. Retrieved January 31, 2018.\" data-reference=\"Microsoft Audit Registry July 2012\"><sup><a href=\"https:/docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd941614(v=ws.10)\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span> </p>\n\n                            </td>\n                    </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf\" target=\"_blank\">\n                        Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/\" target=\"_blank\">\n                        Ladikov, A. (2015, January 29). Why You Shouldn\u2019t Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"http:/www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates\" target=\"_blank\">\n                        Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/web.archive.org/web/20230115144216/http:/www.novetta.com/wp-content/uploads/2014/11/Executive_Summary-Final_1.pdf\" target=\"_blank\">\n                        Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\" target=\"_blank\">\n                        Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"6.0\">\n                                \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https:/en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\" target=\"_blank\">\n                        Wikipedia. (2017, February 28). HTTP Public Key Pinning. Retrieved March 31, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"http:/www.entrust.net/knowledge-base/technote.cfm?tn=8165\" target=\"_blank\">\n                        Entrust Datacard. (2017, August 16). How do I enable CAPI 2.0 logging in Windows Vista, Windows 7 and Windows 2008 Server?. Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https:/www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/\" target=\"_blank\">\n                        Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https:/docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn311461(v=ws.11)\" target=\"_blank\">\n                        Microsoft. (2016, August 31). Registry (Global Object Access Auditing). Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https:/docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd941614(v=ws.10)\" target=\"_blank\">\n                        Microsoft. (2012, July 2). Audit Registry. Retrieved January 31, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?8793\"></script>\n    <script src=\"/theme/scripts/settings.js?2661\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-techniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "67fbf29d-93b3-4642-b22a-721806263138"
}