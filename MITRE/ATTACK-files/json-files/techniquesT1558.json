{
  "api_response": {
    "ai_query_time": "2024-06-14T07:25:40.370333",
    "ai_response_data": "{\n  \"title\": \"Steal or Forge Kerberos Tickets\",\n  \"breadcrumbs\": [\n    {\n      \"text\": \"Home\",\n      \"url\": \"/\"\n    },\n    {\n      \"text\": \"Techniques\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"text\": \"Enterprise\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"text\": \"Steal or Forge Kerberos Tickets\"\n    }\n  ],\n  \"sub_techniques\": [\n    {\n      \"id\": \"T1558.001\",\n      \"name\": \"Golden Ticket\",\n      \"url\": \"/techniques/T1558/001/\"\n    },\n    {\n      \"id\": \"T1558.002\",\n      \"name\": \"Silver Ticket\",\n      \"url\": \"/techniques/T1558/002/\"\n    },\n    {\n      \"id\": \"T1558.003\",\n      \"name\": \"Kerberoasting\",\n      \"url\": \"/techniques/T1558/003/\"\n    },\n    {\n      \"id\": \"T1558.004\",\n      \"name\": \"AS-REP Roasting\",\n      \"url\": \"/techniques/T1558/004/\"\n    }\n  ],\n  \"id\": \"T1558\",\n  \"tactics\": [\n    {\n      \"name\": \"Credential Access\",\n      \"url\": \"/tactics/TA0006\"\n    }\n  ],\n  \"platforms\": [\"Linux\", \"Windows\", \"macOS\"],\n  \"system_requirements\": \"Kerberos authentication enabled\",\n  \"contributors\": [\"Cody Thomas, SpecterOps\", \"Tim (Wadhwa-)Brown\"],\n  \"version\": \"1.5\",\n  \"created\": \"11 February 2020\",\n  \"last_modified\": \"01 March 2024\",\n  \"version_permalink\": \"/versions/v15/techniques/T1558/\",\n  \"live_version\": \"/versions/v15/techniques/T1558/\",\n  \"description\": \"Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable Pass the Ticket. Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as \\\"realms\\\", there are three basic participants: client, service, and Key Distribution Center (KDC). Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting.  Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access.\",\n  \"sources\": [\n    {\n      \"id\": 1,\n      \"citation\": \"Sean Metcalf. (2014, September 12). Kerberos, Active Directory\u2019s Secret Decoder Ring. Retrieved February 27, 2020.\",\n      \"url\": \"https://adsecurity.org/?p=227\"\n    },\n    {\n      \"id\": 2,\n      \"citation\": \"Microsoft. (2021, March 3). klist. Retrieved October 14, 2021.\",\n      \"url\": \"https://docs.microsoft.com/windows-server/administration/windows-commands/klist\"\n    },\n    {\n      \"id\": 3,\n      \"citation\": \"Massachusetts Institute of Technology. (n.d.). MIT Kerberos Documentation: Credential Cache. Retrieved October 4, 2021.\",\n      \"url\": \"https://web.mit.edu/kerberos/krb5-1.12/doc/basic/ccache_def.html\"\n    },\n    {\n      \"id\": 4,\n      \"citation\": \"Trevor Haskell. (2020, April 1). Kerberos Tickets on Linux Red Teams. Retrieved October 4, 2021.\",\n      \"url\": \"https://www.fireeye.com/blog/threat-research/2020/04/kerberos-tickets-on-linux-red-teams.html\"\n    },\n    {\n      \"id\": 5,\n      \"citation\": \"Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.\",\n      \"url\": \"https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf\"\n    },\n    {\n      \"id\": 6,\n      \"citation\": \"Benjamin Delpy. (n.d.). Kekeo. Retrieved October 4, 2021.\",\n      \"url\": \"https://github.com/gentilkiwi/kekeo\"\n    },\n    {\n      \"id\": 7,\n      \"citation\": \"Cody Thomas. (2019, November 14). When Kirbi walks the Bifrost. Retrieved October 6, 2021.\",\n      \"url\": \"https://posts.specterops.io/when-kirbi-walks-the-bifrost-4c727807744f\"\n    },\n    {\n      \"id\": 8,\n      \"citation\": \"Massachusetts Institute of Technology. (2007, October 27). Kerberos for Macintosh Preferences Documentation. Retrieved October 6, 2021.\",\n      \"url\": \"http://web.mit.edu/macdev/KfM/Common/Documentation/preferences.html\"\n    },\n    {\n      \"id\": 9,\n      \"citation\": \"UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.\",\n      \"url\": \"https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779\"\n    },\n    {\n      \"id\": 10,\n      \"citation\": \"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\",\n      \"url\": \"https://adsecurity.org/?p=2293\"\n    },\n    {\n      \"id\": 11,\n      \"citation\": \"Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket & Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.\",\n      \"url\": \"https://adsecurity.org/?p=1515\"\n    },\n    {\n      \"id\": 12,\n      \"citation\": \"Jeff Warren. (2019, February 19). How to Detect Pass-the-Ticket Attacks. Retrieved February 27, 2020.\",\n      \"url\": \"https://blog.stealthbits.com/detect-pass-the-ticket-attacks\"\n    },\n    {\n      \"id\": 13,\n      \"citation\": \"Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.\",\n      \"url\": \"https://cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf\"\n    },\n    {\n      \"id\": 14,\n      \"citation\": \"Microsoft. (2015, March 24). Kerberos Golden Ticket Check (Updated). Retrieved February 27, 2020.\",\n      \"url\": \"https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285\"\n    },\n    {\n      \"id\": 15,\n      \"citation\": \"French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.\",\n      \"url\": \"https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea\"\n    },\n    {\n      \"id\": 16,\n      \"citation\": \"Bani, M. (2018, February 23). Detecting Kerberoasting activity using Azure Security Center. Retrieved March 23, 2018.\",\n      \"url\": \"https://blogs.technet.microsoft.com/motiba/2018/02/23/detecting-kerberoasting-activity-using-azure-security-center/\"\n    }\n  ],\n  \"related_techniques\": [\n    {\n      \"technique\": \"Pass the Ticket\",\n      \"url\": \"/techniques/T1550/003\"\n    }\n  ],\n  \"detection\": [\n    {\n      \"id\": \"DS0026\",\n      \"name\": \"Active Directory\",\n      \"data_components\": [\n        {\n          \"component\": \"Active Directory Credential Request\",\n          \"url\": \"/datasources/DS0026/#Active%20Directory%20Credential%20Request\",\n          \"description\": \"Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4672, 4634), RC4 encryption within ticket granting tickets (TGTs), and ticket granting service (TGS) requests without preceding TGT requests. Monitor the lifetime of TGT tickets for values that differ from the default domain duration. Monitor for indications of Pass the Ticket being used to move laterally.\"\n        }\n      ]\n    },\n    {\n      \"id\": \"DS0017\",\n      \"name\": \"Command\",\n      \"data_components\": [\n        {\n          \"component\": \"Command Execution\",\n          \"url\": \"/datasources/DS0017/#Command%20Execution\",\n          \"description\": \"Monitor executed commands and arguments that may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable Pass the Ticket.\"\n        }\n      ]\n    },\n    {\n      \"id\": \"DS0022\",\n      \"name\": \"File\",\n      \"data_components\": [\n        {\n          \"component\": \"File Access\",\n          \"url\": \"/datasources/DS0022/#File%20Access\",\n          \"description\": \"Monitor for unexpected processes interacting with lsass.exe. Common credential dumpers such as  Mimikatz access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details, including Kerberos tickets, are stored. Monitor for unusual processes accessing secrets.ldb and .secrets.mkey located in /var/lib/sss/secrets/\"\n        }\n      ]\n    },\n    {\n      \"id\": \"DS0028\",\n      \"name\": \"Logon Session\",\n      \"data_components\": [\n        {\n          \"component\": \"Logon Session Metadata\",\n          \"url\": \"/datasources/DS0028/#Logon%20Session%20Metadata\",\n          \"description\": \"Enable Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).\"\n        }\n      ]\n    }\n  ],\n  \"mitigations\": [\n    {\n      \"id\": \"M1015\",\n      \"name\": \"Active Directory Configuration\",\n      \"url\": \"/mitigations/M1015\",\n      \"description\": \"For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.\"\n    },\n    {\n      \"id\": \"M1047\",\n      \"name\": \"Audit\",\n      \"url\": \"/mitigations/M1047\",\n      \"description\": \"Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.\"\n    },\n    {\n      \"id\": \"M1041\",\n      \"name\": \"Encrypt Sensitive Information\",\n      \"url\": \"/mitigations/M1041\",\n      \"description\": \"Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.\"\n    },\n    {\n      \"id\": \"M1027\",\n      \"name\": \"Password Policies\",\n      \"url\": \"/mitigations/M1027\",\n      \"description\": \"Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire. Also consider using Group Managed Service Accounts or another third party product such as password vaulting.\"\n    },\n    {\n      \"id\": \"M1026\",\n      \"name\": \"Privileged Account Management\",\n      \"url\": \"/mitigations/M1026\",\n      \"description\": \"Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts. Limit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.\"\n    }\n  ]\n}",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "stop",
    "ai_response_time": "2024-06-14T07:26:30.312065",
    "ai_runtime": 49.941732,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 12588,
    "tokens_output": 2775,
    "tokens_total": 15363
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1558.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1558.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Steal or Forge Kerberos Tickets, Technique T1558 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n        <li class=\"breadcrumb-item\">Steal or Forge Kerberos Tickets</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                        Steal or Forge Kerberos Tickets\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Sub-techniques (4)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.001\"> T1558.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.001\"> Golden Ticket </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.002\"> T1558.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.002\"> Silver Ticket </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.003\"> T1558.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.003\"> Kerberoasting </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.004\"> T1558.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.004\"> AS-REP Roasting </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable <a href=\"/techniques/T1550/003\">Pass the Ticket</a>. Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as \"realms\", there are three basic participants: client, service, and Key Distribution Center (KDC).<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Sean Metcalf. (2014, September 12). Kerberos, Active Directory\u2019s Secret Decoder Ring. Retrieved February 27, 2020.\" data-reference=\"ADSecurity Kerberos Ring Decoder\"><sup><a href=\"https://adsecurity.org/?p=227\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting.  Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access.</p><p>On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerberos tickets.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2021, March 3). klist. Retrieved October 14, 2021.\" data-reference=\"Microsoft Klist\"><sup><a href=\"https://docs.microsoft.com/windows-server/administration/windows-commands/klist\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p><p>Linux systems on Active Directory domains store Kerberos credentials locally in the credential cache file referred to as the \"ccache\". The credentials are stored in the ccache file while they remain valid and generally while a user's session lasts.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Massachusetts Institute of Technology. (n.d.). MIT Kerberos Documentation: Credential Cache. Retrieved October 4, 2021.\" data-reference=\"MIT ccache\"><sup><a href=\"https://web.mit.edu/kerberos/krb5-1.12/doc/basic/ccache_def.html\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> On modern Redhat Enterprise Linux systems, and derivative distributions, the System Security Services Daemon (SSSD) handles Kerberos tickets. By default SSSD maintains a copy of the ticket database that can be found in <code>/var/lib/sss/secrets/secrets.ldb</code> as well as the corresponding key located in <code>/var/lib/sss/secrets/.secrets.mkey</code>. Both files require root access to read. If an adversary is able to access the database and key, the credential cache Kerberos blob can be extracted and converted into a usable Kerberos ccache file that adversaries may use for <a href=\"/techniques/T1550/003\">Pass the Ticket</a>. The ccache file may also be converted into a Windows format using tools such as Kekeo.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Trevor Haskell. (2020, April 1). Kerberos Tickets on Linux Red Teams. Retrieved October 4, 2021.\" data-reference=\"Linux Kerberos Tickets\"><sup><a href=\"https://www.fireeye.com/blog/threat-research/2020/04/kerberos-tickets-on-linux-red-teams.html\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span><span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.\" data-reference=\"Brining MimiKatz to Unix\"><sup><a href=\"https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span><span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Benjamin Delpy. (n.d.). Kekeo. Retrieved October 4, 2021.\" data-reference=\"Kekeo\"><sup><a href=\"https://github.com/gentilkiwi/kekeo\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p><p>Kerberos tickets on macOS are stored in a standard ccache format, similar to Linux. By default, access to these ccache entries is federated through the KCM daemon process via the Mach RPC protocol, which uses the caller's environment to determine access. The storage location for these ccache entries is influenced by the <code>/etc/krb5.conf</code> configuration file and the <code>KRB5CCNAME</code> environment variable which can specify to save them to disk or keep them protected via the KCM daemon. Users can interact with ticket storage using <code>kinit</code>, <code>klist</code>, <code>ktutil</code>, and <code>kcc</code> built-in binaries or via Apple's native Kerberos framework. Adversaries can use open source tools to interact with the ccache files directly or to use the Kerberos framework to call lower-level APIs for extracting the user's TGT or Service Tickets.<span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Cody Thomas. (2019, November 14). When Kirbi walks the Bifrost. Retrieved October 6, 2021.\" data-reference=\"SpectorOps Bifrost Kerberos macOS 2019\"><sup><a href=\"https://posts.specterops.io/when-kirbi-walks-the-bifrost-4c727807744f\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span><span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Massachusetts Institute of Technology. (2007, October 27). Kerberos for Macintosh Preferences Documentation. Retrieved October 6, 2021.\" data-reference=\"macOS kerberos framework MIT\"><sup><a href=\"http://web.mit.edu/macdev/KfM/Common/Documentation/preferences.html\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1558\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-techniques:&nbsp;</span>\n                                                            <a href=\"/techniques/T1558/001\">T1558.001</a>,                                                            <a href=\"/techniques/T1558/002\">T1558.002</a>,                                                            <a href=\"/techniques/T1558/003\">T1558.003</a>,                                                            <a href=\"/techniques/T1558/004\">T1558.004</a>                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactic:</span>\n                                                        <a href=\"/tactics/TA0006\">Credential Access</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Linux, Windows, macOS\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"Additional information on requirements the adversary needs to meet or about the state of the system (software, patch level, etc.) that may be required for the (sub-)technique to work\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">System Requirements:&nbsp;</span>Kerberos authentication enabled\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Cody Thomas, SpecterOps; Tim (Wadhwa-)Brown\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.5\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>11 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>01 March 2024\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1558/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1558\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1558/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1558\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1015\"> M1015 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1015\"> Active Directory Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.<span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.\" data-reference=\"STIG krbtgt reset\"><sup><a href=\"https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1047\"> M1047 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1047\"> Audit </a>\n                                                </td>\n                                                <td>\n                                                                <p>Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1041\"> M1041 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1041\"> Encrypt Sensitive Information </a>\n                                                </td>\n                                                <td>\n                                                                <p>Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https://adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1027\"> M1027 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1027\"> Password Policies </a>\n                                                </td>\n                                                <td>\n                                                                <p>Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https://adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span> Also consider using Group Managed Service Accounts or another third party product such as password vaulting.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https://adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts.</p><p>Limit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https://adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0026\">\n                <td>\n                    <a href=\"/datasources/DS0026\">DS0026</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0026\">Active Directory</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0026/#Active%20Directory%20Credential%20Request\">Active Directory Credential Request</a>\n                </td>\n                    <td>\n                                <p>Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4672, 4634), RC4 encryption within ticket granting tickets (TGTs), and ticket granting service (TGS) requests without preceding TGT requests.<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket &amp; Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.\" data-reference=\"ADSecurity Detecting Forged Tickets\"><sup><a href=\"https://adsecurity.org/?p=1515\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span><span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Jeff Warren. (2019, February 19). How to Detect Pass-the-Ticket Attacks. Retrieved February 27, 2020.\" data-reference=\"Stealthbits Detect PtT 2019\"><sup><a href=\"https://blog.stealthbits.com/detect-pass-the-ticket-attacks\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span><span onclick=\"scrollToRef('scite-13')\" id=\"scite-ref-13-a\" class=\"scite-citeref-number\" title=\"Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.\" data-reference=\"CERT-EU Golden Ticket Protection\"><sup><a href=\"https://cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span>Monitor the lifetime of TGT tickets for values that differ from the default domain duration.<span onclick=\"scrollToRef('scite-14')\" id=\"scite-ref-14-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2015, March 24). Kerberos Golden Ticket Check (Updated). Retrieved February 27, 2020.\" data-reference=\"Microsoft Kerberos Golden Ticket\"><sup><a href=\"https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span> Monitor for indications of <a href=\"/techniques/T1550/003\">Pass the Ticket</a> being used to move laterally.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor executed commands and arguments that may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable <a href=\"/techniques/T1550/003\">Pass the Ticket</a>.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0022\">\n                <td>\n                    <a href=\"/datasources/DS0022\">DS0022</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0022\">File</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0022/#File%20Access\">File Access</a>\n                </td>\n                    <td>\n                                <p>Monitor for unexpected processes interacting with lsass.exe.<span onclick=\"scrollToRef('scite-15')\" id=\"scite-ref-15-a\" class=\"scite-citeref-number\" title=\"French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.\" data-reference=\"Medium Detecting Attempts to Steal Passwords from Memory\"><sup><a href=\"https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span> Common credential dumpers such as  <a href=\"/software/S0002\">Mimikatz</a> access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details, including Kerberos tickets, are stored. Monitor for unusual processes accessing&nbsp;<code>secrets.ldb</code> and <code>.secrets.mkey</code> located in <code>/var/lib/sss/secrets/</code>.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0028\">\n                <td>\n                    <a href=\"/datasources/DS0028\">DS0028</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0028\">Logon Session</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0028/#Logon%20Session%20Metadata\">Logon Session Metadata</a>\n                </td>\n                    <td>\n                                <p>Enable Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).<span onclick=\"scrollToRef('scite-16')\" id=\"scite-ref-16-a\" class=\"scite-citeref-number\" title=\"Bani, M. (2018, February 23). Detecting Kerberoasting activity using Azure Security Center. Retrieved March 23, 2018.\" data-reference=\"Microsoft Detecting Kerberoasting Feb 2018\"><sup><a href=\"https://blogs.technet.microsoft.com/motiba/2018/02/23/detecting-kerberoasting-activity-using-azure-security-center/\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span> <span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https://adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://adsecurity.org/?p=227\" target=\"_blank\">\n                        Sean Metcalf. (2014, September 12). Kerberos, Active Directory\u2019s Secret Decoder Ring. Retrieved February 27, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://docs.microsoft.com/windows-server/administration/windows-commands/klist\" target=\"_blank\">\n                        Microsoft. (2021, March 3). klist. Retrieved October 14, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https://web.mit.edu/kerberos/krb5-1.12/doc/basic/ccache_def.html\" target=\"_blank\">\n                        Massachusetts Institute of Technology. (n.d.). MIT Kerberos Documentation: Credential Cache. Retrieved October 4, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://www.fireeye.com/blog/threat-research/2020/04/kerberos-tickets-on-linux-red-teams.html\" target=\"_blank\">\n                        Trevor Haskell. (2020, April 1). Kerberos Tickets on Linux Red Teams. Retrieved October 4, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf\" target=\"_blank\">\n                        Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https://github.com/gentilkiwi/kekeo\" target=\"_blank\">\n                        Benjamin Delpy. (n.d.). Kekeo. Retrieved October 4, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https://posts.specterops.io/when-kirbi-walks-the-bifrost-4c727807744f\" target=\"_blank\">\n                        Cody Thomas. (2019, November 14). When Kirbi walks the Bifrost. Retrieved October 6, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"http://web.mit.edu/macdev/KfM/Common/Documentation/preferences.html\" target=\"_blank\">\n                        Massachusetts Institute of Technology. (2007, October 27). Kerberos for Macintosh Preferences Documentation. Retrieved October 6, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"9.0\">\n                                \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779\" target=\"_blank\">\n                        UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https://adsecurity.org/?p=2293\" target=\"_blank\">\n                        Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https://adsecurity.org/?p=1515\" target=\"_blank\">\n                        Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket &amp; Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https://blog.stealthbits.com/detect-pass-the-ticket-attacks\" target=\"_blank\">\n                        Jeff Warren. (2019, February 19). How to Detect Pass-the-Ticket Attacks. Retrieved February 27, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-13\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-13\" href=\"https://cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf\" target=\"_blank\">\n                        Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-14\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-14\" href=\"https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285\" target=\"_blank\">\n                        Microsoft. (2015, March 24). Kerberos Golden Ticket Check (Updated). Retrieved February 27, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-15\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-15\" href=\"https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea\" target=\"_blank\">\n                        French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-16\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-16\" href=\"https://blogs.technet.microsoft.com/motiba/2018/02/23/detecting-kerberoasting-activity-using-azure-security-center/\" target=\"_blank\">\n                        Bani, M. (2018, February 23). Detecting Kerberoasting activity using Azure Security Center. Retrieved March 23, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?4037\"></script>\n    <script src=\"/theme/scripts/settings.js?7167\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-techniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Steal or Forge Kerberos Tickets, Technique T1558 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n        <li class=\"breadcrumb-item\">Steal or Forge Kerberos Tickets</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                        Steal or Forge Kerberos Tickets\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Sub-techniques (4)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.001\"> T1558.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.001\"> Golden Ticket </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.002\"> T1558.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.002\"> Silver Ticket </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.003\"> T1558.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.003\"> Kerberoasting </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.004\"> T1558.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1558/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1558.004\"> AS-REP Roasting </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable <a href=\"/techniques/T1550/003\">Pass the Ticket</a>. Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as \"realms\", there are three basic participants: client, service, and Key Distribution Center (KDC).<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Sean Metcalf. (2014, September 12). Kerberos, Active Directory\u2019s Secret Decoder Ring. Retrieved February 27, 2020.\" data-reference=\"ADSecurity Kerberos Ring Decoder\"><sup><a href=\"https:/adsecurity.org/?p=227\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting.  Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access.</p><p>On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerberos tickets.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2021, March 3). klist. Retrieved October 14, 2021.\" data-reference=\"Microsoft Klist\"><sup><a href=\"https:/docs.microsoft.com/windows-server/administration/windows-commands/klist\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p><p>Linux systems on Active Directory domains store Kerberos credentials locally in the credential cache file referred to as the \"ccache\". The credentials are stored in the ccache file while they remain valid and generally while a user's session lasts.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Massachusetts Institute of Technology. (n.d.). MIT Kerberos Documentation: Credential Cache. Retrieved October 4, 2021.\" data-reference=\"MIT ccache\"><sup><a href=\"https:/web.mit.edu/kerberos/krb5-1.12/doc/basic/ccache_def.html\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> On modern Redhat Enterprise Linux systems, and derivative distributions, the System Security Services Daemon (SSSD) handles Kerberos tickets. By default SSSD maintains a copy of the ticket database that can be found in <code>/var/lib/sss/secrets/secrets.ldb</code> as well as the corresponding key located in <code>/var/lib/sss/secrets/.secrets.mkey</code>. Both files require root access to read. If an adversary is able to access the database and key, the credential cache Kerberos blob can be extracted and converted into a usable Kerberos ccache file that adversaries may use for <a href=\"/techniques/T1550/003\">Pass the Ticket</a>. The ccache file may also be converted into a Windows format using tools such as Kekeo.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Trevor Haskell. (2020, April 1). Kerberos Tickets on Linux Red Teams. Retrieved October 4, 2021.\" data-reference=\"Linux Kerberos Tickets\"><sup><a href=\"https:/www.fireeye.com/blog/threat-research/2020/04/kerberos-tickets-on-linux-red-teams.html\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span><span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.\" data-reference=\"Brining MimiKatz to Unix\"><sup><a href=\"https:/labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span><span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Benjamin Delpy. (n.d.). Kekeo. Retrieved October 4, 2021.\" data-reference=\"Kekeo\"><sup><a href=\"https:/github.com/gentilkiwi/kekeo\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p><p>Kerberos tickets on macOS are stored in a standard ccache format, similar to Linux. By default, access to these ccache entries is federated through the KCM daemon process via the Mach RPC protocol, which uses the caller's environment to determine access. The storage location for these ccache entries is influenced by the <code>/etc/krb5.conf</code> configuration file and the <code>KRB5CCNAME</code> environment variable which can specify to save them to disk or keep them protected via the KCM daemon. Users can interact with ticket storage using <code>kinit</code>, <code>klist</code>, <code>ktutil</code>, and <code>kcc</code> built-in binaries or via Apple's native Kerberos framework. Adversaries can use open source tools to interact with the ccache files directly or to use the Kerberos framework to call lower-level APIs for extracting the user's TGT or Service Tickets.<span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Cody Thomas. (2019, November 14). When Kirbi walks the Bifrost. Retrieved October 6, 2021.\" data-reference=\"SpectorOps Bifrost Kerberos macOS 2019\"><sup><a href=\"https:/posts.specterops.io/when-kirbi-walks-the-bifrost-4c727807744f\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span><span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Massachusetts Institute of Technology. (2007, October 27). Kerberos for Macintosh Preferences Documentation. Retrieved October 6, 2021.\" data-reference=\"macOS kerberos framework MIT\"><sup><a href=\"http:/web.mit.edu/macdev/KfM/Common/Documentation/preferences.html\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1558\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-techniques:&nbsp;</span>\n                                                            <a href=\"/techniques/T1558/001\">T1558.001</a>,                                                            <a href=\"/techniques/T1558/002\">T1558.002</a>,                                                            <a href=\"/techniques/T1558/003\">T1558.003</a>,                                                            <a href=\"/techniques/T1558/004\">T1558.004</a>                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactic:</span>\n                                                        <a href=\"/tactics/TA0006\">Credential Access</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Linux, Windows, macOS\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"Additional information on requirements the adversary needs to meet or about the state of the system (software, patch level, etc.) that may be required for the (sub-)technique to work\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">System Requirements:&nbsp;</span>Kerberos authentication enabled\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Cody Thomas, SpecterOps; Tim (Wadhwa-)Brown\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.5\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>11 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>01 March 2024\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1558/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1558\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1558/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1558\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1015\"> M1015 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1015\"> Active Directory Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.<span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.\" data-reference=\"STIG krbtgt reset\"><sup><a href=\"https:/www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1047\"> M1047 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1047\"> Audit </a>\n                                                </td>\n                                                <td>\n                                                                <p>Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1041\"> M1041 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1041\"> Encrypt Sensitive Information </a>\n                                                </td>\n                                                <td>\n                                                                <p>Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https:/adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1027\"> M1027 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1027\"> Password Policies </a>\n                                                </td>\n                                                <td>\n                                                                <p>Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https:/adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span> Also consider using Group Managed Service Accounts or another third party product such as password vaulting.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https:/adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts.</p><p>Limit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https:/adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0026\">\n                <td>\n                    <a href=\"/datasources/DS0026\">DS0026</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0026\">Active Directory</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0026/#Active%20Directory%20Credential%20Request\">Active Directory Credential Request</a>\n                </td>\n                    <td>\n                                <p>Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4672, 4634), RC4 encryption within ticket granting tickets (TGTs), and ticket granting service (TGS) requests without preceding TGT requests.<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket &amp; Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.\" data-reference=\"ADSecurity Detecting Forged Tickets\"><sup><a href=\"https:/adsecurity.org/?p=1515\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span><span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Jeff Warren. (2019, February 19). How to Detect Pass-the-Ticket Attacks. Retrieved February 27, 2020.\" data-reference=\"Stealthbits Detect PtT 2019\"><sup><a href=\"https:/blog.stealthbits.com/detect-pass-the-ticket-attacks\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span><span onclick=\"scrollToRef('scite-13')\" id=\"scite-ref-13-a\" class=\"scite-citeref-number\" title=\"Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.\" data-reference=\"CERT-EU Golden Ticket Protection\"><sup><a href=\"https:/cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span>Monitor the lifetime of TGT tickets for values that differ from the default domain duration.<span onclick=\"scrollToRef('scite-14')\" id=\"scite-ref-14-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2015, March 24). Kerberos Golden Ticket Check (Updated). Retrieved February 27, 2020.\" data-reference=\"Microsoft Kerberos Golden Ticket\"><sup><a href=\"https:/gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span> Monitor for indications of <a href=\"/techniques/T1550/003\">Pass the Ticket</a> being used to move laterally.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor executed commands and arguments that may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable <a href=\"/techniques/T1550/003\">Pass the Ticket</a>.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0022\">\n                <td>\n                    <a href=\"/datasources/DS0022\">DS0022</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0022\">File</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0022/#File%20Access\">File Access</a>\n                </td>\n                    <td>\n                                <p>Monitor for unexpected processes interacting with lsass.exe.<span onclick=\"scrollToRef('scite-15')\" id=\"scite-ref-15-a\" class=\"scite-citeref-number\" title=\"French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.\" data-reference=\"Medium Detecting Attempts to Steal Passwords from Memory\"><sup><a href=\"https:/medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span> Common credential dumpers such as  <a href=\"/software/S0002\">Mimikatz</a> access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details, including Kerberos tickets, are stored. Monitor for unusual processes accessing&nbsp;<code>secrets.ldb</code> and <code>.secrets.mkey</code> located in <code>/var/lib/sss/secrets/</code>.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0028\">\n                <td>\n                    <a href=\"/datasources/DS0028\">DS0028</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0028\">Logon Session</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0028/#Logon%20Session%20Metadata\">Logon Session Metadata</a>\n                </td>\n                    <td>\n                                <p>Enable Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).<span onclick=\"scrollToRef('scite-16')\" id=\"scite-ref-16-a\" class=\"scite-citeref-number\" title=\"Bani, M. (2018, February 23). Detecting Kerberoasting activity using Azure Security Center. Retrieved March 23, 2018.\" data-reference=\"Microsoft Detecting Kerberoasting Feb 2018\"><sup><a href=\"https:/blogs.technet.microsoft.com/motiba/2018/02/23/detecting-kerberoasting-activity-using-azure-security-center/\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span> <span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\" data-reference=\"AdSecurity Cracking Kerberos Dec 2015\"><sup><a href=\"https:/adsecurity.org/?p=2293\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/adsecurity.org/?p=227\" target=\"_blank\">\n                        Sean Metcalf. (2014, September 12). Kerberos, Active Directory\u2019s Secret Decoder Ring. Retrieved February 27, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/docs.microsoft.com/windows-server/administration/windows-commands/klist\" target=\"_blank\">\n                        Microsoft. (2021, March 3). klist. Retrieved October 14, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https:/web.mit.edu/kerberos/krb5-1.12/doc/basic/ccache_def.html\" target=\"_blank\">\n                        Massachusetts Institute of Technology. (n.d.). MIT Kerberos Documentation: Credential Cache. Retrieved October 4, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/www.fireeye.com/blog/threat-research/2020/04/kerberos-tickets-on-linux-red-teams.html\" target=\"_blank\">\n                        Trevor Haskell. (2020, April 1). Kerberos Tickets on Linux Red Teams. Retrieved October 4, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf\" target=\"_blank\">\n                        Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https:/github.com/gentilkiwi/kekeo\" target=\"_blank\">\n                        Benjamin Delpy. (n.d.). Kekeo. Retrieved October 4, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https:/posts.specterops.io/when-kirbi-walks-the-bifrost-4c727807744f\" target=\"_blank\">\n                        Cody Thomas. (2019, November 14). When Kirbi walks the Bifrost. Retrieved October 6, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"http:/web.mit.edu/macdev/KfM/Common/Documentation/preferences.html\" target=\"_blank\">\n                        Massachusetts Institute of Technology. (2007, October 27). Kerberos for Macintosh Preferences Documentation. Retrieved October 6, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"9.0\">\n                                \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https:/www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779\" target=\"_blank\">\n                        UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https:/adsecurity.org/?p=2293\" target=\"_blank\">\n                        Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast \u2013 Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https:/adsecurity.org/?p=1515\" target=\"_blank\">\n                        Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket &amp; Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https:/blog.stealthbits.com/detect-pass-the-ticket-attacks\" target=\"_blank\">\n                        Jeff Warren. (2019, February 19). How to Detect Pass-the-Ticket Attacks. Retrieved February 27, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-13\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-13\" href=\"https:/cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf\" target=\"_blank\">\n                        Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-14\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-14\" href=\"https:/gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285\" target=\"_blank\">\n                        Microsoft. (2015, March 24). Kerberos Golden Ticket Check (Updated). Retrieved February 27, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-15\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-15\" href=\"https:/medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea\" target=\"_blank\">\n                        French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-16\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-16\" href=\"https:/blogs.technet.microsoft.com/motiba/2018/02/23/detecting-kerberoasting-activity-using-azure-security-center/\" target=\"_blank\">\n                        Bani, M. (2018, February 23). Detecting Kerberoasting activity using Azure Security Center. Retrieved March 23, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?4037\"></script>\n    <script src=\"/theme/scripts/settings.js?7167\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-techniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "6e5d0ffa-cc83-402c-a99c-19e52d975cfb"
}