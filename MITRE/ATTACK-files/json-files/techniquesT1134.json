{
  "api_response": {
    "ai_query_time": "2024-06-14T03:59:12.890367",
    "ai_response_data": "{\n  \"title\": \"Access Token Manipulation, Technique T1134 - Enterprise | MITRE ATT&CK\u00ae\",\n  \"breadcrumb\": [\n    {\"label\": \"Home\", \"url\": \"/\"},\n    {\"label\": \"Techniques\", \"url\": \"/techniques/enterprise\"},\n    {\"label\": \"Enterprise\", \"url\": \"/techniques/enterprise\"},\n    {\"label\": \"Access Token Manipulation\", \"url\": null}\n  ],\n  \"header\": \"Access Token Manipulation\",\n  \"description\": \"Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token. An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. Token Impersonation/Theft) or used to spawn a new process (i.e. Create Process with Token). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.[1] Any standard user can use the runas command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.\",\n  \"sub_techniques\": {\n    \"header\": \"Sub-techniques (5)\",\n    \"methods\": [\n      {\n        \"id\": \"T1134.001\",\n        \"name\": \"Token Impersonation/Theft\",\n        \"url\": \"/techniques/T1134/001/\"\n      },\n      {\n        \"id\": \"T1134.002\",\n        \"name\": \"Create Process with Token\",\n        \"url\": \"/techniques/T1134/002/\"\n      },\n      {\n        \"id\": \"T1134.003\",\n        \"name\": \"Make and Impersonate Token\",\n        \"url\": \"/techniques/T1134/003/\"\n      },\n      {\n        \"id\": \"T1134.004\",\n        \"name\": \"Parent PID Spoofing\",\n        \"url\": \"/techniques/T1134/004/\"\n      },\n      {\n        \"id\": \"T1134.005\",\n        \"name\": \"SID-History Injection\",\n        \"url\": \"/techniques/T1134/005/\"\n      }\n    ]\n  },\n  \"details\": {\n    \"id\": \"T1134\",\n    \"sub_techniques\": [\n      {\"id\": \"T1134.001\", \"url\": \"/techniques/T1134/001\"},\n      {\"id\": \"T1134.002\", \"url\": \"/techniques/T1134/002\"},\n      {\"id\": \"T1134.003\", \"url\": \"/techniques/T1134/003\"},\n      {\"id\": \"T1134.004\", \"url\": \"/techniques/T1134/004\"},\n      {\"id\": \"T1134.005\", \"url\": \"/techniques/T1134/005\"}\n    ],\n    \"tactics\": [\n      {\"name\": \"Defense Evasion\", \"url\": \"/tactics/TA0005\"},\n      {\"name\": \"Privilege Escalation\", \"url\": \"/tactics/TA0004\"}\n    ],\n    \"platforms\": \"Windows\",\n    \"permissions_required\": [\"Administrator\", \"User\"],\n    \"effective_permissions\": \"SYSTEM\",\n    \"defense_bypassed\": [\n      \"Heuristic Detection\",\n      \"Host Forensic Analysis\",\n      \"System Access Controls\",\n      \"Windows User Account Control\"\n    ],\n    \"contributors\": [\n      \"Jared Atkinson, @jaredcatkinson\",\n      \"Robby Winchester, @robwinchester3\",\n      \"Tom Ueltschi @c_APT_ure\",\n      \"Travis Smith, Tripwire\"\n    ],\n    \"version\": \"2.0\",\n    \"created_date\": \"14 December 2017\",\n    \"last_modified_date\": \"30 March 2023\",\n    \"version_permalink\": \"/versions/v15/techniques/T1134/\",\n    \"live_version\": \"/versions/v15/techniques/T1134/\"\n  },\n  \"examples\": {\n    \"header\": \"Procedure Examples\",\n    \"items\": [\n      {\n        \"id\": \"S0622\",\n        \"name\": \"AppleSeed\",\n        \"description\": \"AppleSeed can gain system level privilege by passing SeDebugPrivilege to the AdjustTokenPrivilege API.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[2]\",\n            \"title\": \"Jazi, H. (2021, June 1). Kimsuky APT continues to target South Korean government using AppleSeed backdoor. Retrieved June 10, 2021.\",\n            \"url\": \"https://blog.malwarebytes.com/threat-analysis/2021/06/kimsuky-apt-continues-to-target-south-korean-government-using-appleseed-backdoor/\",\n            \"note\": \"Malwarebytes Kimsuky June 2021\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S1068\",\n        \"name\": \"BlackCat\",\n        \"description\": \"BlackCat has the ability modify access tokens.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[3]\",\n            \"title\": \"Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.\",\n            \"url\": \"https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/\",\n            \"note\": \"Microsoft BlackCat Jun 2022\"\n          },\n          {\n            \"text\": \"[4]\",\n            \"title\": \"Brandt, Andrew. (2022, July 14). BlackCat ransomware attacks not merely a byproduct of bad luck. Retrieved December 20, 2022.\",\n            \"url\": \"https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/\",\n            \"note\": \"Sophos BlackCat Jul 2022\"\n          }\n        ]\n      },\n      {\n        \"id\": \"G0108\",\n        \"name\": \"Blue Mockingbird\",\n        \"description\": \"Blue Mockingbird has used JuicyPotato to abuse the SeImpersonate token privilege to escalate from web application pool accounts to NT Authority\\\\SYSTEM.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[5]\",\n            \"title\": \"Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.\",\n            \"url\": \"https://redcanary.com/blog/blue-mockingbird-cryptominer/\",\n            \"note\": \"RedCanary Mockingbird May 2020\"\n          }\n        ]\n      },\n      {\n        \"id\": \"C0017\",\n        \"name\": \"C0017\",\n        \"description\": \"During C0017, APT41 used a ConfuserEx obfuscated BADPOTATO exploit to abuse named-pipe impersonation for local NT AUTHORITY\\\\SYSTEM privilege escalation.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[6]\",\n            \"title\": \"Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.\",\n            \"url\": \"https://www.mandiant.com/resources/apt41-us-state-governments\",\n            \"note\": \"Mandiant APT41\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0625\",\n        \"name\": \"Cuba\",\n        \"description\": \"Cuba has used SeDebugPrivilege and AdjustTokenPrivileges to elevate privileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[7]\",\n            \"title\": \"Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.\",\n            \"url\": \"https://www.mcafee.com/enterprise/en-us/assets/reports/rp-cuba-ransomware.pdf\",\n            \"note\": \"McAfee Cuba April 2021\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0038\",\n        \"name\": \"Duqu\",\n        \"description\": \"Duqu examines running system processes for tokens that have specific system privileges. If it finds one, it will copy the token and store it for later use. Eventually it will start new processes with the stored token attached. It can also steal tokens to acquire administrative privileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[8]\",\n            \"title\": \"Kaspersky Lab. (2015, June 11). The Duqu 2.0. Retrieved April 21, 2017.\",\n            \"url\": \"https://securelist.com/files/2015/06/The_Mystery_of_Duqu_2_0_a_sophisticated_cyberespionage_actor_returns.pdf\",\n            \"note\": \"Kaspersky Duqu 2.0\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0363\",\n        \"name\": \"Empire\",\n        \"description\": \"Empire can use PowerSploit's Invoke-TokenManipulation to manipulate access tokens.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[9]\",\n            \"title\": \"Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\",\n            \"url\": \"https://github.com/PowerShellEmpire/Empire\",\n            \"note\": \"Github PowerShell Empire\"\n          }\n        ]\n      },\n      {\n        \"id\": \"G0037\",\n        \"name\": \"FIN6\",\n        \"description\": \"FIN6 has used has used Metasploit\u2019s named-pipe impersonation technique to escalate privileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[10]\",\n            \"title\": \"McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.\",\n            \"url\": \"https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\",\n            \"note\": \"FireEye FIN6 Apr 2019\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0666\",\n        \"name\": \"Gelsemium\",\n        \"description\": \"Gelsemium can use token manipulation to bypass UAC on Windows7 systems.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[11]\",\n            \"title\": \"Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.\",\n            \"url\": \"https://www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf\",\n            \"note\": \"ESET Gelsemium June 2021\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0697\",\n        \"name\": \"HermeticWiper\",\n        \"description\": \"HermeticWiper can use AdjustTokenPrivileges to grant itself privileges for debugging with SeDebugPrivilege, creating backups with SeBackupPrivilege, loading drivers with SeLoadDriverPrivilege, and shutting down a local system with SeShutdownPrivilege.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[12]\",\n            \"title\": \"Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.\",\n            \"url\": \"https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware\",\n            \"note\": \"Qualys Hermetic Wiper March 2022\"\n          },\n          {\n            \"text\": \"[13]\",\n            \"title\": \"Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.\",\n            \"url\": \"https://www.crowdstrike.com/blog/how-crowdstrike-falcon-protects-against-wiper-malware-used-in-ukraine-attacks/\",\n            \"note\": \"Crowdstrike DriveSlayer February 2022\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0203\",\n        \"name\": \"Hydraq\",\n        \"description\": \"Hydraq creates a backdoor through which remote attackers can adjust token privileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[14]\",\n            \"title\": \"Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.\",\n            \"url\": \"https://www.symantec.com/security_response/writeup.jsp?docid=2010-011114-1830-99\",\n            \"note\": \"Symantec Hydraq Jan 2010\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0607\",\n        \"name\": \"KillDisk\",\n        \"description\": \"KillDisk has attempted to get the access token of a process by calling OpenProcessToken. If KillDisk gets the access token, then it attempt to modify the token privileges with AdjustTokenPrivileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[15]\",\n            \"title\": \"Gilbert Sison, Rheniel Ramos, Jay Yaneza, Alfredo Oliveira. (2018, January 15). KillDisk Variant Hits Latin American Financial Groups. Retrieved January 12, 2021.\",\n            \"url\": \"https://www.trendmicro.com/en_us/research/18/a/new-killdisk-variant-hits-financial-organizations-in-latin-america.html\",\n            \"note\": \"Trend Micro KillDisk 2\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S1060\",\n        \"name\": \"Mafalda\",\n        \"description\": \"Mafalda can use AdjustTokenPrivileges() to elevate privileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[16]\",\n            \"title\": \"SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.\",\n            \"url\": \"https://docs.google.com/document/d/1e9ZTW9b71YwFWS_18ZwDAxa-cYbV8q1wUefmKZLYVsA/edit#heading=h.lmnbtht1ikzm\",\n            \"note\": \"SentinelLabs Metador Technical Appendix Sept 2022\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0576\",\n        \"name\": \"MegaCortex\",\n        \"description\": \"MegaCortex can enable SeDebugPrivilege and adjust token privileges.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[17]\",\n            \"title\": \"Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.\",\n            \"url\": \"https://securityintelligence.com/posts/from-mega-to-giga-cross-version-comparison-of-top-megacortex-modifications/\",\n            \"note\": \"IBM MegaCortex\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0378\",\n        \"name\": \"PoshC2\",\n        \"description\": \"PoshC2 can use Invoke-TokenManipulation for manipulating tokens.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[18]\",\n            \"title\": \"Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\",\n            \"url\": \"https://github.com/nettitude/PoshC2_Python\",\n            \"note\": \"GitHub PoshC2\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0194\",\n        \"name\": \"PowerSploit\",\n        \"description\": \"PowerSploit's Invoke-TokenManipulation Exfiltration module can be used to manipulate tokens.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[19]\",\n            \"title\": \"PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.\",\n            \"url\": \"https://github.com/PowerShellMafia/PowerSploit\",\n            \"note\": \"GitHub PowerSploit May 2012\"\n          },\n          {\n            \"text\": \"[20]\",\n            \"title\": \"PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.\",\n            \"url\": \"http://powersploit.readthedocs.io\",\n            \"note\": \"PowerSploit Documentation\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0446\",\n        \"name\": \"Ryuk\",\n        \"description\": \"Ryuk has attempted to adjust its token privileges to have the SeDebugPrivilege.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[21]\",\n            \"title\": \"Hanel, A. (2019, January 10). Big Game Hunting with Ryuk: Another Lucrative Targeted Ransomware. Retrieved May 12, 2020.\",\n            \"url\": \"https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/\",\n            \"note\": \"CrowdStrike Ryuk January 2019\"\n          }\n        ]\n      },\n      {\n        \"id\": \"S0633\",\n        \"name\": \"Sliver\",\n        \"description\": \"Sliver has the ability to manipulate user tokens on targeted Windows systems.\",\n        \"citation_links\": [\n          {\n            \"text\": \"[22]\",\n            \"title\": \"Kervella, R. (2019, August 4). Cross-platform General Purpose Implant Framework Written in Golang. Retrieved July 30, 2021.\",\n            \"url\": \"https://labs.bishopfox.com/tech-blog/sliver\",\n            \"note\": \"Bishop Fox Sliver Framework August 2019\"\n          },\n          {\n            \"text\": \"[23]\",\n            \"title\": \"BishopFox. (n.d.). Sliver. Retrieved September 15, 2021.\",\n",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "length",
    "ai_response_time": "2024-06-14T04:00:28.408211",
    "ai_runtime": 75.517844,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 18998,
    "tokens_output": 4096,
    "tokens_total": 23094
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1134.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1134.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Access Token Manipulation, Technique T1134 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n        <li class=\"breadcrumb-item\">Access Token Manipulation</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                        Access Token Manipulation\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Sub-techniques (5)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> T1134.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> Token Impersonation/Theft </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> T1134.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> Create Process with Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> T1134.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> Make and Impersonate Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> T1134.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> Parent PID Spoofing </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> T1134.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> SID-History Injection </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token.</p><p>An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. <a href=\"/techniques/T1134/001\">Token Impersonation/Theft</a>) or used to spawn a new process (i.e. <a href=\"/techniques/T1134/002\">Create Process with Token</a>). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"netbiosX. (2017, April 3). Token Manipulation. Retrieved April 21, 2017.\" data-reference=\"Pentestlab Token Manipulation\"><sup><a href=\"https://pentestlab.blog/2017/04/03/token-manipulation/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1134\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-techniques:&nbsp;</span>\n                                                            <a href=\"/techniques/T1134/001\">T1134.001</a>,                                                            <a href=\"/techniques/T1134/002\">T1134.002</a>,                                                            <a href=\"/techniques/T1134/003\">T1134.003</a>,                                                            <a href=\"/techniques/T1134/004\">T1134.004</a>,                                                            <a href=\"/techniques/T1134/005\">T1134.005</a>                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The lowest level of permissions the adversary is required to be operating within to perform the (sub-)technique on a system\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Permissions Required:&nbsp;</span>Administrator, User\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The level of permissions the adversary will attain by performing the (sub-)technique\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Effective Permissions:&nbsp;</span>SYSTEM\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Heuristic Detection, Host Forensic Analysis, System Access Controls, Windows User Account Control\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Jared Atkinson, @jaredcatkinson; Robby Winchester, @robwinchester3; Tom Ueltschi @c_APT_ure; Travis Smith, Tripwire\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>2.0\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>14 December 2017\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>30 March 2023\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1134\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1134\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0622\"> S0622 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0622\"> AppleSeed </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0622\">AppleSeed</a> can gain system level privilege by passing <code>SeDebugPrivilege</code> to the <code>AdjustTokenPrivilege</code> API.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Jazi, H. (2021, June 1). Kimsuky APT continues to target South Korean government using AppleSeed backdoor. Retrieved June 10, 2021.\" data-reference=\"Malwarebytes Kimsuky June 2021\"><sup><a href=\"https://blog.malwarebytes.com/threat-analysis/2021/06/kimsuky-apt-continues-to-target-south-korean-government-using-appleseed-backdoor/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S1068\"> S1068 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S1068\"> BlackCat </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S1068\">BlackCat</a> has the ability modify access tokens.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.\" data-reference=\"Microsoft BlackCat Jun 2022\"><sup><a href=\"https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span><span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Brandt, Andrew. (2022, July 14). BlackCat ransomware attacks not merely a byproduct of bad luck. Retrieved December 20, 2022.\" data-reference=\"Sophos BlackCat Jul 2022\"><sup><a href=\"https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0108\"> G0108 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0108\"> Blue Mockingbird </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0108\">Blue Mockingbird</a> has used JuicyPotato to abuse the <code>SeImpersonate</code> token privilege to escalate from web application pool accounts to NT Authority\\SYSTEM.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.\" data-reference=\"RedCanary Mockingbird May 2020\"><sup><a href=\"https://redcanary.com/blog/blue-mockingbird-cryptominer/\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/campaigns/C0017\"> C0017 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/campaigns/C0017\"> C0017 </a>\n                                            </td>\n                                            <td>\n                                                            <p>During <a href=\"https://attack.mitre.org/campaigns/C0017\">C0017</a>, <a href=\"/groups/G0096\">APT41</a> used a ConfuserEx obfuscated BADPOTATO exploit to abuse named-pipe impersonation for local <code>NT AUTHORITY\\SYSTEM</code> privilege escalation.<span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.\" data-reference=\"Mandiant APT41\"><sup><a href=\"https://www.mandiant.com/resources/apt41-us-state-governments\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0625\"> S0625 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0625\"> Cuba </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0625\">Cuba</a> has used <code>SeDebugPrivilege</code> and <code>AdjustTokenPrivileges</code> to elevate privileges.<span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.\" data-reference=\"McAfee Cuba April 2021\"><sup><a href=\"https://www.mcafee.com/enterprise/en-us/assets/reports/rp-cuba-ransomware.pdf\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0038\"> S0038 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0038\"> Duqu </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0038\">Duqu</a> examines running system processes for tokens that have specific system privileges. If it finds one, it will copy the token and store it for later use. Eventually it will start new processes with the stored token attached. It can also steal tokens to acquire administrative privileges.<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Kaspersky Lab. (2015, June 11). The Duqu 2.0. Retrieved April 21, 2017.\" data-reference=\"Kaspersky Duqu 2.0\"><sup><a href=\"https://securelist.com/files/2015/06/The_Mystery_of_Duqu_2_0_a_sophisticated_cyberespionage_actor_returns.pdf\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0363\"> S0363 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0363\"> Empire </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0363\">Empire</a> can use <a href=\"/software/S0194\">PowerSploit</a>'s <code>Invoke-TokenManipulation</code> to manipulate access tokens.<span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\" data-reference=\"Github PowerShell Empire\"><sup><a href=\"https://github.com/PowerShellEmpire/Empire\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0037\"> G0037 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0037\"> FIN6 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0037\">FIN6</a> has used has used Metasploit\u2019s named-pipe impersonation technique to escalate privileges.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.\" data-reference=\"FireEye FIN6 Apr 2019\"><sup><a href=\"https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0666\"> S0666 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0666\"> Gelsemium </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0666\">Gelsemium</a> can use token manipulation to bypass UAC on Windows7 systems.<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.\" data-reference=\"ESET Gelsemium June 2021\"><sup><a href=\"https://www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0697\"> S0697 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0697\"> HermeticWiper </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0697\">HermeticWiper</a> can use <code>AdjustTokenPrivileges</code> to grant itself privileges for debugging with <code>SeDebugPrivilege</code>, creating backups with <code>SeBackupPrivilege</code>, loading drivers with <code>SeLoadDriverPrivilege</code>, and shutting down a local system with <code>SeShutdownPrivilege</code>.<span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.\" data-reference=\"Qualys Hermetic Wiper March 2022\"><sup><a href=\"https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span><span onclick=\"scrollToRef('scite-13')\" id=\"scite-ref-13-a\" class=\"scite-citeref-number\" title=\"Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.\" data-reference=\"Crowdstrike DriveSlayer February 2022\"><sup><a href=\"https://www.crowdstrike.com/blog/how-crowdstrike-falcon-protects-against-wiper-malware-used-in-ukraine-attacks/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0203\"> S0203 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0203\"> Hydraq </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0203\">Hydraq</a> creates a backdoor through which remote attackers can adjust token privileges.<span onclick=\"scrollToRef('scite-14')\" id=\"scite-ref-14-a\" class=\"scite-citeref-number\" title=\"Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.\" data-reference=\"Symantec Hydraq Jan 2010\"><sup><a href=\"https://www.symantec.com/security_response/writeup.jsp?docid=2010-011114-1830-99\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0607\"> S0607 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0607\"> KillDisk </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0607\">KillDisk</a> has attempted to get the access token of a process by calling <code>OpenProcessToken</code>. If <a href=\"/software/S0607\">KillDisk</a> gets the access token, then it attempt to modify the token privileges with <code>AdjustTokenPrivileges</code>.<span onclick=\"scrollToRef('scite-15')\" id=\"scite-ref-15-a\" class=\"scite-citeref-number\" title=\"Gilbert Sison, Rheniel Ramos, Jay Yaneza, Alfredo Oliveira. (2018, January 15). KillDisk Variant Hits Latin American Financial Groups. Retrieved January 12, 2021.\" data-reference=\"Trend Micro KillDisk 2\"><sup><a href=\"https://www.trendmicro.com/en_us/research/18/a/new-killdisk-variant-hits-financial-organizations-in-latin-america.html\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S1060\"> S1060 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S1060\"> Mafalda </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S1060\">Mafalda</a> can use <code>AdjustTokenPrivileges()</code> to elevate privileges.<span onclick=\"scrollToRef('scite-16')\" id=\"scite-ref-16-a\" class=\"scite-citeref-number\" title=\"SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.\" data-reference=\"SentinelLabs Metador Technical Appendix Sept 2022\"><sup><a href=\"https://docs.google.com/document/d/1e9ZTW9b71YwFWS_18ZwDAxa-cYbV8q1wUefmKZLYVsA/edit#heading=h.lmnbtht1ikzm\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0576\"> S0576 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0576\"> MegaCortex </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0576\">MegaCortex</a> can enable <code>SeDebugPrivilege</code> and adjust token privileges.<span onclick=\"scrollToRef('scite-17')\" id=\"scite-ref-17-a\" class=\"scite-citeref-number\" title=\"Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.\" data-reference=\"IBM MegaCortex\"><sup><a href=\"https://securityintelligence.com/posts/from-mega-to-giga-cross-version-comparison-of-top-megacortex-modifications/\" target=\"_blank\" data-hasqtip=\"16\" aria-describedby=\"qtip-16\">[17]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0378\"> S0378 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0378\"> PoshC2 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0378\">PoshC2</a> can use Invoke-TokenManipulation for manipulating tokens.<span onclick=\"scrollToRef('scite-18')\" id=\"scite-ref-18-a\" class=\"scite-citeref-number\" title=\"Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\" data-reference=\"GitHub PoshC2\"><sup><a href=\"https://github.com/nettitude/PoshC2_Python\" target=\"_blank\" data-hasqtip=\"17\" aria-describedby=\"qtip-17\">[18]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0194\"> S0194 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0194\"> PowerSploit </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0194\">PowerSploit</a>'s <code>Invoke-TokenManipulation</code> Exfiltration module can be used to manipulate tokens.<span onclick=\"scrollToRef('scite-19')\" id=\"scite-ref-19-a\" class=\"scite-citeref-number\" title=\"PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.\" data-reference=\"GitHub PowerSploit May 2012\"><sup><a href=\"https://github.com/PowerShellMafia/PowerSploit\" target=\"_blank\" data-hasqtip=\"18\" aria-describedby=\"qtip-18\">[19]</a></sup></span><span onclick=\"scrollToRef('scite-20')\" id=\"scite-ref-20-a\" class=\"scite-citeref-number\" title=\"PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.\" data-reference=\"PowerSploit Documentation\"><sup><a href=\"http://powersploit.readthedocs.io\" target=\"_blank\" data-hasqtip=\"19\" aria-describedby=\"qtip-19\">[20]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0446\"> S0446 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0446\"> Ryuk </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0446\">Ryuk</a> has attempted to adjust its token privileges to have the <code>SeDebugPrivilege</code>.<span onclick=\"scrollToRef('scite-21')\" id=\"scite-ref-21-a\" class=\"scite-citeref-number\" title=\"Hanel, A. (2019, January 10). Big Game Hunting with Ryuk: Another Lucrative Targeted Ransomware. Retrieved May 12, 2020.\" data-reference=\"CrowdStrike Ryuk January 2019\"><sup><a href=\"https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/\" target=\"_blank\" data-hasqtip=\"20\" aria-describedby=\"qtip-20\">[21]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0633\"> S0633 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0633\"> Sliver </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0633\">Sliver</a> has the ability to manipulate user tokens on targeted Windows systems.<span onclick=\"scrollToRef('scite-22')\" id=\"scite-ref-22-a\" class=\"scite-citeref-number\" title=\"Kervella, R. (2019, August 4). Cross-platform General Purpose Implant Framework Written in Golang. Retrieved July 30, 2021.\" data-reference=\"Bishop Fox Sliver Framework August 2019\"><sup><a href=\"https://labs.bishopfox.com/tech-blog/sliver\" target=\"_blank\" data-hasqtip=\"21\" aria-describedby=\"qtip-21\">[22]</a></sup></span><span onclick=\"scrollToRef('scite-23')\" id=\"scite-ref-23-a\" class=\"scite-citeref-number\" title=\"BishopFox. (n.d.). Sliver. Retrieved September 15, 2021.\" data-reference=\"GitHub Sliver C2\"><sup><a href=\"https://github.com/BishopFox/sliver/\" target=\"_blank\" data-hasqtip=\"22\" aria-describedby=\"qtip-22\">[23]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0058\"> S0058 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0058\"> SslMM </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0058\">SslMM</a> contains a feature to manipulate process privileges and tokens.<span onclick=\"scrollToRef('scite-24')\" id=\"scite-ref-24-a\" class=\"scite-citeref-number\" title=\"Baumgartner, K., Golovkin, M.. (2015, May). The MsnMM Campaigns: The Earliest Naikon APT Campaigns. Retrieved April 10, 2019.\" data-reference=\"Baumgartner Naikon 2015\"><sup><a href=\"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07205555/TheNaikonAPT-MsnMM1.pdf\" target=\"_blank\" data-hasqtip=\"23\" aria-describedby=\"qtip-23\">[24]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0562\"> S0562 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0562\"> SUNSPOT </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0562\">SUNSPOT</a> modified its security token to grants itself debugging privileges by adding <code>SeDebugPrivilege</code>.<span onclick=\"scrollToRef('scite-25')\" id=\"scite-ref-25-a\" class=\"scite-citeref-number\" title=\"CrowdStrike Intelligence Team. (2021, January 11). SUNSPOT: An Implant in the Build Process. Retrieved January 11, 2021.\" data-reference=\"CrowdStrike SUNSPOT Implant January 2021\"><sup><a href=\"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/\" target=\"_blank\" data-hasqtip=\"24\" aria-describedby=\"qtip-24\">[25]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Create a token object. <span onclick=\"scrollToRef('scite-26')\" id=\"scite-ref-26-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\" data-reference=\"Microsoft Create Token\"><sup><a href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\" data-hasqtip=\"25\" aria-describedby=\"qtip-25\">[26]</a></sup></span> Also define who can create a process level token to only the local and network service through GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Replace a process level token.<span onclick=\"scrollToRef('scite-27')\" id=\"scite-ref-27-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\" data-reference=\"Microsoft Replace Process Token\"><sup><a href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\" data-hasqtip=\"26\" aria-describedby=\"qtip-26\">[27]</a></sup></span></p><p>Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.<span onclick=\"scrollToRef('scite-28')\" id=\"scite-ref-28-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\" data-reference=\"Microsoft runas\"><sup><a href=\"https://technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\" data-hasqtip=\"27\" aria-describedby=\"qtip-27\">[28]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> M1018 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> User Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.  </p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0026\">\n                <td>\n                    <a href=\"/datasources/DS0026\">DS0026</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0026\">Active Directory</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0026/#Active%20Directory%20Object%20Modification\">Active Directory Object Modification</a>\n                </td>\n                    <td>\n                                <p>Monitor for changes made to AD settings that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor executed commands and arguments for token manipulation by auditing command-line activity. Specifically, analysts should look for use of the <code>runas</code> command. Detailed command-line logging is not enabled by default in Windows.<span onclick=\"scrollToRef('scite-29')\" id=\"scite-ref-29-a\" class=\"scite-citeref-number\" title=\"Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\" data-reference=\"Microsoft Command-line Logging\"><sup><a href=\"https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\" data-hasqtip=\"28\" aria-describedby=\"qtip-28\">[29]</a></sup></span></p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor for API calls, loaded by a payload, for token manipulation only through careful analysis of user network activity, examination of running processes, and correlation with other endpoint and network behavior. There are many Windows API calls a payload can take advantage of to manipulate access tokens (e.g., <code>LogonUser</code> <span onclick=\"scrollToRef('scite-30')\" id=\"scite-ref-30-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\" data-reference=\"Microsoft LogonUser\"><sup><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378184(v=vs.85).aspx\" target=\"_blank\" data-hasqtip=\"29\" aria-describedby=\"qtip-29\">[30]</a></sup></span>, <code>DuplicateTokenEx</code><span onclick=\"scrollToRef('scite-31')\" id=\"scite-ref-31-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\" data-reference=\"Microsoft DuplicateTokenEx\"><sup><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa446617(v=vs.85).aspx\" target=\"_blank\" data-hasqtip=\"30\" aria-describedby=\"qtip-30\">[31]</a></sup></span>, and <code>ImpersonateLoggedOnUser</code><span onclick=\"scrollToRef('scite-32')\" id=\"scite-ref-32-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\" data-reference=\"Microsoft ImpersonateLoggedOnUser\"><sup><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378612(v=vs.85).aspx\" target=\"_blank\" data-hasqtip=\"31\" aria-describedby=\"qtip-31\">[32]</a></sup></span>). Please see the referenced Windows API pages for more information.</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Creation\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Creation\">Process Creation</a>\n                        </td>\n                            <td>\n                                        <p>Monitor for executed processes that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.</p>\n\n                            </td>\n                    </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Metadata\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Metadata\">Process Metadata</a>\n                        </td>\n                            <td>\n                                        <p>Query systems for process and thread token information and look for inconsistencies such as user owns processes impersonating the local SYSTEM account.<span onclick=\"scrollToRef('scite-33')\" id=\"scite-ref-33-a\" class=\"scite-citeref-number\" title=\"Atkinson, J., Winchester, R. (2017, December 7). A Process is No One: Hunting for Token Manipulation. Retrieved December 21, 2017.\" data-reference=\"BlackHat Atkinson Winchester Token Manipulation\"><sup><a href=\"https://www.blackhat.com/docs/eu-17/materials/eu-17-Atkinson-A-Process-Is-No-One-Hunting-For-Token-Manipulation.pdf\" target=\"_blank\" data-hasqtip=\"32\" aria-describedby=\"qtip-32\">[33]</a></sup></span> Look for inconsistencies between the various fields that store PPID information, such as the EventHeader ProcessId from data collected via Event Tracing for Windows (ETW), Creator Process ID/Name from Windows event logs, and the ProcessID and ParentProcessID (which are also produced from ETW and other utilities such as Task Manager and Process Explorer). The ETW provided EventHeader ProcessId identifies the actual parent process.</p>\n\n                            </td>\n                    </tr>\n            <tr class=\"datasource\" id=\"uses-DS0002\">\n                <td>\n                    <a href=\"/datasources/DS0002\">DS0002</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0002\">User Account</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0002/#User%20Account%20Metadata\">User Account Metadata</a>\n                </td>\n                    <td>\n                                <p>Monitor for contextual data about an account, which may include a username, user ID, environmental data, etc. that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.</p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://pentestlab.blog/2017/04/03/token-manipulation/\" target=\"_blank\">\n                        netbiosX. (2017, April 3). Token Manipulation. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://blog.malwarebytes.com/threat-analysis/2021/06/kimsuky-apt-continues-to-target-south-korean-government-using-appleseed-backdoor/\" target=\"_blank\">\n                        Jazi, H. (2021, June 1). Kimsuky APT continues to target South Korean government using AppleSeed backdoor. Retrieved June 10, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/\" target=\"_blank\">\n                        Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/\" target=\"_blank\">\n                        Brandt, Andrew. (2022, July 14). BlackCat ransomware attacks not merely a byproduct of bad luck. Retrieved December 20, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://redcanary.com/blog/blue-mockingbird-cryptominer/\" target=\"_blank\">\n                        Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https://www.mandiant.com/resources/apt41-us-state-governments\" target=\"_blank\">\n                        Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https://www.mcafee.com/enterprise/en-us/assets/reports/rp-cuba-ransomware.pdf\" target=\"_blank\">\n                        Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https://securelist.com/files/2015/06/The_Mystery_of_Duqu_2_0_a_sophisticated_cyberespionage_actor_returns.pdf\" target=\"_blank\">\n                        Kaspersky Lab. (2015, June 11). The Duqu 2.0. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https://github.com/PowerShellEmpire/Empire\" target=\"_blank\">\n                        Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\" target=\"_blank\">\n                        McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https://www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf\" target=\"_blank\">\n                        Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https://blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware\" target=\"_blank\">\n                        Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-13\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-13\" href=\"https://www.crowdstrike.com/blog/how-crowdstrike-falcon-protects-against-wiper-malware-used-in-ukraine-attacks/\" target=\"_blank\">\n                        Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-14\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-14\" href=\"https://www.symantec.com/security_response/writeup.jsp?docid=2010-011114-1830-99\" target=\"_blank\">\n                        Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-15\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-15\" href=\"https://www.trendmicro.com/en_us/research/18/a/new-killdisk-variant-hits-financial-organizations-in-latin-america.html\" target=\"_blank\">\n                        Gilbert Sison, Rheniel Ramos, Jay Yaneza, Alfredo Oliveira. (2018, January 15). KillDisk Variant Hits Latin American Financial Groups. Retrieved January 12, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-16\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-16\" href=\"https://docs.google.com/document/d/1e9ZTW9b71YwFWS_18ZwDAxa-cYbV8q1wUefmKZLYVsA/edit#heading=h.lmnbtht1ikzm\" target=\"_blank\">\n                        SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-17\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-17\" href=\"https://securityintelligence.com/posts/from-mega-to-giga-cross-version-comparison-of-top-megacortex-modifications/\" target=\"_blank\">\n                        Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"18.0\">\n                                \n        <li>\n            <span id=\"scite-18\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-18\" href=\"https://github.com/nettitude/PoshC2_Python\" target=\"_blank\">\n                        Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-19\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-19\" href=\"https://github.com/PowerShellMafia/PowerSploit\" target=\"_blank\">\n                        PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-20\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-20\" href=\"http://powersploit.readthedocs.io\" target=\"_blank\">\n                        PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-21\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-21\" href=\"https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/\" target=\"_blank\">\n                        Hanel, A. (2019, January 10). Big Game Hunting with Ryuk: Another Lucrative Targeted Ransomware. Retrieved May 12, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-22\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-22\" href=\"https://labs.bishopfox.com/tech-blog/sliver\" target=\"_blank\">\n                        Kervella, R. (2019, August 4). Cross-platform General Purpose Implant Framework Written in Golang. Retrieved July 30, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-23\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-23\" href=\"https://github.com/BishopFox/sliver/\" target=\"_blank\">\n                        BishopFox. (n.d.). Sliver. Retrieved September 15, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-24\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-24\" href=\"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07205555/TheNaikonAPT-MsnMM1.pdf\" target=\"_blank\">\n                        Baumgartner, K., Golovkin, M.. (2015, May). The MsnMM Campaigns: The Earliest Naikon APT Campaigns. Retrieved April 10, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-25\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-25\" href=\"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/\" target=\"_blank\">\n                        CrowdStrike Intelligence Team. (2021, January 11). SUNSPOT: An Implant in the Build Process. Retrieved January 11, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-26\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-26\" href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-27\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-27\" href=\"https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-28\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-28\" href=\"https://technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-29\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-29\" href=\"https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\">\n                        Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-30\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-30\" href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378184(v=vs.85).aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-31\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-31\" href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa446617(v=vs.85).aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-32\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-32\" href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378612(v=vs.85).aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-33\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-33\" href=\"https://www.blackhat.com/docs/eu-17/materials/eu-17-Atkinson-A-Process-Is-No-One-Hunting-For-Token-Manipulation.pdf\" target=\"_blank\">\n                        Atkinson, J., Winchester, R. (2017, December 7). A Process is No One: Hunting for Token Manipulation. Retrieved December 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?7172\"></script>\n    <script src=\"/theme/scripts/settings.js?3772\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-techniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Access Token Manipulation, Technique T1134 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n        <li class=\"breadcrumb-item\">Access Token Manipulation</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                        Access Token Manipulation\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Sub-techniques (5)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> T1134.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.001\"> Token Impersonation/Theft </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> T1134.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.002\"> Create Process with Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> T1134.003 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/003/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.003\"> Make and Impersonate Token </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> T1134.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.004\"> Parent PID Spoofing </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> T1134.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1134/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1134.005\"> SID-History Injection </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token.</p><p>An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. <a href=\"/techniques/T1134/001\">Token Impersonation/Theft</a>) or used to spawn a new process (i.e. <a href=\"/techniques/T1134/002\">Create Process with Token</a>). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"netbiosX. (2017, April 3). Token Manipulation. Retrieved April 21, 2017.\" data-reference=\"Pentestlab Token Manipulation\"><sup><a href=\"https:/pentestlab.blog/2017/04/03/token-manipulation/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1134\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-techniques:&nbsp;</span>\n                                                            <a href=\"/techniques/T1134/001\">T1134.001</a>,                                                            <a href=\"/techniques/T1134/002\">T1134.002</a>,                                                            <a href=\"/techniques/T1134/003\">T1134.003</a>,                                                            <a href=\"/techniques/T1134/004\">T1134.004</a>,                                                            <a href=\"/techniques/T1134/005\">T1134.005</a>                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The lowest level of permissions the adversary is required to be operating within to perform the (sub-)technique on a system\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Permissions Required:&nbsp;</span>Administrator, User\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The level of permissions the adversary will attain by performing the (sub-)technique\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Effective Permissions:&nbsp;</span>SYSTEM\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Heuristic Detection, Host Forensic Analysis, System Access Controls, Windows User Account Control\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Jared Atkinson, @jaredcatkinson; Robby Winchester, @robwinchester3; Tom Ueltschi @c_APT_ure; Travis Smith, Tripwire\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>2.0\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>14 December 2017\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>30 March 2023\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1134\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1134/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1134\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0622\"> S0622 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0622\"> AppleSeed </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0622\">AppleSeed</a> can gain system level privilege by passing <code>SeDebugPrivilege</code> to the <code>AdjustTokenPrivilege</code> API.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Jazi, H. (2021, June 1). Kimsuky APT continues to target South Korean government using AppleSeed backdoor. Retrieved June 10, 2021.\" data-reference=\"Malwarebytes Kimsuky June 2021\"><sup><a href=\"https:/blog.malwarebytes.com/threat-analysis/2021/06/kimsuky-apt-continues-to-target-south-korean-government-using-appleseed-backdoor/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S1068\"> S1068 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S1068\"> BlackCat </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S1068\">BlackCat</a> has the ability modify access tokens.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.\" data-reference=\"Microsoft BlackCat Jun 2022\"><sup><a href=\"https:/www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span><span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Brandt, Andrew. (2022, July 14). BlackCat ransomware attacks not merely a byproduct of bad luck. Retrieved December 20, 2022.\" data-reference=\"Sophos BlackCat Jul 2022\"><sup><a href=\"https:/news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0108\"> G0108 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0108\"> Blue Mockingbird </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0108\">Blue Mockingbird</a> has used JuicyPotato to abuse the <code>SeImpersonate</code> token privilege to escalate from web application pool accounts to NT Authority\\SYSTEM.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.\" data-reference=\"RedCanary Mockingbird May 2020\"><sup><a href=\"https:/redcanary.com/blog/blue-mockingbird-cryptominer/\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/campaigns/C0017\"> C0017 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/campaigns/C0017\"> C0017 </a>\n                                            </td>\n                                            <td>\n                                                            <p>During <a href=\"https:/attack.mitre.org/campaigns/C0017\">C0017</a>, <a href=\"/groups/G0096\">APT41</a> used a ConfuserEx obfuscated BADPOTATO exploit to abuse named-pipe impersonation for local <code>NT AUTHORITY\\SYSTEM</code> privilege escalation.<span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.\" data-reference=\"Mandiant APT41\"><sup><a href=\"https:/www.mandiant.com/resources/apt41-us-state-governments\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0625\"> S0625 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0625\"> Cuba </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0625\">Cuba</a> has used <code>SeDebugPrivilege</code> and <code>AdjustTokenPrivileges</code> to elevate privileges.<span onclick=\"scrollToRef('scite-7')\" id=\"scite-ref-7-a\" class=\"scite-citeref-number\" title=\"Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.\" data-reference=\"McAfee Cuba April 2021\"><sup><a href=\"https:/www.mcafee.com/enterprise/en-us/assets/reports/rp-cuba-ransomware.pdf\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0038\"> S0038 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0038\"> Duqu </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0038\">Duqu</a> examines running system processes for tokens that have specific system privileges. If it finds one, it will copy the token and store it for later use. Eventually it will start new processes with the stored token attached. It can also steal tokens to acquire administrative privileges.<span onclick=\"scrollToRef('scite-8')\" id=\"scite-ref-8-a\" class=\"scite-citeref-number\" title=\"Kaspersky Lab. (2015, June 11). The Duqu 2.0. Retrieved April 21, 2017.\" data-reference=\"Kaspersky Duqu 2.0\"><sup><a href=\"https:/securelist.com/files/2015/06/The_Mystery_of_Duqu_2_0_a_sophisticated_cyberespionage_actor_returns.pdf\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0363\"> S0363 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0363\"> Empire </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0363\">Empire</a> can use <a href=\"/software/S0194\">PowerSploit</a>'s <code>Invoke-TokenManipulation</code> to manipulate access tokens.<span onclick=\"scrollToRef('scite-9')\" id=\"scite-ref-9-a\" class=\"scite-citeref-number\" title=\"Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\" data-reference=\"Github PowerShell Empire\"><sup><a href=\"https:/github.com/PowerShellEmpire/Empire\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0037\"> G0037 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0037\"> FIN6 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0037\">FIN6</a> has used has used Metasploit\u2019s named-pipe impersonation technique to escalate privileges.<span onclick=\"scrollToRef('scite-10')\" id=\"scite-ref-10-a\" class=\"scite-citeref-number\" title=\"McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.\" data-reference=\"FireEye FIN6 Apr 2019\"><sup><a href=\"https:/www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0666\"> S0666 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0666\"> Gelsemium </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0666\">Gelsemium</a> can use token manipulation to bypass UAC on Windows7 systems.<span onclick=\"scrollToRef('scite-11')\" id=\"scite-ref-11-a\" class=\"scite-citeref-number\" title=\"Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.\" data-reference=\"ESET Gelsemium June 2021\"><sup><a href=\"https:/www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0697\"> S0697 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0697\"> HermeticWiper </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0697\">HermeticWiper</a> can use <code>AdjustTokenPrivileges</code> to grant itself privileges for debugging with <code>SeDebugPrivilege</code>, creating backups with <code>SeBackupPrivilege</code>, loading drivers with <code>SeLoadDriverPrivilege</code>, and shutting down a local system with <code>SeShutdownPrivilege</code>.<span onclick=\"scrollToRef('scite-12')\" id=\"scite-ref-12-a\" class=\"scite-citeref-number\" title=\"Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.\" data-reference=\"Qualys Hermetic Wiper March 2022\"><sup><a href=\"https:/blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span><span onclick=\"scrollToRef('scite-13')\" id=\"scite-ref-13-a\" class=\"scite-citeref-number\" title=\"Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.\" data-reference=\"Crowdstrike DriveSlayer February 2022\"><sup><a href=\"https:/www.crowdstrike.com/blog/how-crowdstrike-falcon-protects-against-wiper-malware-used-in-ukraine-attacks/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0203\"> S0203 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0203\"> Hydraq </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0203\">Hydraq</a> creates a backdoor through which remote attackers can adjust token privileges.<span onclick=\"scrollToRef('scite-14')\" id=\"scite-ref-14-a\" class=\"scite-citeref-number\" title=\"Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.\" data-reference=\"Symantec Hydraq Jan 2010\"><sup><a href=\"https:/www.symantec.com/security_response/writeup.jsp?docid=2010-011114-1830-99\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0607\"> S0607 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0607\"> KillDisk </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0607\">KillDisk</a> has attempted to get the access token of a process by calling <code>OpenProcessToken</code>. If <a href=\"/software/S0607\">KillDisk</a> gets the access token, then it attempt to modify the token privileges with <code>AdjustTokenPrivileges</code>.<span onclick=\"scrollToRef('scite-15')\" id=\"scite-ref-15-a\" class=\"scite-citeref-number\" title=\"Gilbert Sison, Rheniel Ramos, Jay Yaneza, Alfredo Oliveira. (2018, January 15). KillDisk Variant Hits Latin American Financial Groups. Retrieved January 12, 2021.\" data-reference=\"Trend Micro KillDisk 2\"><sup><a href=\"https:/www.trendmicro.com/en_us/research/18/a/new-killdisk-variant-hits-financial-organizations-in-latin-america.html\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S1060\"> S1060 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S1060\"> Mafalda </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S1060\">Mafalda</a> can use <code>AdjustTokenPrivileges()</code> to elevate privileges.<span onclick=\"scrollToRef('scite-16')\" id=\"scite-ref-16-a\" class=\"scite-citeref-number\" title=\"SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.\" data-reference=\"SentinelLabs Metador Technical Appendix Sept 2022\"><sup><a href=\"https:/docs.google.com/document/d/1e9ZTW9b71YwFWS_18ZwDAxa-cYbV8q1wUefmKZLYVsA/edit#heading=h.lmnbtht1ikzm\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0576\"> S0576 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0576\"> MegaCortex </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0576\">MegaCortex</a> can enable <code>SeDebugPrivilege</code> and adjust token privileges.<span onclick=\"scrollToRef('scite-17')\" id=\"scite-ref-17-a\" class=\"scite-citeref-number\" title=\"Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.\" data-reference=\"IBM MegaCortex\"><sup><a href=\"https:/securityintelligence.com/posts/from-mega-to-giga-cross-version-comparison-of-top-megacortex-modifications/\" target=\"_blank\" data-hasqtip=\"16\" aria-describedby=\"qtip-16\">[17]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0378\"> S0378 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0378\"> PoshC2 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0378\">PoshC2</a> can use Invoke-TokenManipulation for manipulating tokens.<span onclick=\"scrollToRef('scite-18')\" id=\"scite-ref-18-a\" class=\"scite-citeref-number\" title=\"Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\" data-reference=\"GitHub PoshC2\"><sup><a href=\"https:/github.com/nettitude/PoshC2_Python\" target=\"_blank\" data-hasqtip=\"17\" aria-describedby=\"qtip-17\">[18]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0194\"> S0194 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0194\"> PowerSploit </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0194\">PowerSploit</a>'s <code>Invoke-TokenManipulation</code> Exfiltration module can be used to manipulate tokens.<span onclick=\"scrollToRef('scite-19')\" id=\"scite-ref-19-a\" class=\"scite-citeref-number\" title=\"PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.\" data-reference=\"GitHub PowerSploit May 2012\"><sup><a href=\"https:/github.com/PowerShellMafia/PowerSploit\" target=\"_blank\" data-hasqtip=\"18\" aria-describedby=\"qtip-18\">[19]</a></sup></span><span onclick=\"scrollToRef('scite-20')\" id=\"scite-ref-20-a\" class=\"scite-citeref-number\" title=\"PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.\" data-reference=\"PowerSploit Documentation\"><sup><a href=\"http:/powersploit.readthedocs.io\" target=\"_blank\" data-hasqtip=\"19\" aria-describedby=\"qtip-19\">[20]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0446\"> S0446 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0446\"> Ryuk </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0446\">Ryuk</a> has attempted to adjust its token privileges to have the <code>SeDebugPrivilege</code>.<span onclick=\"scrollToRef('scite-21')\" id=\"scite-ref-21-a\" class=\"scite-citeref-number\" title=\"Hanel, A. (2019, January 10). Big Game Hunting with Ryuk: Another Lucrative Targeted Ransomware. Retrieved May 12, 2020.\" data-reference=\"CrowdStrike Ryuk January 2019\"><sup><a href=\"https:/www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/\" target=\"_blank\" data-hasqtip=\"20\" aria-describedby=\"qtip-20\">[21]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0633\"> S0633 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0633\"> Sliver </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0633\">Sliver</a> has the ability to manipulate user tokens on targeted Windows systems.<span onclick=\"scrollToRef('scite-22')\" id=\"scite-ref-22-a\" class=\"scite-citeref-number\" title=\"Kervella, R. (2019, August 4). Cross-platform General Purpose Implant Framework Written in Golang. Retrieved July 30, 2021.\" data-reference=\"Bishop Fox Sliver Framework August 2019\"><sup><a href=\"https:/labs.bishopfox.com/tech-blog/sliver\" target=\"_blank\" data-hasqtip=\"21\" aria-describedby=\"qtip-21\">[22]</a></sup></span><span onclick=\"scrollToRef('scite-23')\" id=\"scite-ref-23-a\" class=\"scite-citeref-number\" title=\"BishopFox. (n.d.). Sliver. Retrieved September 15, 2021.\" data-reference=\"GitHub Sliver C2\"><sup><a href=\"https:/github.com/BishopFox/sliver/\" target=\"_blank\" data-hasqtip=\"22\" aria-describedby=\"qtip-22\">[23]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0058\"> S0058 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0058\"> SslMM </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0058\">SslMM</a> contains a feature to manipulate process privileges and tokens.<span onclick=\"scrollToRef('scite-24')\" id=\"scite-ref-24-a\" class=\"scite-citeref-number\" title=\"Baumgartner, K., Golovkin, M.. (2015, May). The MsnMM Campaigns: The Earliest Naikon APT Campaigns. Retrieved April 10, 2019.\" data-reference=\"Baumgartner Naikon 2015\"><sup><a href=\"https:/media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07205555/TheNaikonAPT-MsnMM1.pdf\" target=\"_blank\" data-hasqtip=\"23\" aria-describedby=\"qtip-23\">[24]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0562\"> S0562 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0562\"> SUNSPOT </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0562\">SUNSPOT</a> modified its security token to grants itself debugging privileges by adding <code>SeDebugPrivilege</code>.<span onclick=\"scrollToRef('scite-25')\" id=\"scite-ref-25-a\" class=\"scite-citeref-number\" title=\"CrowdStrike Intelligence Team. (2021, January 11). SUNSPOT: An Implant in the Build Process. Retrieved January 11, 2021.\" data-reference=\"CrowdStrike SUNSPOT Implant January 2021\"><sup><a href=\"https:/www.crowdstrike.com/blog/sunspot-malware-technical-analysis/\" target=\"_blank\" data-hasqtip=\"24\" aria-describedby=\"qtip-24\">[25]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> M1026 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1026\"> Privileged Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Create a token object. <span onclick=\"scrollToRef('scite-26')\" id=\"scite-ref-26-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\" data-reference=\"Microsoft Create Token\"><sup><a href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\" data-hasqtip=\"25\" aria-describedby=\"qtip-25\">[26]</a></sup></span> Also define who can create a process level token to only the local and network service through GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment: Replace a process level token.<span onclick=\"scrollToRef('scite-27')\" id=\"scite-ref-27-a\" class=\"scite-citeref-number\" title=\"Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\" data-reference=\"Microsoft Replace Process Token\"><sup><a href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\" data-hasqtip=\"26\" aria-describedby=\"qtip-26\">[27]</a></sup></span></p><p>Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>.<span onclick=\"scrollToRef('scite-28')\" id=\"scite-ref-28-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\" data-reference=\"Microsoft runas\"><sup><a href=\"https:/technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\" data-hasqtip=\"27\" aria-describedby=\"qtip-27\">[28]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> M1018 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1018\"> User Account Management </a>\n                                                </td>\n                                                <td>\n                                                                <p>An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.  </p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0026\">\n                <td>\n                    <a href=\"/datasources/DS0026\">DS0026</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0026\">Active Directory</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0026/#Active%20Directory%20Object%20Modification\">Active Directory Object Modification</a>\n                </td>\n                    <td>\n                                <p>Monitor for changes made to AD settings that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor executed commands and arguments for token manipulation by auditing command-line activity. Specifically, analysts should look for use of the <code>runas</code> command. Detailed command-line logging is not enabled by default in Windows.<span onclick=\"scrollToRef('scite-29')\" id=\"scite-ref-29-a\" class=\"scite-citeref-number\" title=\"Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\" data-reference=\"Microsoft Command-line Logging\"><sup><a href=\"https:/technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\" data-hasqtip=\"28\" aria-describedby=\"qtip-28\">[29]</a></sup></span></p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitor for API calls, loaded by a payload, for token manipulation only through careful analysis of user network activity, examination of running processes, and correlation with other endpoint and network behavior. There are many Windows API calls a payload can take advantage of to manipulate access tokens (e.g., <code>LogonUser</code> <span onclick=\"scrollToRef('scite-30')\" id=\"scite-ref-30-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\" data-reference=\"Microsoft LogonUser\"><sup><a href=\"https:/msdn.microsoft.com/en-us/library/windows/desktop/aa378184(v=vs.85).aspx\" target=\"_blank\" data-hasqtip=\"29\" aria-describedby=\"qtip-29\">[30]</a></sup></span>, <code>DuplicateTokenEx</code><span onclick=\"scrollToRef('scite-31')\" id=\"scite-ref-31-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\" data-reference=\"Microsoft DuplicateTokenEx\"><sup><a href=\"https:/msdn.microsoft.com/en-us/library/windows/desktop/aa446617(v=vs.85).aspx\" target=\"_blank\" data-hasqtip=\"30\" aria-describedby=\"qtip-30\">[31]</a></sup></span>, and <code>ImpersonateLoggedOnUser</code><span onclick=\"scrollToRef('scite-32')\" id=\"scite-ref-32-a\" class=\"scite-citeref-number\" title=\"Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\" data-reference=\"Microsoft ImpersonateLoggedOnUser\"><sup><a href=\"https:/msdn.microsoft.com/en-us/library/windows/desktop/aa378612(v=vs.85).aspx\" target=\"_blank\" data-hasqtip=\"31\" aria-describedby=\"qtip-31\">[32]</a></sup></span>). Please see the referenced Windows API pages for more information.</p>\n\n                    </td>\n            </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Creation\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Creation\">Process Creation</a>\n                        </td>\n                            <td>\n                                        <p>Monitor for executed processes that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.</p>\n\n                            </td>\n                    </tr>\n                    <tr class=\"datacomponent datasource\" id=\"uses-DS0009-Process Metadata\">\n                        <td></td>\n                        <td></td>\n                        <td>\n                            <a href=\"/datasources/DS0009/#Process%20Metadata\">Process Metadata</a>\n                        </td>\n                            <td>\n                                        <p>Query systems for process and thread token information and look for inconsistencies such as user owns processes impersonating the local SYSTEM account.<span onclick=\"scrollToRef('scite-33')\" id=\"scite-ref-33-a\" class=\"scite-citeref-number\" title=\"Atkinson, J., Winchester, R. (2017, December 7). A Process is No One: Hunting for Token Manipulation. Retrieved December 21, 2017.\" data-reference=\"BlackHat Atkinson Winchester Token Manipulation\"><sup><a href=\"https:/www.blackhat.com/docs/eu-17/materials/eu-17-Atkinson-A-Process-Is-No-One-Hunting-For-Token-Manipulation.pdf\" target=\"_blank\" data-hasqtip=\"32\" aria-describedby=\"qtip-32\">[33]</a></sup></span> Look for inconsistencies between the various fields that store PPID information, such as the EventHeader ProcessId from data collected via Event Tracing for Windows (ETW), Creator Process ID/Name from Windows event logs, and the ProcessID and ParentProcessID (which are also produced from ETW and other utilities such as Task Manager and Process Explorer). The ETW provided EventHeader ProcessId identifies the actual parent process.</p>\n\n                            </td>\n                    </tr>\n            <tr class=\"datasource\" id=\"uses-DS0002\">\n                <td>\n                    <a href=\"/datasources/DS0002\">DS0002</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0002\">User Account</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0002/#User%20Account%20Metadata\">User Account Metadata</a>\n                </td>\n                    <td>\n                                <p>Monitor for contextual data about an account, which may include a username, user ID, environmental data, etc. that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.</p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/pentestlab.blog/2017/04/03/token-manipulation/\" target=\"_blank\">\n                        netbiosX. (2017, April 3). Token Manipulation. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/blog.malwarebytes.com/threat-analysis/2021/06/kimsuky-apt-continues-to-target-south-korean-government-using-appleseed-backdoor/\" target=\"_blank\">\n                        Jazi, H. (2021, June 1). Kimsuky APT continues to target South Korean government using AppleSeed backdoor. Retrieved June 10, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https:/www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/\" target=\"_blank\">\n                        Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/\" target=\"_blank\">\n                        Brandt, Andrew. (2022, July 14). BlackCat ransomware attacks not merely a byproduct of bad luck. Retrieved December 20, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/redcanary.com/blog/blue-mockingbird-cryptominer/\" target=\"_blank\">\n                        Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"https:/www.mandiant.com/resources/apt41-us-state-governments\" target=\"_blank\">\n                        Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-7\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-7\" href=\"https:/www.mcafee.com/enterprise/en-us/assets/reports/rp-cuba-ransomware.pdf\" target=\"_blank\">\n                        Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-8\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-8\" href=\"https:/securelist.com/files/2015/06/The_Mystery_of_Duqu_2_0_a_sophisticated_cyberespionage_actor_returns.pdf\" target=\"_blank\">\n                        Kaspersky Lab. (2015, June 11). The Duqu 2.0. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-9\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-9\" href=\"https:/github.com/PowerShellEmpire/Empire\" target=\"_blank\">\n                        Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-10\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-10\" href=\"https:/www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\" target=\"_blank\">\n                        McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-11\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-11\" href=\"https:/www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf\" target=\"_blank\">\n                        Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-12\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-12\" href=\"https:/blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-malware\" target=\"_blank\">\n                        Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-13\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-13\" href=\"https:/www.crowdstrike.com/blog/how-crowdstrike-falcon-protects-against-wiper-malware-used-in-ukraine-attacks/\" target=\"_blank\">\n                        Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-14\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-14\" href=\"https:/www.symantec.com/security_response/writeup.jsp?docid=2010-011114-1830-99\" target=\"_blank\">\n                        Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-15\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-15\" href=\"https:/www.trendmicro.com/en_us/research/18/a/new-killdisk-variant-hits-financial-organizations-in-latin-america.html\" target=\"_blank\">\n                        Gilbert Sison, Rheniel Ramos, Jay Yaneza, Alfredo Oliveira. (2018, January 15). KillDisk Variant Hits Latin American Financial Groups. Retrieved January 12, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-16\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-16\" href=\"https:/docs.google.com/document/d/1e9ZTW9b71YwFWS_18ZwDAxa-cYbV8q1wUefmKZLYVsA/edit#heading=h.lmnbtht1ikzm\" target=\"_blank\">\n                        SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-17\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-17\" href=\"https:/securityintelligence.com/posts/from-mega-to-giga-cross-version-comparison-of-top-megacortex-modifications/\" target=\"_blank\">\n                        Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"18.0\">\n                                \n        <li>\n            <span id=\"scite-18\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-18\" href=\"https:/github.com/nettitude/PoshC2_Python\" target=\"_blank\">\n                        Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-19\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-19\" href=\"https:/github.com/PowerShellMafia/PowerSploit\" target=\"_blank\">\n                        PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-20\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-20\" href=\"http:/powersploit.readthedocs.io\" target=\"_blank\">\n                        PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-21\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-21\" href=\"https:/www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/\" target=\"_blank\">\n                        Hanel, A. (2019, January 10). Big Game Hunting with Ryuk: Another Lucrative Targeted Ransomware. Retrieved May 12, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-22\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-22\" href=\"https:/labs.bishopfox.com/tech-blog/sliver\" target=\"_blank\">\n                        Kervella, R. (2019, August 4). Cross-platform General Purpose Implant Framework Written in Golang. Retrieved July 30, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-23\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-23\" href=\"https:/github.com/BishopFox/sliver/\" target=\"_blank\">\n                        BishopFox. (n.d.). Sliver. Retrieved September 15, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-24\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-24\" href=\"https:/media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07205555/TheNaikonAPT-MsnMM1.pdf\" target=\"_blank\">\n                        Baumgartner, K., Golovkin, M.. (2015, May). The MsnMM Campaigns: The Earliest Naikon APT Campaigns. Retrieved April 10, 2019.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-25\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-25\" href=\"https:/www.crowdstrike.com/blog/sunspot-malware-technical-analysis/\" target=\"_blank\">\n                        CrowdStrike Intelligence Team. (2021, January 11). SUNSPOT: An Implant in the Build Process. Retrieved January 11, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-26\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-26\" href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-27\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-27\" href=\"https:/docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token\" target=\"_blank\">\n                        Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-28\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-28\" href=\"https:/technet.microsoft.com/en-us/library/bb490994.aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-29\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-29\" href=\"https:/technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing\" target=\"_blank\">\n                        Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-30\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-30\" href=\"https:/msdn.microsoft.com/en-us/library/windows/desktop/aa378184(v=vs.85).aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-31\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-31\" href=\"https:/msdn.microsoft.com/en-us/library/windows/desktop/aa446617(v=vs.85).aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-32\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-32\" href=\"https:/msdn.microsoft.com/en-us/library/windows/desktop/aa378612(v=vs.85).aspx\" target=\"_blank\">\n                        Microsoft TechNet. (n.d.). Retrieved April 25, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-33\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-33\" href=\"https:/www.blackhat.com/docs/eu-17/materials/eu-17-Atkinson-A-Process-Is-No-One-Hunting-For-Token-Manipulation.pdf\" target=\"_blank\">\n                        Atkinson, J., Winchester, R. (2017, December 7). A Process is No One: Hunting for Token Manipulation. Retrieved December 21, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?7172\"></script>\n    <script src=\"/theme/scripts/settings.js?3772\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-techniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "f4c20089-7945-4a91-8d07-f2be1aef7ce0"
}