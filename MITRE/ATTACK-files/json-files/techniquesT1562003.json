{
  "api_response": {
    "ai_query_time": "2024-06-14T04:56:15.170284",
    "ai_response_data": "{\n  \"title\": \"Impair Defenses: Impair Command History Logging, Sub-technique T1562.003 - Enterprise | MITRE ATT\\u0026CK\\u00ae\",\n  \"breadcrumb\": [\n    {\n      \"label\": \"Home\",\n      \"link\": \"/\"\n    },\n    {\n      \"label\": \"Techniques\",\n      \"link\": \"/techniques/enterprise\"\n    },\n    {\n      \"label\": \"Enterprise\",\n      \"link\": \"/techniques/enterprise\"\n    },\n    {\n      \"label\": \"Impair Defenses\",\n      \"link\": \"/techniques/T1562\"\n    },\n    {\n      \"label\": \"Impair Command History Logging\"\n    }\n  ],\n  \"sub_techniques\": [\n    {\n      \"id\": \"T1562.001\",\n      \"name\": \"Disable or Modify Tools\",\n      \"link\": \"/techniques/T1562/001/\"\n    },\n    {\n      \"id\": \"T1562.002\",\n      \"name\": \"Disable Windows Event Logging\",\n      \"link\": \"/techniques/T1562/002/\"\n    },\n    {\n      \"id\": \"T1562.003\",\n      \"name\": \"Impair Command History Logging\"\n    },\n    {\n      \"id\": \"T1562.004\",\n      \"name\": \"Disable or Modify System Firewall\",\n      \"link\": \"/techniques/T1562/004/\"\n    },\n    {\n      \"id\": \"T1562.006\",\n      \"name\": \"Indicator Blocking\",\n      \"link\": \"/techniques/T1562/006/\"\n    },\n    {\n      \"id\": \"T1562.007\",\n      \"name\": \"Disable or Modify Cloud Firewall\",\n      \"link\": \"/techniques/T1562/007/\"\n    },\n    {\n      \"id\": \"T1562.008\",\n      \"name\": \"Disable or Modify Cloud Logs\",\n      \"link\": \"/techniques/T1562/008/\"\n    },\n    {\n      \"id\": \"T1562.009\",\n      \"name\": \"Safe Mode Boot\",\n      \"link\": \"/techniques/T1562/009/\"\n    },\n    {\n      \"id\": \"T1562.010\",\n      \"name\": \"Downgrade Attack\",\n      \"link\": \"/techniques/T1562/010/\"\n    },\n    {\n      \"id\": \"T1562.011\",\n      \"name\": \"Spoof Security Alerting\",\n      \"link\": \"/techniques/T1562/011/\"\n    },\n    {\n      \"id\": \"T1562.012\",\n      \"name\": \"Disable or Modify Linux Audit System\",\n      \"link\": \"/techniques/T1562/012/\"\n    }\n  ],\n  \"description\": \"Adversaries may impair command history logging to hide commands they run on a compromised system. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. On Linux and macOS, command history is tracked in a file pointed to by the environment variable HISTFILE. When a user logs off a system, this information is flushed to a file in the user's home directory called ~/.bash_history. The HISTCONTROL environment variable keeps track of what should be saved by the history command and eventually into the ~/.bash_history file when a user logs out. HISTCONTROL does not exist by default on macOS, but can be set by the user and will be respected.\\n\\nAdversaries may clear the history environment variable (unset HISTFILE) or set the command history size to zero (export HISTFILESIZE=0) to prevent logging of commands. Additionally, HISTCONTROL can be configured to ignore commands that start with a space by simply setting it to \\\"ignorespace\\\". HISTCONTROL can also be set to ignore duplicate commands by setting it to \\\"ignoredups\\\". In some Linux systems, this is set by default to \\\"ignoreboth\\\" which covers both of the previous examples. This means that \\\" ls\\\" will not be saved, but \\\"ls\\\" would be saved by history. Adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands.\\n\\nOn Windows systems, the PSReadLine module tracks commands used in all PowerShell sessions and writes them to a file ($env:APPDATA\\\\Microsoft\\\\Windows\\\\PowerShell\\\\PSReadLine\\\\ConsoleHost_history.txt by default). Adversaries may change where these logs are saved using Set-PSReadLineOption -HistorySavePath {File Path}. This will cause ConsoleHost_history.txt to stop receiving logs. Additionally, it is possible to turn off logging to this file using the PowerShell command Set-PSReadlineOption -HistorySaveStyle SaveNothing.[1][2][3]\\n\\nAdversaries may also leverage a Network Device CLI on network devices to disable historical command logging (e.g. no logging).\",\n  \"id\": \"T1562.003\",\n  \"sub_technique_of\": {\n    \"id\": \"T1562\",\n    \"link\": \"/techniques/T1562\"\n  },\n  \"tactic\": {\n    \"id\": \"TA0005\",\n    \"name\": \"Defense Evasion\",\n    \"link\": \"/tactics/TA0005\"\n  },\n  \"platforms\": [\"Linux\", \"Network\", \"Windows\", \"macOS\"],\n  \"defenses_bypassed\": [\"Host forensic analysis\", \"Log analysis\"],\n  \"contributors\": [\"Austin Clark, @c2defense\", \"Emile Kenning, Sophos\", \"Vikas Singh, Sophos\"],\n  \"version\": \"2.2\",\n  \"created_date\": \"21 February 2020\",\n  \"last_modified_date\": \"30 March 2023\",\n  \"procedure_examples\": [\n    {\n      \"id\": \"G0082\",\n      \"name\": \"APT38\",\n      \"description\": \"APT38 has prepended a space to all of their terminal commands to operate without leaving traces in the HISTCONTROL environment.[4]\",\n      \"link\": \"/groups/G0082\"\n    },\n    {\n      \"id\": \"S0692\",\n      \"name\": \"SILENTTRINITY\",\n      \"description\": \"SILENTTRINITY can bypass ScriptBlock logging to execute unmanaged PowerShell code from memory.[5]\",\n      \"link\": \"/software/S0692\"\n    }\n  ],\n  \"mitigations\": [\n    {\n      \"id\": \"M1039\",\n      \"name\": \"Environment Variable Permissions\",\n      \"description\": \"Prevent users from changing the HISTCONTROL, HISTFILE, and HISTFILESIZE environment variables.[6]\",\n      \"link\": \"/mitigations/M1039\"\n    },\n    {\n      \"id\": \"M1028\",\n      \"name\": \"Operating System Configuration\",\n      \"description\": \"Make sure that the HISTCONTROL environment variable is set to \\\"ignoredups\\\" instead of \\\"ignoreboth\\\" or \\\"ignorespace\\\".\",\n      \"link\": \"/mitigations/M1028\"\n    }\n  ],\n  \"detection\": [\n    {\n      \"id\": \"DS0017\",\n      \"data_source\": \"Command\",\n      \"data_component\": \"Command Execution\",\n      \"description\": \"Correlating a user session with a distinct lack of new commands in their .bash_history can be a clue to suspicious behavior. Monitor for modification of PowerShell command history settings through processes being created with -HistorySaveStyle SaveNothing command-line arguments and use of the PowerShell commands Set-PSReadlineOption -HistorySaveStyle SaveNothing and Set-PSReadLineOption -HistorySavePath {File Path}. For network devices, monitor for missing or inconsistencies in Network Device CLI logging present in AAA logs as well as in specific RADIUS and TACAS+ logs.\",\n      \"link\": \"/datasources/DS0017/#Command%20Execution\"\n    },\n    {\n      \"id\": \"DS0013\",\n      \"data_source\": \"Sensor Health\",\n      \"data_component\": \"Host Status\",\n      \"description\": \"Users checking or changing their HISTCONTROL, HISTFILE, or HISTFILESIZE environment variables may be suspicious.\",\n      \"link\": \"/datasources/DS0013/#Host%20Status\"\n    }\n  ],\n  \"references\": [\n    {\n      \"id\": \"scite-1\",\n      \"description\": \"Microsoft. (2020, May 13). About History. Retrieved September 4, 2020.\",\n      \"link\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_history?view=powershell-7\"\n    },\n    {\n      \"id\": \"scite-2\",\n      \"description\": \"jak. (2020, June 27). Live Discover - PowerShell command audit. Retrieved August 21, 2020.\",\n      \"link\": \"https://community.sophos.com/products/intercept/early-access-program/f/live-discover-response-queries/121529/live-discover---powershell-command-audit\"\n    },\n    {\n      \"id\": \"scite-3\",\n      \"description\": \"Vikas, S. (2020, August 26). PowerShell Command History Forensics. Retrieved September 4, 2020.\",\n      \"link\": \"https://community.sophos.com/products/malware/b/blog/posts/powershell-command-history-forensics\"\n    },\n    {\n      \"id\": \"scite-4\",\n      \"description\": \"DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.\",\n      \"link\": \"https://us-cert.cisa.gov/ncas/alerts/aa20-239a\"\n    },\n    {\n      \"id\": \"scite-5\",\n      \"description\": \"Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.\",\n      \"link\": \"https://github.com/byt3bl33d3r/SILENTTRINITY/tree/master/silenttrinity/core/teamserver/modules/boo\"\n    },\n    {\n      \"id\": \"scite-6\",\n      \"description\": \"Mathew Branwell. (2012, March 21). Securing .bash_history file. Retrieved July 8, 2017.\",\n      \"link\": \"http://www.akyl.net/securing-bashhistory-file-make-sure-your-linux-system-users-won%E2%80%99t-hide-or-delete-their-bashhistory\"\n    }\n  ],\n  \"version_permalink\": \"../versions/v15/techniques/T1562/003\",\n  \"live_version\": \"../versions/v15/techniques/T1562/003\"\n}",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "stop",
    "ai_response_time": "2024-06-14T04:57:03.847185",
    "ai_runtime": 48.676901,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 9602,
    "tokens_output": 2247,
    "tokens_total": 11849
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1562003.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1562003.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Impair Defenses: Impair Command History Logging, Sub-technique T1562.003 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1562\">Impair Defenses</a></li>\n        <li class=\"breadcrumb-item\">Impair Command History Logging</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Impair Defenses:</span>\n                        Impair Command History Logging\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Impair Defenses (11)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.001\"> T1562.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.001\"> Disable or Modify Tools </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.002\"> T1562.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.002\"> Disable Windows Event Logging </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1562.003\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        Impair Command History Logging\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.004\"> T1562.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.004\"> Disable or Modify System Firewall </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.006\"> T1562.006 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.006\"> Indicator Blocking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.007\"> T1562.007 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.007\"> Disable or Modify Cloud Firewall </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.008\"> T1562.008 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.008\"> Disable or Modify Cloud Logs </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.009\"> T1562.009 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.009\"> Safe Mode Boot </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.010\"> T1562.010 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.010\"> Downgrade Attack </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.011\"> T1562.011 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.011\"> Spoof Security Alerting </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.012\"> T1562.012 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.012\"> Disable or Modify Linux Audit System </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may impair command history logging to hide commands they run on a compromised system. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. </p><p>On Linux and macOS, command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The <code>HISTCONTROL</code> environment variable keeps track of what should be saved by the <code>history</code> command and eventually into the <code>~/.bash_history</code> file when a user logs out. <code>HISTCONTROL</code> does not exist by default on macOS, but can be set by the user and will be respected.</p><p>Adversaries may clear the history environment variable (<code>unset HISTFILE</code>) or set the command history size to zero (<code>export HISTFILESIZE=0</code>) to prevent logging of commands. Additionally, <code>HISTCONTROL</code> can be configured to ignore commands that start with a space by simply setting it to \"ignorespace\". <code>HISTCONTROL</code> can also be set to ignore duplicate commands by setting it to \"ignoredups\". In some Linux systems, this is set by default to \"ignoreboth\" which covers both of the previous examples. This means that \" ls\" will not be saved, but \"ls\" would be saved by history. Adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands. </p><p>On Windows systems, the <code>PSReadLine</code> module tracks commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt</code> by default). Adversaries may change where these logs are saved using <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. This will cause <code>ConsoleHost_history.txt</code> to stop receiving logs. Additionally, it is possible to turn off logging to this file using the PowerShell command <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2020, May 13). About History. Retrieved September 4, 2020.\" data-reference=\"Microsoft PowerShell Command History\"><sup><a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_history?view=powershell-7\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"jak. (2020, June 27). Live Discover - PowerShell command audit. Retrieved August 21, 2020.\" data-reference=\"Sophos PowerShell command audit\"><sup><a href=\"https://community.sophos.com/products/intercept/early-access-program/f/live-discover-response-queries/121529/live-discover---powershell-command-audit\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Vikas, S. (2020, August 26). PowerShell Command History Forensics. Retrieved September 4, 2020.\" data-reference=\"Sophos PowerShell Command History Forensics\"><sup><a href=\"https://community.sophos.com/products/malware/b/blog/posts/powershell-command-history-forensics\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p><p>Adversaries may also leverage a <a href=\"/techniques/T1059/008\">Network Device CLI</a> on network devices to disable historical command logging (e.g. <code>no logging</code>).</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1562.003\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1562\">T1562</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactic:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Linux, Network, Windows, macOS\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Host forensic analysis, Log analysis\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Austin Clark, @c2defense; Emile Kenning, Sophos; Vikas Singh, Sophos\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>2.2\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>21 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>30 March 2023\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1562/003/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1562.003\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1562/003/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1562.003\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0082\"> G0082 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0082\"> APT38 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0082\">APT38</a> has prepended a space to all of their terminal commands to operate without leaving traces in the HISTCONTROL environment.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.\" data-reference=\"CISA AA20-239A BeagleBoyz August 2020\"><sup><a href=\"https://us-cert.cisa.gov/ncas/alerts/aa20-239a\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0692\"> S0692 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0692\"> SILENTTRINITY </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0692\">SILENTTRINITY</a> can bypass ScriptBlock logging to execute unmanaged PowerShell code from memory.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.\" data-reference=\"GitHub SILENTTRINITY Modules July 2019\"><sup><a href=\"https://github.com/byt3bl33d3r/SILENTTRINITY/tree/master/silenttrinity/core/teamserver/modules/boo\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1039\"> M1039 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1039\"> Environment Variable Permissions </a>\n                                                </td>\n                                                <td>\n                                                                <p>Prevent users from changing the <code>HISTCONTROL</code>, <code>HISTFILE</code>, and <code>HISTFILESIZE</code> environment variables. <span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Mathew Branwell. (2012, March 21). Securing .bash_history file. Retrieved July 8, 2017.\" data-reference=\"Securing bash history\"><sup><a href=\"http://www.akyl.net/securing-bashhistory-file-make-sure-your-linux-system-users-won%E2%80%99t-hide-or-delete-their-bashhistory\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> M1028 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> Operating System Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>Make sure that the <code>HISTCONTROL</code> environment variable is set to \"ignoredups\" instead of \"ignoreboth\" or \"ignorespace\".</p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Correlating a user session with a distinct lack of new commands in their <code>.bash_history</code> can be a clue to suspicious behavior. Monitor for modification of PowerShell command history settings through processes being created with <code>-HistorySaveStyle SaveNothing</code> command-line arguments and use of the PowerShell commands <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> and <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. For network devices, monitor for missing or inconsistencies in Network Device CLI logging present in AAA logs as well as in specific RADIUS and TACAS+ logs.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0013\">\n                <td>\n                    <a href=\"/datasources/DS0013\">DS0013</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0013\">Sensor Health</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0013/#Host%20Status\">Host Status</a>\n                </td>\n                    <td>\n                                <p>Users checking or changing their <code>HISTCONTROL</code>, <code>HISTFILE</code>, or <code>HISTFILESIZE</code> environment variables may be suspicious.</p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_history?view=powershell-7\" target=\"_blank\">\n                        Microsoft. (2020, May 13). About History. Retrieved September 4, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://community.sophos.com/products/intercept/early-access-program/f/live-discover-response-queries/121529/live-discover---powershell-command-audit\" target=\"_blank\">\n                        jak. (2020, June 27). Live Discover - PowerShell command audit. Retrieved August 21, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https://community.sophos.com/products/malware/b/blog/posts/powershell-command-history-forensics\" target=\"_blank\">\n                        Vikas, S. (2020, August 26). PowerShell Command History Forensics. Retrieved September 4, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"4.0\">\n                                \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://us-cert.cisa.gov/ncas/alerts/aa20-239a\" target=\"_blank\">\n                        DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://github.com/byt3bl33d3r/SILENTTRINITY/tree/master/silenttrinity/core/teamserver/modules/boo\" target=\"_blank\">\n                        Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"http://www.akyl.net/securing-bashhistory-file-make-sure-your-linux-system-users-won%E2%80%99t-hide-or-delete-their-bashhistory\" target=\"_blank\">\n                        Mathew Branwell. (2012, March 21). Securing .bash_history file. Retrieved July 8, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?6205\"></script>\n    <script src=\"/theme/scripts/settings.js?1470\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Impair Defenses: Impair Command History Logging, Sub-technique T1562.003 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1562\">Impair Defenses</a></li>\n        <li class=\"breadcrumb-item\">Impair Command History Logging</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Impair Defenses:</span>\n                        Impair Command History Logging\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Impair Defenses (11)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.001\"> T1562.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.001\"> Disable or Modify Tools </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.002\"> T1562.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.002\"> Disable Windows Event Logging </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1562.003\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        Impair Command History Logging\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.004\"> T1562.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.004\"> Disable or Modify System Firewall </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.006\"> T1562.006 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.006\"> Indicator Blocking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.007\"> T1562.007 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.007\"> Disable or Modify Cloud Firewall </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.008\"> T1562.008 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.008\"> Disable or Modify Cloud Logs </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.009\"> T1562.009 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.009\"> Safe Mode Boot </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.010\"> T1562.010 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.010\"> Downgrade Attack </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.011\"> T1562.011 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.011\"> Spoof Security Alerting </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.012\"> T1562.012 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1562/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1562.012\"> Disable or Modify Linux Audit System </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may impair command history logging to hide commands they run on a compromised system. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. </p><p>On Linux and macOS, command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The <code>HISTCONTROL</code> environment variable keeps track of what should be saved by the <code>history</code> command and eventually into the <code>~/.bash_history</code> file when a user logs out. <code>HISTCONTROL</code> does not exist by default on macOS, but can be set by the user and will be respected.</p><p>Adversaries may clear the history environment variable (<code>unset HISTFILE</code>) or set the command history size to zero (<code>export HISTFILESIZE=0</code>) to prevent logging of commands. Additionally, <code>HISTCONTROL</code> can be configured to ignore commands that start with a space by simply setting it to \"ignorespace\". <code>HISTCONTROL</code> can also be set to ignore duplicate commands by setting it to \"ignoredups\". In some Linux systems, this is set by default to \"ignoreboth\" which covers both of the previous examples. This means that \" ls\" will not be saved, but \"ls\" would be saved by history. Adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands. </p><p>On Windows systems, the <code>PSReadLine</code> module tracks commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt</code> by default). Adversaries may change where these logs are saved using <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. This will cause <code>ConsoleHost_history.txt</code> to stop receiving logs. Additionally, it is possible to turn off logging to this file using the PowerShell command <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2020, May 13). About History. Retrieved September 4, 2020.\" data-reference=\"Microsoft PowerShell Command History\"><sup><a href=\"https:/docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_history?view=powershell-7\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"jak. (2020, June 27). Live Discover - PowerShell command audit. Retrieved August 21, 2020.\" data-reference=\"Sophos PowerShell command audit\"><sup><a href=\"https:/community.sophos.com/products/intercept/early-access-program/f/live-discover-response-queries/121529/live-discover---powershell-command-audit\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"Vikas, S. (2020, August 26). PowerShell Command History Forensics. Retrieved September 4, 2020.\" data-reference=\"Sophos PowerShell Command History Forensics\"><sup><a href=\"https:/community.sophos.com/products/malware/b/blog/posts/powershell-command-history-forensics\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p><p>Adversaries may also leverage a <a href=\"/techniques/T1059/008\">Network Device CLI</a> on network devices to disable historical command logging (e.g. <code>no logging</code>).</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1562.003\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1562\">T1562</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactic:</span>\n                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Linux, Network, Windows, macOS\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"If the (sub-)technique can be used to bypass or evade a particular defensive tool, methodology, or process\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Defense Bypassed:&nbsp;</span>Host forensic analysis, Log analysis\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Contributors:&nbsp;</span>Austin Clark, @c2defense; Emile Kenning, Sophos; Vikas Singh, Sophos\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>2.2\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>21 February 2020\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>30 March 2023\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1562/003/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1562.003\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1562/003/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1562.003\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0082\"> G0082 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0082\"> APT38 </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0082\">APT38</a> has prepended a space to all of their terminal commands to operate without leaving traces in the HISTCONTROL environment.<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.\" data-reference=\"CISA AA20-239A BeagleBoyz August 2020\"><sup><a href=\"https:/us-cert.cisa.gov/ncas/alerts/aa20-239a\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0692\"> S0692 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0692\"> SILENTTRINITY </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0692\">SILENTTRINITY</a> can bypass ScriptBlock logging to execute unmanaged PowerShell code from memory.<span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.\" data-reference=\"GitHub SILENTTRINITY Modules July 2019\"><sup><a href=\"https:/github.com/byt3bl33d3r/SILENTTRINITY/tree/master/silenttrinity/core/teamserver/modules/boo\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1039\"> M1039 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1039\"> Environment Variable Permissions </a>\n                                                </td>\n                                                <td>\n                                                                <p>Prevent users from changing the <code>HISTCONTROL</code>, <code>HISTFILE</code>, and <code>HISTFILESIZE</code> environment variables. <span onclick=\"scrollToRef('scite-6')\" id=\"scite-ref-6-a\" class=\"scite-citeref-number\" title=\"Mathew Branwell. (2012, March 21). Securing .bash_history file. Retrieved July 8, 2017.\" data-reference=\"Securing bash history\"><sup><a href=\"http:/www.akyl.net/securing-bashhistory-file-make-sure-your-linux-system-users-won%E2%80%99t-hide-or-delete-their-bashhistory\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>\n\n                                                </td>\n                                            </tr>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> M1028 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1028\"> Operating System Configuration </a>\n                                                </td>\n                                                <td>\n                                                                <p>Make sure that the <code>HISTCONTROL</code> environment variable is set to \"ignoredups\" instead of \"ignoreboth\" or \"ignorespace\".</p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0017\">\n                <td>\n                    <a href=\"/datasources/DS0017\">DS0017</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0017\">Command</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0017/#Command%20Execution\">Command Execution</a>\n                </td>\n                    <td>\n                                <p>Correlating a user session with a distinct lack of new commands in their <code>.bash_history</code> can be a clue to suspicious behavior. Monitor for modification of PowerShell command history settings through processes being created with <code>-HistorySaveStyle SaveNothing</code> command-line arguments and use of the PowerShell commands <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> and <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. For network devices, monitor for missing or inconsistencies in Network Device CLI logging present in AAA logs as well as in specific RADIUS and TACAS+ logs.</p>\n\n                    </td>\n            </tr>\n            <tr class=\"datasource\" id=\"uses-DS0013\">\n                <td>\n                    <a href=\"/datasources/DS0013\">DS0013</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0013\">Sensor Health</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0013/#Host%20Status\">Host Status</a>\n                </td>\n                    <td>\n                                <p>Users checking or changing their <code>HISTCONTROL</code>, <code>HISTFILE</code>, or <code>HISTFILESIZE</code> environment variables may be suspicious.</p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_history?view=powershell-7\" target=\"_blank\">\n                        Microsoft. (2020, May 13). About History. Retrieved September 4, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/community.sophos.com/products/intercept/early-access-program/f/live-discover-response-queries/121529/live-discover---powershell-command-audit\" target=\"_blank\">\n                        jak. (2020, June 27). Live Discover - PowerShell command audit. Retrieved August 21, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https:/community.sophos.com/products/malware/b/blog/posts/powershell-command-history-forensics\" target=\"_blank\">\n                        Vikas, S. (2020, August 26). PowerShell Command History Forensics. Retrieved September 4, 2020.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"4.0\">\n                                \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/us-cert.cisa.gov/ncas/alerts/aa20-239a\" target=\"_blank\">\n                        DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/github.com/byt3bl33d3r/SILENTTRINITY/tree/master/silenttrinity/core/teamserver/modules/boo\" target=\"_blank\">\n                        Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-6\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-6\" href=\"http:/www.akyl.net/securing-bashhistory-file-make-sure-your-linux-system-users-won%E2%80%99t-hide-or-delete-their-bashhistory\" target=\"_blank\">\n                        Mathew Branwell. (2012, March 21). Securing .bash_history file. Retrieved July 8, 2017.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?6205\"></script>\n    <script src=\"/theme/scripts/settings.js?1470\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "39954df7-67a7-4bf8-b5fd-61a50b8952f7"
}