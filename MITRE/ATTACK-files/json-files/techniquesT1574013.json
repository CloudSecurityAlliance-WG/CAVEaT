{
  "api_response": {
    "ai_query_time": "2024-06-14T03:19:50.860311",
    "ai_response_data": "{\n  \"breadcrumb\": [\n    {\n      \"label\": \"Home\",\n      \"url\": \"/\"\n    },\n    {\n      \"label\": \"Techniques\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"label\": \"Enterprise\",\n      \"url\": \"/techniques/enterprise\"\n    },\n    {\n      \"label\": \"Hijack Execution Flow\",\n      \"url\": \"/techniques/T1574\"\n    },\n    {\n      \"label\": \"KernelCallbackTable\",\n      \"url\": \"/techniques/T1574/013\"\n    }\n  ],\n  \"main\": {\n    \"title\": \"Hijack Execution Flow: KernelCallbackTable\",\n    \"id\": \"T1574.013\",\n    \"sub-technique_of\": {\n      \"label\": \"T1574\",\n      \"url\": \"/techniques/T1574\"\n    },\n    \"tactics\": [\n      {\n        \"label\": \"Persistence\",\n        \"url\": \"/tactics/TA0003\"\n      },\n      {\n        \"label\": \"Privilege Escalation\",\n        \"url\": \"/tactics/TA0004\"\n      },\n      {\n        \"label\": \"Defense Evasion\",\n        \"url\": \"/tactics/TA0005\"\n      }\n    ],\n    \"platforms\": [\"Windows\"],\n    \"version\": \"1.0\",\n    \"created\": \"25 February 2022\",\n    \"last_modified\": \"22 March 2022\",\n    \"version_permalink\": \"https://attack.mitre.org/versions/v15/techniques/T1574/013/\",\n    \"live_version\": \"https://attack.mitre.org/versions/v15/techniques/T1574/013/\",\n    \"description\": \"Adversaries may abuse the <code>KernelCallbackTable</code> of a process to hijack its execution flow in order to run their own payloads. The <code>KernelCallbackTable</code> can be found in the Process Environment Block (PEB)...\",\n    \"details\": [\n      {\n        \"type\": \"text\",\n        \"content\": \"Adversaries may abuse the <code>KernelCallbackTable</code> of a process to hijack its execution flow in order to run their own payloads...\"\n      },\n      {\n        \"type\": \"link\",\n        \"label\": \"[1]\",\n        \"url\": \"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\"\n      },\n      ...\n    ],\n    \"procedure_examples\": [\n      {\n        \"id\": \"S0182\",\n        \"name\": \"FinFisher\",\n        \"description\": \"<a href='/software/S0182'>FinFisher</a> has used the <code>KernelCallbackTable</code> to hijack the execution flow of a process by replacing the <code>__fnDWORD</code> function with the address of a created <a href='/techniques/T1055/004'>Asynchronous Procedure Call</a> stub routine.\",\n        \"references\": [\n          {\n            \"label\": \"FinFisher exposed\",\n            \"url\": \"https://www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\"\n          }\n        ]\n      },\n      ...\n    ],\n    \"mitigations\": [\n      {\n        \"id\": \"M1040\",\n        \"name\": \"Behavior Prevention on Endpoint\",\n        \"description\": \"Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions).\"\n      }\n    ],\n    \"detection\": [\n      {\n        \"id\": \"DS0009\",\n        \"data_source\": \"Process\",\n        \"data_component\": \"OS API Execution\",\n        \"detects\": \"Monitoring Windows API calls indicative of the various types of code injection may generate a...\"\n      }\n    ],\n    \"references\": [\n      {\n        \"label\": \"Saini, A. and Hossein, J.\",\n        \"url\": \"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\",\n        \"description\": \"North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022\"\n      },\n      {\n        \"label\": \"Microsoft Defender Security Research Team\",\n        \"url\": \"https://www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\",\n        \"description\": \"FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\"\n      },\n      {\n        \"label\": \"odzhan\",\n        \"url\": \"https://modexp.wordpress.com/2019/05/25/windows-injection-finspy/\",\n        \"description\": \"Windows Process Injection: KernelCallbackTable used by FinFisher / FinSpy. Retrieved February 4, 2022.\"\n      },\n      {\n        \"label\": \"Microsoft\",\n        \"url\": \"https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess\",\n        \"description\": \"NtQueryInformationProcess function (winternl.h). Retrieved February 4, 2022.\"\n      },\n      {\n        \"label\": \"Pradhan, A.\",\n        \"url\": \"https://blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns\",\n        \"description\": \"LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.\"\n      }\n    ]\n  }\n}",
    "ai_response_http_status_code": null,
    "ai_response_stop_reason": "stop",
    "ai_response_time": "2024-06-14T03:20:15.630874",
    "ai_runtime": 24.770563,
    "model_name": "gpt-4o",
    "status": "success",
    "temperature": 1,
    "tokens_input": 9909,
    "tokens_output": 1275,
    "tokens_total": 11184
  },
  "arguments": {
    "max_tokens": null,
    "model": "gpt-4o",
    "output_file": "techniquesT1574013.json",
    "output_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/techniquesT1574013.json",
    "system_prompt": "You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "system_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/You are a helpful AI that takes HTML content (a dump of the Document Object Model or DOM from google chrome headless) and extracts data from it into a JSON format and then gives that back to the user. Do not include anything like ```json at the start, I just want raw JSON",
    "temperature": null,
    "user_data_file": "<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Hijack Execution Flow: KernelCallbackTable, Sub-technique T1574.013 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https://medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https://medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https://attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1574\">Hijack Execution Flow</a></li>\n        <li class=\"breadcrumb-item\">KernelCallbackTable</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Hijack Execution Flow:</span>\n                        KernelCallbackTable\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Hijack Execution Flow (13)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.001\"> T1574.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.001\"> DLL Search Order Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.002\"> T1574.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.002\"> DLL Side-Loading </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.004\"> T1574.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.004\"> Dylib Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.005\"> T1574.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.005\"> Executable Installer File Permissions Weakness </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.006\"> T1574.006 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.006\"> Dynamic Linker Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.007\"> T1574.007 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.007\"> Path Interception by PATH Environment Variable </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.008\"> T1574.008 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.008\"> Path Interception by Search Order Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.009\"> T1574.009 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.009\"> Path Interception by Unquoted Path </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.010\"> T1574.010 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.010\"> Services File Permissions Weakness </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.011\"> T1574.011 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.011\"> Services Registry Permissions Weakness </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.012\"> T1574.012 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.012\"> COR_PROFILER </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1574.013\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        KernelCallbackTable\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/014/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.014\"> T1574.014 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/014/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.014\"> AppDomainManager </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may abuse the <code>KernelCallbackTable</code> of a process to hijack its execution flow in order to run their own payloads.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Microsoft Defender Security Research Team. (2018, March 1). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\" data-reference=\"FinFisher exposed \"><sup><a href=\"https://www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span> The <code>KernelCallbackTable</code> can be found in the Process Environment Block (PEB) and is initialized to an array of graphic functions available to a GUI process once <code>user32.dll</code> is loaded.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"odzhan. (2019, May 25). Windows Process Injection: KernelCallbackTable used by FinFisher / FinSpy. Retrieved February 4, 2022.\" data-reference=\"Windows Process Injection KernelCallbackTable\"><sup><a href=\"https://modexp.wordpress.com/2019/05/25/windows-injection-finspy/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p><p>An adversary may hijack the execution flow of a process using the <code>KernelCallbackTable</code> by replacing an original callback function with a malicious payload. Modifying callback functions can be achieved in various ways involving related behaviors such as <a href=\"/techniques/T1620\">Reflective Code Loading</a> or <a href=\"/techniques/T1055\">Process Injection</a> into another process.</p><p>A pointer to the memory address of the <code>KernelCallbackTable</code> can be obtained by locating the PEB (ex: via a call to the <code>NtQueryInformationProcess()</code> <a href=\"/techniques/T1106\">Native API</a> function).<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2021, November 23). NtQueryInformationProcess function (winternl.h). Retrieved February 4, 2022.\" data-reference=\"NtQueryInformationProcess\"><sup><a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span> Once the pointer is located, the <code>KernelCallbackTable</code> can be duplicated, and a function in the table (e.g., <code>fnCOPYDATA</code>) set to the address of a malicious payload (ex: via <code>WriteProcessMemory()</code>). The PEB is then updated with the new address of the table. Once the tampered function is invoked, the malicious payload will be triggered.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>The tampered function is typically invoked using a Windows message. After the process is hijacked and malicious code is executed, the <code>KernelCallbackTable</code> may also be restored to its original state by the rest of the malicious payload.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Use of the <code>KernelCallbackTable</code> to hijack execution flow may evade detection from security products since the execution can be masked under a legitimate process.</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1574.013\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1574\">T1574</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0003\">Persistence</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>,                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.0\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>25 February 2022\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>22 March 2022\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1574/013/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1574.013\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1574/013/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1574.013\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0182\"> S0182 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0182\"> FinFisher </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0182\">FinFisher</a> has used the <code>KernelCallbackTable</code> to hijack the execution flow of a process by replacing the <code>__fnDWORD</code> function with the address of a created <a href=\"/techniques/T1055/004\">Asynchronous Procedure Call</a> stub routine.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Microsoft Defender Security Research Team. (2018, March 1). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\" data-reference=\"FinFisher exposed \"><sup><a href=\"https://www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> G0032 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> Lazarus Group </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0032\">Lazarus Group</a> has abused the <code>KernelCallbackTable</code> to hijack process control flow and execute shellcode.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Pradhan, A. (2022, February 8). LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.\" data-reference=\"Qualys LolZarus\"><sup><a href=\"https://blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1040\"> M1040 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1040\"> Behavior Prevention on Endpoint </a>\n                                                </td>\n                                                <td>\n                                                                <p>Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions).</p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances. for known bad sequence of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. Windows API calls such as <code>WriteProcessMemory()</code> and <code>NtQueryInformationProcess()</code> with the parameter set to <code>ProcessBasicInformation</code> may be used for this technique.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\">\n                        Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https://www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" target=\"_blank\">\n                        Microsoft Defender Security Research Team. (2018, March 1). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https://modexp.wordpress.com/2019/05/25/windows-injection-finspy/\" target=\"_blank\">\n                        odzhan. (2019, May 25). Windows Process Injection: KernelCallbackTable used by FinFisher / FinSpy. Retrieved February 4, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"4.0\">\n                                \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess\" target=\"_blank\">\n                        Microsoft. (2021, November 23). NtQueryInformationProcess function (winternl.h). Retrieved February 4, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https://blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns\" target=\"_blank\">\n                        Pradhan, A. (2022, February 8). LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https://www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https://twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https://github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?6867\"></script>\n    <script src=\"/theme/scripts/settings.js?159\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_data_file_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/<!DOCTYPE html>\n<html lang=\"en\"><head>\n            <script type=\"text/javascript\" async=\"\" src=\"https:/www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=G-C8EHW4DS2X&amp;l=dataLayer&amp;cx=c\"></script><script async=\"\" src=\"https:/www.googletagmanager.com/gtag/js?id=UA-62667723-1\"></script>\n        <script>\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'UA-62667723-1');\n        </script>\n        <meta name=\"google-site-verification\" content=\"2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ\">\n\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1,shrink-to-fit=no\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <link rel=\"shortcut icon\" href=\"/theme/favicon.ico\" type=\"image/x-icon\">\n        <title>Hijack Execution Flow: KernelCallbackTable, Sub-technique T1574.013 - Enterprise | MITRE ATT&amp;CK\u00ae</title>\n        <!-- USWDS CSS -->\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-tourist.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/bootstrap-select.min.css\">\n        <!-- Fontawesome CSS -->\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/fontawesome.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/brands.min.css\">\n        <link rel=\"stylesheet\" href=\"/theme/style/fontawesome-6.5.1/css/solid.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/theme/style.min.css?9dc07e69\">\n\n</head>\n\n<body>\n\n    <div class=\"container-fluid attack-website-wrapper d-flex flex-column h-100\">\n        <div class=\"row sticky-top flex-grow-0 flex-shrink-1\">\n            <!-- header elements -->\n            <header class=\"col px-0\">\n                    <nav class=\"navbar navbar-expand-lg navbar-dark position-static\">\n        <a class=\"navbar-brand\" href=\"/\"><img src=\"/theme/images/mitre_attack_logo.png\" class=\"attack-logo\"></a>\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarCollapse\" aria-controls=\"navbarCollapse\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n            <ul class=\"nav nav-tabs ml-auto\">\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/matrices/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Matrices</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/matrices/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/matrices/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/matrices/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/tactics/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Tactics</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/tactics/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/tactics/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/tactics/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/techniques/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Techniques</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/techniques/enterprise/\">Enterprise</a>\n                <a class=\"dropdown-item\" href=\"/techniques/mobile/\">Mobile</a>\n                <a class=\"dropdown-item\" href=\"/techniques/ics/\">ICS</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/datasources\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Defenses</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/datasources\">Data Sources</a>\n                \n<div class=\"dropright dropdown\">\n<a class=\"dropdown-item dropdown-toggle\" href=\"/mitigations/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Mitigations</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n            <a class=\"dropdown-item\" href=\"/mitigations/enterprise/\">Enterprise</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/mobile/\">Mobile</a>\n            <a class=\"dropdown-item\" href=\"/mitigations/ics/\">ICS</a>\n    </div>\n</div>\n\n                <a class=\"dropdown-item\" href=\"/assets\">Assets</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/groups\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>CTI</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/groups\">Groups</a>\n                <a class=\"dropdown-item\" href=\"/software\">Software</a>\n                <a class=\"dropdown-item\" href=\"/campaigns\">Campaigns</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item dropdown\">\n                                \n    <a class=\"nav-link dropdown-toggle\" href=\"/resources/\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <b>Resources</b>\n    </a>\n    <div class=\"dropdown-menu \" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href=\"/resources/\">Get Started</a>\n                <a class=\"dropdown-item\" href=\"/resources/learn-more-about-attack/\">Learn More about ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/attack-data-and-tools/\">ATT&amp;CK Data &amp; Tools</a>\n                <a class=\"dropdown-item\" href=\"/resources/faq/\">FAQ</a>\n                <a class=\"dropdown-item\" href=\"/resources/engage-with-attack/contact/\">Engage with ATT&amp;CK</a>\n                <a class=\"dropdown-item\" href=\"/resources/versions/\">Version History</a>\n                <a class=\"dropdown-item\" href=\"/resources/legal-and-branding/\">Legal &amp; Branding</a>\n    </div>\n\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <a href=\"/resources/engage-with-attack/benefactors/\" class=\"nav-link\"><b>Benefactors</b></a>\n                        </li>\n                        <li class=\"nav-item\">\n                                <a href=\"https:/medium.com/mitre-attack/\" target=\"_blank\" class=\"nav-link\">\n        <b>Blog</b>&nbsp;\n        <img src=\"/theme/images/external-site.svg\" alt=\"External site\" class=\"external-icon\">\n    </a>\n\n                        </li>\n                        <li class=\"nav-item\">\n                            <button id=\"search-button\" class=\"btn search-button\">Search <div id=\"search-icon\" class=\"icon-button search-icon\"></div></button>\n                        </li>\n            </ul>\n        </div>\n    </nav>\n\n            </header>\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- banner elements -->\n            <div class=\"col px-0\">\n                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->\n                <!-- !versions banner! -->\n                    <div class=\"container-fluid banner-message\">\n                        ATT&amp;CK v15.1 has been released! Check out the <a href=\"https:/medium.com/mitre-attack/attack-v15-26685f300acc\">blog post</a> or <a href=\"https:/attack.mitre.org/resources/updates/updates-april-2024/\">release notes</a> for more information.\n                    </div>\n            </div>\n        </div>\n        <div class=\"row flex-grow-1 flex-shrink-0\">\n            <!-- main content elements -->\n            <!--start-indexing-for-search-->\n\n \n     \n    <div class=\"sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3\" id=\"v-tab\" role=\"tablist\" aria-orientation=\"vertical\" style=\"top: 66px; max-height: 534px;\">\n        <div class=\"resizer\" id=\"resizer\"></div>\n<!--stop-indexing-for-search-->\n<div id=\"sidebars\"></div>\n<!--start-indexing-for-search-->\n    </div>\n\n    \n     \n    <div class=\"tab-content col-xl-9 pt-4\" id=\"v-tabContent\">\n        <div class=\"tab-pane fade show active\" id=\"v-attckmatrix\" role=\"tabpanel\" aria-labelledby=\"v-attckmatrix-tab\">\n    \n    <ol class=\"breadcrumb\">\n        <li class=\"breadcrumb-item\"><a href=\"/\">Home</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Techniques</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/enterprise\">Enterprise</a></li>\n            <li class=\"breadcrumb-item\"><a href=\"/techniques/T1574\">Hijack Execution Flow</a></li>\n        <li class=\"breadcrumb-item\">KernelCallbackTable</li>\n    </ol>\n    <div class=\"tab-pane fade show active\" id=\"v-\" role=\"tabpanel\" aria-labelledby=\"v--tab\"></div>\n    <div class=\"row\">\n        <div class=\"col-xl-12\">\n            <div class=\"jumbotron jumbotron-fluid\">\n                <div class=\"container-fluid\">\n                    <h1 id=\"\">\n                            <span id=\"subtechnique-parent-name\">Hijack Execution Flow:</span>\n                        KernelCallbackTable\n                    </h1> \n\n                        <div class=\"row\">\n                            <div class=\"col-md-8\">\n                                    <!--stop-indexing-for-search-->\n                                    <div class=\"card-block pb-2\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header collapsed\" id=\"subtechniques-card-header\" data-toggle=\"collapse\" data-target=\"#subtechniques-card-body\" aria-expanded=\"false\" aria-controls=\"subtechniques-card-body\">\n                                                    <h5 class=\"mb-0\" id=\"sub-techniques\">Other sub-techniques of Hijack Execution Flow (13)</h5>\n                                            </div>\n                                            <div id=\"subtechniques-card-body\" class=\"card-body p-0 collapse\" aria-labelledby=\"subtechniques-card-header\">\n                                                <table class=\"table table-bordered\">\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope=\"col\">ID</th>\n                                                            <th scope=\"col\">Name</th>\n                                                        </tr>\n                                                    </thead> \n                                                    <tbody>                                          \n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.001\"> T1574.001 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/001/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.001\"> DLL Search Order Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.002\"> T1574.002 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/002/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.002\"> DLL Side-Loading </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.004\"> T1574.004 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/004/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.004\"> Dylib Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.005\"> T1574.005 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/005/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.005\"> Executable Installer File Permissions Weakness </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.006\"> T1574.006 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/006/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.006\"> Dynamic Linker Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.007\"> T1574.007 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/007/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.007\"> Path Interception by PATH Environment Variable </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.008\"> T1574.008 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/008/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.008\"> Path Interception by Search Order Hijacking </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.009\"> T1574.009 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/009/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.009\"> Path Interception by Unquoted Path </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.010\"> T1574.010 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/010/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.010\"> Services File Permissions Weakness </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.011\"> T1574.011 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/011/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.011\"> Services Registry Permissions Weakness </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.012\"> T1574.012 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/012/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.012\"> COR_PROFILER </a>\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td class=\"active\">\n                                                                        T1574.013\n                                                                    </td>\n                                                                    <td class=\"active\"> \n                                                                        KernelCallbackTable\n                                                                    </td>\n                                                            </tr>\n                                                            <tr>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/014/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.014\"> T1574.014 </a>\n                                                                    </td>\n                                                                    <td>\n                                                                        <a href=\"/techniques/T1574/014/\" class=\"subtechnique-table-item\" data-subtechnique_id=\"T1574.014\"> AppDomainManager </a>\n                                                                    </td>\n                                                            </tr>\n                               \n                                                    </tbody>                           \n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <!--start-indexing-for-search-->\n   \n\n                                    <div class=\"description-body\">\n                                                <p>Adversaries may abuse the <code>KernelCallbackTable</code> of a process to hijack its execution flow in order to run their own payloads.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Microsoft Defender Security Research Team. (2018, March 1). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\" data-reference=\"FinFisher exposed \"><sup><a href=\"https:/www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span> The <code>KernelCallbackTable</code> can be found in the Process Environment Block (PEB) and is initialized to an array of graphic functions available to a GUI process once <code>user32.dll</code> is loaded.<span onclick=\"scrollToRef('scite-3')\" id=\"scite-ref-3-a\" class=\"scite-citeref-number\" title=\"odzhan. (2019, May 25). Windows Process Injection: KernelCallbackTable used by FinFisher / FinSpy. Retrieved February 4, 2022.\" data-reference=\"Windows Process Injection KernelCallbackTable\"><sup><a href=\"https:/modexp.wordpress.com/2019/05/25/windows-injection-finspy/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p><p>An adversary may hijack the execution flow of a process using the <code>KernelCallbackTable</code> by replacing an original callback function with a malicious payload. Modifying callback functions can be achieved in various ways involving related behaviors such as <a href=\"/techniques/T1620\">Reflective Code Loading</a> or <a href=\"/techniques/T1055\">Process Injection</a> into another process.</p><p>A pointer to the memory address of the <code>KernelCallbackTable</code> can be obtained by locating the PEB (ex: via a call to the <code>NtQueryInformationProcess()</code> <a href=\"/techniques/T1106\">Native API</a> function).<span onclick=\"scrollToRef('scite-4')\" id=\"scite-ref-4-a\" class=\"scite-citeref-number\" title=\"Microsoft. (2021, November 23). NtQueryInformationProcess function (winternl.h). Retrieved February 4, 2022.\" data-reference=\"NtQueryInformationProcess\"><sup><a href=\"https:/docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span> Once the pointer is located, the <code>KernelCallbackTable</code> can be duplicated, and a function in the table (e.g., <code>fnCOPYDATA</code>) set to the address of a malicious payload (ex: via <code>WriteProcessMemory()</code>). The PEB is then updated with the new address of the table. Once the tampered function is invoked, the malicious payload will be triggered.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>The tampered function is typically invoked using a Windows message. After the process is hijacked and malicious code is executed, the <code>KernelCallbackTable</code> may also be restored to its original state by the rest of the malicious payload.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span> Use of the <code>KernelCallbackTable</code> to hijack execution flow may evade detection from security products since the execution can be masked under a legitimate process.</p>\n\n                                    </div>\n                            </div>\n                            <div class=\"col-md-4\">\n                                <div class=\"card\">\n                                    <div class=\"card-body\">\n                                            <div class=\"row card-data\" id=\"card-id\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">ID:&nbsp;</span>T1574.013\n                                                </div>\n                                            </div>\n                                        <!--stop-indexing-for-search-->\n                                        <div class=\"row card-data\">\n                                            <div class=\"col-md-1 px-0 text-center\"></div>\n                                            <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Sub-technique of:&nbsp;</span>\n                                                    <a href=\"/techniques/T1574\">T1574</a>\n                                            </div>\n                                        </div>\n                                        <!--start-indexing-for-search-->\n                                            <div id=\"card-tactics\" class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The tactic objectives that the (sub-)technique can be used to accomplish\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Tactics:</span>\n                                                        <a href=\"/tactics/TA0003\">Persistence</a>,                                                        <a href=\"/tactics/TA0004\">Privilege Escalation</a>,                                                        <a href=\"/tactics/TA0005\">Defense Evasion</a>                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\">\n                                                    <span data-toggle=\"tooltip\" data-placement=\"left\" title=\"\" data-test-ignore=\"true\" data-original-title=\"The system an adversary is operating within; could be an operating system or application\">\u24d8</span>\n                                                </div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Platforms:&nbsp;</span>Windows\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Version:&nbsp;</span>1.0\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Created:&nbsp;</span>25 February 2022\n                                                </div>\n                                            </div>\n                                            <div class=\"row card-data\">\n                                                <div class=\"col-md-1 px-0 text-center\"></div>\n                                                <div class=\"col-md-11 pl-0\">\n                                                    <span class=\"h5 card-title\">Last Modified:&nbsp;</span>22 March 2022\n                                                </div>\n                                            </div>\n                                    </div>\n                                </div>\n                                    <div class=\"text-center pt-2 version-button live\">\n    <div class=\"live\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1574/013/\" data-test-ignore=\"true\" data-original-title=\"Permalink to this version of T1574.013\">Version Permalink</a>\n    </div>\n    <div class=\"permalink\">\n        <a data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"\" href=\"/versions/v15/techniques/T1574/013/\" data-test-ignore=\"true\" data-original-title=\"Go to the live version of T1574.013\">Live Version</a><!--do not change this line without also changing versions.py-->\n    </div>\n</div>\n\n                            </div>\n                        </div>\n                            <h2 class=\"pt-3\" id=\"examples\">Procedure Examples</h2>\n                            <div class=\"tables-mobile\">\n                            <table class=\"table table-bordered table-alternate mt-2\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">ID</th>\n                                        <th scope=\"col\">Name</th>\n                                        <th scope=\"col\">Description</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/software/S0182\"> S0182 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/software/S0182\"> FinFisher </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/software/S0182\">FinFisher</a> has used the <code>KernelCallbackTable</code> to hijack the execution flow of a process by replacing the <code>__fnDWORD</code> function with the address of a created <a href=\"/techniques/T1055/004\">Asynchronous Procedure Call</a> stub routine.<span onclick=\"scrollToRef('scite-2')\" id=\"scite-ref-2-a\" class=\"scite-citeref-number\" title=\"Microsoft Defender Security Research Team. (2018, March 1). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\" data-reference=\"FinFisher exposed \"><sup><a href=\"https:/www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> G0032 </a>\n                                            </td>\n                                            <td>\n                                                <a href=\"/groups/G0032\"> Lazarus Group </a>\n                                            </td>\n                                            <td>\n                                                            <p><a href=\"/groups/G0032\">Lazarus Group</a> has abused the <code>KernelCallbackTable</code> to hijack process control flow and execute shellcode.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=\"scrollToRef('scite-5')\" id=\"scite-ref-5-a\" class=\"scite-citeref-number\" title=\"Pradhan, A. (2022, February 8). LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.\" data-reference=\"Qualys LolZarus\"><sup><a href=\"https:/blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>\n\n                                            </td>\n                                        </tr>\n                                </tbody>\n                            </table>\n                            </div>\n                            <h2 class=\"pt-3\" id=\"mitigations\">Mitigations</h2>\n                            <div class=\"tables-mobile\">\n                                <table class=\"table table-bordered table-alternate mt-2\">\n                                    <thead>\n                                        <tr> \n                                            <th scope=\"col\">ID</th>\n                                            <th scope=\"col\">Mitigation</th>\n                                            <th scope=\"col\">Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                            <tr>\n                                                <td>\n                                                    <a href=\"/mitigations/M1040\"> M1040 </a>\n                                                </td>\n                                                <td>\n                                                    <a href=\"/mitigations/M1040\"> Behavior Prevention on Endpoint </a>\n                                                </td>\n                                                <td>\n                                                                <p>Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions).</p>\n\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                                </div>\n                            <h2 class=\"pt-3\" id=\"detection\">Detection</h2>\n                                <div class=\"tables-mobile\">\n<table class=\"table datasources-table table-bordered\">\n    <thead>\n        <tr>\n            <th class=\"p-2\" scope=\"col\">ID</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Source</th>\n            <th class=\"p-2 nowrap\" scope=\"col\">Data Component</th>\n            <th class=\"p-2\" scope=\"col\">Detects</th>\n        </tr>\n    </thead>\n    <tbody>\n            <tr class=\"datasource\" id=\"uses-DS0009\">\n                <td>\n                    <a href=\"/datasources/DS0009\">DS0009</a>\n                </td>\n                <td class=\"nowrap\">\n                    <a href=\"/datasources/DS0009\">Process</a>\n                </td>\n                <!-- Add first data component here -->\n                <td> \n                    <a href=\"/datasources/DS0009/#OS%20API%20Execution\">OS API Execution</a>\n                </td>\n                    <td>\n                                <p>Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances. for known bad sequence of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. Windows API calls such as <code>WriteProcessMemory()</code> and <code>NtQueryInformationProcess()</code> with the parameter set to <code>ProcessBasicInformation</code> may be used for this technique.<span onclick=\"scrollToRef('scite-1')\" id=\"scite-ref-1-a\" class=\"scite-citeref-number\" title=\"Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\" data-reference=\"Lazarus APT January 2022\"><sup><a href=\"https:/blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>\n\n                    </td>\n            </tr>\n    </tbody>\n</table>\n</div>\n\n                \n                            <h2 class=\"pt-3\" id=\"references\">References</h2>\n\n        <div class=\"row\">\n            <div class=\"col\">\n                <ol>\n                            \n        <li>\n            <span id=\"scite-1\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-1\" href=\"https:/blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/\" target=\"_blank\">\n                        Saini, A. and Hossein, J. (2022, January 27). North Korea\u2019s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-2\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-2\" href=\"https:/www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" target=\"_blank\">\n                        Microsoft Defender Security Research Team. (2018, March 1). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved January 27, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                            \n        <li>\n            <span id=\"scite-3\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-3\" href=\"https:/modexp.wordpress.com/2019/05/25/windows-injection-finspy/\" target=\"_blank\">\n                        odzhan. (2019, May 25). Windows Process Injection: KernelCallbackTable used by FinFisher / FinSpy. Retrieved February 4, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                </ol>\n            </div>\n            <div class=\"col\">\n                    <ol start=\"4.0\">\n                                \n        <li>\n            <span id=\"scite-4\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-4\" href=\"https:/docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess\" target=\"_blank\">\n                        Microsoft. (2021, November 23). NtQueryInformationProcess function (winternl.h). Retrieved February 4, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n                                \n        <li>\n            <span id=\"scite-5\" class=\"scite-citation\">\n                <span class=\"scite-citation-text\">\n                    <a rel=\"nofollow\" class=\"external text\" name=\"scite-5\" href=\"https:/blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns\" target=\"_blank\">\n                        Pradhan, A. (2022, February 8). LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.\n                    </a>\n                </span>\n            </span>\n        </li>\n\n\n  \n                    </ol>\n            </div>             \n        </div>\n\n\n    \n                </div>\n            </div>\n        </div>\n    </div>\n    \n        </div>\n    </div>\n\n            <!--stop-indexing-for-search-->\n            <!-- search overlay for entire page -- not displayed inline -->\n            <div class=\"overlay search\" id=\"search-overlay\" style=\"display: none;\">\n    <div class=\"overlay-inner\">\n        <!-- text input for searching -->\n        <div class=\"search-header\">\n            <div class=\"search-input\">\n                <input type=\"text\" id=\"search-input\" placeholder=\"search\">\n            </div>\n            <div class=\"search-icons\">\n                <div class=\"search-parsing-icon spinner-border\" style=\"\" id=\"search-parsing-icon\"></div>\n                <div class=\"close-search-icon\" id=\"close-search-icon\">\u00d7</div>\n            </div>\n        </div>\n        <!-- results and controls for loading more results -->\n        <div id=\"search-body\" class=\"search-body\">\n            <div class=\"results\" id=\"search-results\">\n                <!-- content will be appended here on search -->\n            </div>\n            <div id=\"load-more-results\" class=\"load-more-results\">\n                <button class=\"btn btn-default\" id=\"load-more-results-button\">load more results</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <div class=\"row flex-grow-0 flex-shrink-1\">\n            <!-- footer elements -->\n            <footer class=\"col footer\">\n                <div class=\"container-fluid\">\n                    <div class=\"row row-footer\">\n                        <div class=\"col-2 col-sm-2 col-md-2\">\n                            <div class=\"footer-center-responsive my-auto\">\n                                <a href=\"https:/www.mitre.org\" target=\"_blank\" rel=\"noopener\" aria-label=\"MITRE\">\n                                    <img src=\"/theme/images/mitrelogowhiteontrans.gif\" class=\"mitre-logo-wtrans\">\n                                </a>\n                            </div>\n                        </div>\n                        <div class=\"col-2 col-sm-2 footer-responsive-break\"></div>\n                        <div class=\"footer-link-group\">\n                            <div class=\"row row-footer\">\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/engage-with-attack/contact\" class=\"footer-link\">Contact Us</a></u>\n                                </div>\n                                <div class=\"px-3 col-footer\">\n                                    <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/terms-of-use\" class=\"footer-link\">Terms of Use</a></u>\n                                </div>\n                                    <div class=\"px-3 col-footer\">\n                                        <u class=\"footer-link\"><a href=\"/resources/legal-and-branding/privacy\" class=\"footer-link\">Privacy Policy</a></u>\n                                    </div>\n                                <div class=\"px-3\">\n                                    <u class=\"footer-link\"><a href=\"/resources/changelog.html\" class=\"footer-link\" data-toggle=\"tooltip\" data-placement=\"top\" data-html=\"true\" title=\"\" data-original-title=\"ATT&amp;CK content v15.1\nWebsite  v4.1.3\">Website Changelog</a></u>\n                                </div>\n                            </div>\n                            <div class=\"row\">\n                                <small class=\"px-3\">\n                                    \u00a9&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&amp;CK and ATT&amp;CK are registered trademarks of The MITRE Corporation.\n                                </small>\n                            </div>\n                        </div>\n                        <div class=\"w-100 p-2 footer-responsive-break\"></div>\n                            <div class=\"col pr-4\">\n                                <div class=\"footer-float-right-responsive-brand\">\n                                    <div class=\"row row-footer row-footer-icon\">\n                                        <div class=\"mb-1\">\n                                            <a href=\"https:/twitter.com/MITREattack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-x-twitter fa-lg\"></i>\n                                            </a>\n                                            <a href=\"https:/github.com/mitre-attack\" class=\"btn btn-footer\">\n                                                <i class=\"fa-brands fa-github fa-lg\"></i>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </footer></div>\n            \n        </div>\n    \n\n\n<!--stopindex-->\n\n\n    <!--SCRIPTS-->\n    <script src=\"/theme/scripts/jquery-3.5.1.min.js\"></script>\n    <script src=\"/theme/scripts/popper.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap-select.min.js\"></script>\n    <script src=\"/theme/scripts/bootstrap.bundle.min.js\"></script>\n    <script src=\"/theme/scripts/site.js?6867\"></script>\n    <script src=\"/theme/scripts/settings.js?159\"></script>\n    <script src=\"/theme/scripts/search_bundle.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/resizer.js\"></script>\n\n<!--SCRIPTS-->\n<script src=\"/theme/scripts/bootstrap-tourist.js\"></script>\n<script src=\"/theme/scripts/settings.js\"></script>\n    <script src=\"/theme/scripts/tour/tour-subtechniques.js\"></script>\n<script src=\"/theme/scripts/sidebar-load-all.js\"></script>\n\n</body></html>\n",
    "user_prompt": "I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: ",
    "user_prompt_absolute": "/mnt/c/GitHub/WG-CAVEaT/ATTACK-files/json-files/I want you to extract the data from the main section of the following HTML DOM document that I will include at the end of this prompt, put the information from the main part of the HTML DOM page into a JSON format and show me just the JSON and no other data. Make sure to include as much information as possible for each item in the JSON output, especially any URLs. The HTML DOM data is: "
  },
  "csa-ai-foundation-model-api-clients-version": "0.1.20",
  "dataType": "csa-ai-foundation-model-api-clients-JSON-output",
  "dataVersion": "0.2",
  "uuid": "aae337ad-5b24-481a-b9e7-bba3a5ed4170"
}